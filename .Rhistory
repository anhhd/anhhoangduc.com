)
}
data <- mtcars %>% mutate(cyl = factor(cyl))
data %>%
ggplot(aes(cyl, mpg)) +
geom_bar(aes(fill = cyl), stat = "identity") +
my_theme() +
gghighlight(cyl == 6) +
labs(title = "Example 1 - highlight without text")
?scale_fill_manual
data %>%
ggplot(aes(cyl, mpg)) +
geom_bar(aes(fill = cyl), stat = "identity") +
#  my_theme() +
gghighlight(cyl == 6) +
labs(title = "Example 1 - highlight without text")
list(
theme_bw(),
scale_fill_brewer(palette = "Set1"),
scale_color_brewer(palette = "Set1")
)
my_theme <- function(){
list(
theme_bw(),
scale_fill_brewer(palette = "Set1"),
scale_color_brewer(palette = "Set1")
)
}
data <- mtcars %>% mutate(cyl = factor(cyl))
data %>%
ggplot(aes(cyl, mpg)) +
geom_bar(aes(fill = cyl), stat = "identity") +
my_theme() +
gghighlight(cyl == 6) +
labs(title = "Example 1 - highlight without text")
data %>%
group_by(cyl) %>%
summarise(mpg = sum(mpg)) %>%
ggplot(aes(cyl, mpg)) +
geom_bar(aes(fill = cyl), stat = "identity") +
geom_text(aes(label = mpg),
hjust = -0.3) +
my_theme() +
coord_flip() +
scale_y_continuous(limits = c(0, 320)) +
gghighlight(cyl == 6) +
labs(title = "Example 2 - Hightlight with text (version 1)")
data %>%
group_by(cyl) %>%
summarise(mpg = sum(mpg)) %>%
ungroup %>%
ggplot(aes(cyl, mpg)) +
geom_bar(aes(fill = cyl), stat = "identity") +
my_theme() +
coord_flip() +
scale_y_continuous(limits = c(0, 320)) +
gghighlight(cyl == 6) +
geom_text(aes(label = mpg),
hjust = -0.3) +
labs(title = "Example 3 - Hightlight with text (version 2)")
iris %>%
ggplot(aes(Species, Sepal.Length)) +
geom_boxplot(aes(fill = Species)) +
my_theme() +
facet_wrap(~Species) +
gghighlight() +
theme(legend.position = "top")
iris %>%
ggplot(aes(Species, Sepal.Length)) +
geom_boxplot(aes(fill = Species)) +
my_theme() +
facet_wrap(~Species) +
gghighlight() +
theme(legend.position = "top") +
labs(title = "GGHIGHLIGHT for box plot")
library(ggrepel)
df <- mtcars %>% mutate(name = row.names(.))
df %>%
ggplot(aes(mpg, disp)) +
geom_point(col = "darkred") +
my_theme() +
gghighlight(disp > 350 & disp <= 400,
unhighlighted_colour = alpha("darkgreen", 0.4)) +
geom_point(col = "darkred", size = 2.5) +
geom_text_repel(aes(label = name))
library(ggrepel)
df <- mtcars %>% mutate(name = row.names(.))
df %>%
ggplot(aes(mpg, disp)) +
geom_point(col = "darkred") +
my_theme() +
gghighlight(disp > 350 & disp <= 400,
unhighlighted_colour = alpha("darkgreen", 0.4)) +
geom_point(col = "darkred", size = 2.5) +
geom_text_repel(aes(label = name))
set.seed(2)
d <- purrr::map_dfr(
letters,
~ data.frame(
idx = 1:400,
value = cumsum(runif(400, -1, 1)),
type = .,
flag = sample(c(TRUE, FALSE), size = 400, replace = TRUE),
stringsAsFactors = FALSE
)
)
d_filtered <- d %>%
group_by(type) %>%
filter(max(value) > 20) %>%
ungroup()
ggplot(d_filtered) +
geom_line(aes(idx, value, colour = type))
ggplot(d) +
geom_line(aes(idx, value, colour = type)) +
gghighlight(max(value) > 20)
ggplot(d) +
geom_line(aes(idx, value, colour = type)) +
gghighlight(value > 18)
ggplot(d) +
geom_line(aes(idx, value, colour = type)) +
gghighlight(max(value) > 19) +
theme_minimal()
p <- ggplot(iris, aes(Sepal.Length, fill = Species)) +
geom_histogram() +
gghighlight()
p
d2 <- dplyr::sample_n(d, 20)
ggplot(d2, aes(idx, value)) +
geom_point() +
gghighlight(value > 0, label_key = type)
ggplot(d2, aes(idx, value)) +
geom_point() +
gghighlight(value > 0, label_key = type,
use_direct_label = F)
ggplot(d2, aes(idx, value)) +
geom_point() +
gghighlight(value > 0, label_key = type,
use_direct_label = T)
?gghighlight
df %>%
ggplot(aes(mpg, disp)) +
geom_point(col = "darkred") +
my_theme() +
gghighlight(disp > 350 & disp <= 400,
unhighlighted_colour = alpha("darkgreen", 0.4)) +
geom_point(col = "darkred", size = 2.5) +
geom_text_repel(aes(label = name))
df %>%
ggplot(aes(mpg, disp)) +
geom_point(col = "darkred") +
my_theme() +
gghighlight(disp > 350 & disp <= 400,
unhighlighted_colour = alpha("darkgreen", 0.4)) +
geom_point(col = "darkred", size = 2.5)
df %>%
ggplot(aes(mpg, disp)) +
geom_point(col = "darkred") +
my_theme() +
gghighlight(disp > 350 & disp <= 400,
unhighlighted_colour = alpha("darkgreen", 0.4),
use_direct_label = T) +
geom_point(col = "darkred", size = 2.5)
ggplot(d2, aes(idx, value)) +
geom_point() +
gghighlight(value > 0, label_key = type,
use_direct_label = T)
df %>%
ggplot(aes(mpg, disp)) +
geom_point(col = "darkred") +
my_theme() +
gghighlight(disp > 350 & disp <= 400,
unhighlighted_colour = alpha("darkgreen", 0.4),
use_direct_label = T,
label_key = name) +
geom_point(col = "darkred", size = 2.5)
df %>%
ggplot(aes(mpg, disp)) +
geom_point(col = "darkred") +
my_theme() +
gghighlight(disp > 350 & disp <= 400,
unhighlighted_colour = alpha("darkgreen", 0.4),
use_direct_label = T,
label_key = name,
label_params = list(size = 10)) +
geom_point(col = "darkred", size = 2.5)
df %>%
ggplot(aes(mpg, disp)) +
geom_point(col = "darkred") +
my_theme() +
gghighlight(disp > 350 & disp <= 400,
unhighlighted_colour = alpha("darkgreen", 0.4),
use_direct_label = T,
label_key = name,
label_params = list(size = 4)) +
geom_point(col = "darkred", size = 2.5)
df %>%
ggplot(aes(mpg, disp)) +
geom_point(col = "darkred") +
my_theme() +
gghighlight(disp > 350 & disp <= 400,
unhighlighted_colour = alpha("darkgreen", 0.4),
use_direct_label = T,
label_key = name,
label_params = list(size = 5)) +
geom_point(col = "darkred", size = 2.5)
df %>%
ggplot(aes(mpg, disp)) +
geom_point(col = "darkred") +
my_theme() +
gghighlight(disp > 350 & disp <= 400,
unhighlighted_colour = alpha("darkgreen", 0.4)) +
geom_point(col = "darkred", size = 2.5) +
geom_text_repel(aes(label = name))
df %>%
ggplot(aes(mpg, disp)) +
geom_point(col = "darkred") +
my_theme() +
gghighlight(disp > 350 & disp <= 400,
unhighlighted_colour = alpha("darkgreen", 0.4)) +
geom_point(col = "darkred", size = 2.5) +
geom_text_repel(aes(label = name), size = 4)
df %>%
ggplot(aes(mpg, disp)) +
geom_point(col = "darkred") +
my_theme() +
gghighlight(disp > 350 & disp <= 400,
unhighlighted_colour = alpha("darkgreen", 0.4)) +
geom_point(col = "darkred", size = 2.5) +
geom_text_repel(aes(label = name), size = 5)
df %>%
ggplot(aes(mpg, disp)) +
geom_point(col = "darkred") +
my_theme() +
gghighlight(disp > 350 & disp <= 400,
unhighlighted_colour = alpha("darkgreen", 0.4),
use_direct_label = T,
label_key = name,
label_params = list(size = 5)) +
geom_point(col = "darkred", size = 2.5)
df %>%
ggplot(aes(mpg, disp)) +
geom_point(col = "darkred") +
my_theme() +
gghighlight(disp > 350 & disp <= 400,
unhighlighted_colour = alpha("darkgreen", 0.4)) +
geom_point(col = "darkred", size = 2.5) +
geom_text_repel(aes(label = name), size = 5)
df %>%
ggplot(aes(mpg, disp)) +
geom_point(col = "darkred") +
my_theme() +
gghighlight(disp > 350 & disp <= 400,
unhighlighted_colour = alpha("darkgreen", 0.4),
use_direct_label = T,
label_key = name,
label_params = list(size = 5)) +
geom_point(col = "darkred", size = 2.5)
df %>%
ggplot(aes(mpg, disp)) +
geom_point(col = "darkred") +
my_theme() +
gghighlight(disp > 350 & disp <= 400,
unhighlighted_colour = alpha("darkgreen", 0.4),
use_direct_label = T,
label_key = name,
label_params = list(size = 5)) +
geom_point(col = "darkred", size = 2.5) +
labs(title = "Example 5 - Hightlight points")
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
servr::daemon_stop("2167026077912")
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
servr::daemon_stop("2167026077224")
blogdown:::serve_site()
servr::daemon_stop("2167026078600")
blogdown:::serve_site()
servr::daemon_stop("2167026080664")
blogdown:::serve_site()
servr::daemon_stop("2167026079976")
blogdown:::serve_site()
servr::daemon_stop("2167026078600")
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
servr::daemon_stop("2648957485192")
blogdown:::serve_site()
servr::daemon_stop("2648957485192")
servr::daemon_stop("2648957485880")
blogdown:::serve_site()
servr::daemon_stop("2648957483816")
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::serve_site()
blogdown:::serve_site()
78
servr::daemon_stop("2952367738136")
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
# Load library
library(tidyverse)
library(ggplot2)
library(reshape2)
library(lubridate)
library(grid)
library(gridExtra)
# Create data for simulation
set.seed(123)
data <- data.frame(date = seq(1, 372, by = 31) %>% as_date)
data <- data %>%
mutate(new = abs(rnorm(12, 100, 10)) %>% round(0)) %>%
mutate(churn = abs(rnorm(12, 50, 30)) %>% round(0)) %>%
mutate(net = new - churn)  %>%
mutate(eop = cumsum(net)) %>%
select(-net)
data
# Define the width of segment
step <- 0.4*(max(data$date) - min(data$date))/(nrow(data) - 1)
# Define ymax of segment
data <- data %>%
mutate(ymax = eop + churn)
# Define ymin of segment
df <- data %>%
melt(id.vars = c("date", "eop", "ymax")) %>%
mutate(ymin = ymax - value) %>%
rename(group = variable)
# Define xmin and xmax of segments
df <- df %>%
mutate(xmin = case_when(
group == "new" ~ date - step,
TRUE ~ date
)) %>%
mutate(xmax = case_when(
group == "new" ~ date,
TRUE ~ date + step
))
# Create waterfall chart
df %>%
arrange(date) %>%
ggplot() +
geom_rect(aes(xmin = xmin,
xmax = xmax,
ymin = ymin,
ymax = ymax,
fill = group)) -> p1
p1
# Create data for line chart
df2 <- df %>% select(date, eop) %>% distinct()
# Optimize colors, themes & add lines
p2 <- p1  +
geom_line(aes(date, eop), col = "dodgerblue4", size = 1) +
geom_point(aes(date, eop), col = "dodgerblue4", size = 2.5) +
geom_text(aes(date, eop, label = eop), vjust = 1.2,
hjust = -0.1) +
scale_fill_manual(values = c("grey60", "coral2")) +
theme_minimal() +
theme(
axis.line = element_line(color = "gray40", size = 0.5),
legend.position = "top") +
scale_x_date(breaks = data$date,
date_labels = "%b") +
theme(panel.grid.minor.x = element_blank(),
legend.title = element_blank()) +
ggtitle("Overview of active users") +
xlab("Date") +
ylab("Number of active users")
p2
blogdown:::serve_site()
<<<<<<< HEAD
<<<<<<< HEAD
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::new_post_addin()
blogdown:::serve_site()
blogdown:::serve_site()
=======
>>>>>>> parent of 7bbffa6... Updated CV
=======
>>>>>>> parent of 7bbffa6... Updated CV
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
library(patchwork)
library(tidyverse)
library(patchwork)
compare_group <- function(data,
value,
group){
value <- enquo(value)
group <- enquo(group)
value_name <- quo_name(value)
group_name <- quo_name(group)
cat(paste0("Compare ", value_name, " with ", group_name))
cat("\n----------------------------------------\n")
#Compare two variable
df <- data %>% select(!!value, !!group)
df %>%
group_by(!!group) %>%
summarise_at(vars(!!value),
funs(n(), mean, median,
min,
q25 = quantile(., 0.25),
q75 = quantile(.,0.75),
p90 = quantile(., 0.9),
q95 = quantile(., .95),
max)) %>% print
formula.aov <- paste(value_name, group_name, sep = "~")
cat("\n----------------------------------------")
cat(paste0("\n# Anova analysis: ", formula.aov))
cat("\n----------------------------------------\n\n")
aov(formula(formula.aov), data = df) %>% TukeyHSD() %>% print;
p1 <- ggplot(data, aes(!!group, !!value, fill = !!group)) +
geom_boxplot(aes(fill = !!group)) +
scale_y_log10() +
labs(title = paste0(value_name, " by ", group_name)) +
theme_minimal() +
theme(legend.position = "none");
#  p1 %>% print();
p2 <- ggplot(data, aes(!!value)) +
geom_density(aes(fill = !!group), alpha = 0.7) +
labs(title = paste0("Density of ", value_name)) +
theme_minimal() +
theme(legend.position = "top");
#  p2 %>% print();
print(p1+p2)
}
iris %>% compare_group(Sepal.Length, Species)
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
servr::daemon_stop(1)
blogdown:::serve_site()
blogdown:::serve_site()
servr::daemon_stop(1)
######
Sys.getenv("RSTUDIO_PANDOC")
######## Passing working directory to rmd
##setwd(dirname(rstudioapi::getSourceEditorContext()$path))
######
########
args <- commandArgs(trailingOnly=TRUE)
args
if (length(args) != 0){
setwd(args)
}
######
#Sys.getenv("RSTUDIO_PANDOC")
#Sys.setenv(RSTUDIO_PANDOC="C:/Program Files/RStudio/bin/pandoc")
#rmarkdown::pandoc_available()
#blogdown::render_site(encoding = "utf-8")
blogdown:::serve_site()
cat("Finish website")
servr::daemon_stop(2)
######## Passing working directory to rmd
##setwd(dirname(rstudioapi::getSourceEditorContext()$path))
######
########
args <- commandArgs(trailingOnly=TRUE)
args
if (length(args) != 0){
setwd(args)
}
######
#Sys.getenv("RSTUDIO_PANDOC")
#Sys.setenv(RSTUDIO_PANDOC="C:/Program Files/RStudio/bin/pandoc")
#rmarkdown::pandoc_available()
#blogdown::render_site(encoding = "utf-8")
blogdown:::serve_site()
cat("Finish website")
blogdown::serve_site()
?blogdown::serve_site()
?blogdown::serve_site()
?blogdown::serve_site
######
#Sys.getenv("RSTUDIO_PANDOC")
#Sys.setenv(RSTUDIO_PANDOC="C:/Program Files/RStudio/bin/pandoc")
#rmarkdown::pandoc_available()
#blogdown::render_site(encoding = "utf-8")
blogdown:::serve_site()
servr::daemon_stop(1)
######
#Sys.getenv("RSTUDIO_PANDOC")
#Sys.setenv(RSTUDIO_PANDOC="C:/Program Files/RStudio/bin/pandoc")
#rmarkdown::pandoc_available()
#blogdown::render_site(encoding = "utf-8")
blogdown:::serve_site()
servr::daemon_stop(1)
servr::daemon_stop(1)
######
#Sys.getenv("RSTUDIO_PANDOC")
#Sys.setenv(RSTUDIO_PANDOC="C:/Program Files/RStudio/bin/pandoc")
#rmarkdown::pandoc_available()
#blogdown::render_site(encoding = "utf-8")
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
servr::daemon_stop(1)
blogdown:::serve_site()
blogdown:::serve_site()
