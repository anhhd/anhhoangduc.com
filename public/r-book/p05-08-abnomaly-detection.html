

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="vi" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="vi" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>6. Abnomaly detection trong times series &mdash; Tài liệu Phân tích dữ liệu với R 2019</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'./',
              VERSION:'2019',
              LANGUAGE:'vi',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
        <script type="text/javascript" src="_static/copybutton.js"></script>
        <script type="text/javascript" src="_static/translations.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Tìm Kiếm" href="search.html" />
    <link rel="next" title="1. Xử lý ngôn ngữ tự nhiên cơ bản" href="p06-01-nlp-co-ban.html" />
    <link rel="prev" title="5. Dự báo chuỗi thời gian với timetk" href="p05-07-du-bao-ts-voi-timetk.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Phân tích dữ liệu với R
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Giới thiệu</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p01-01-gioi-thieu.html">Khoa học dữ liệu và nghề phân tích dữ liệu</a></li>
</ul>
<p class="caption"><span class="caption-text">Phân tích khám phá dữ liệu</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p02-03-bien-doi-du-lieu-dplyr.html">1. Ngữ pháp của biến đổi dữ liệu với DPLYR</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-04-phan-ra-va-xoay-chieu-du-lieu.html">2. Phân rã và xoay chiều dữ liệu</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-05-cac-chi-so-thong-ke.html">3. Các chỉ số thống kê mô tả cơ bản</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-06-lap-trinh-ham.html">4. Lập trình hàm</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-07-lap-trinh-ham-voi-purrr.html">5. Lập trình chức năng hàm với purrr</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-08-bien-doi-du-lieu-text.html">6. Biến đổi dữ liệu text</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-11-quan-ly-nhieu-mo-hinh.html">7. Quản lý kết quả phân tích từ nhiều mô hình</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-15-thong-ke-co-ban.html">8. Xác suất và phân phối thống kê cơ bản</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-16-power-analysis.html">9. Power analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-20-sampling-methods.html">10. Phương pháp ước lượng lấy mẫu</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-50-datatable.html">11. Biến đổi dữ liệu với <code class="docutils literal notranslate"><span class="pre">data.table</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-60-thu-thap-du-lieu-tu-website.html">12. Thu thập dữ liệu từ website</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-99-meo-trong-r.html">13. Các mẹo trong R</a></li>
</ul>
<p class="caption"><span class="caption-text">Supervised learning</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p03-01-nguyen-ly-du-bao.html">1. Các nguyên lý dự báo</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-02-mo-hinh-ols.html">2. Mô hình OLS</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-03-logistic-regression.html">3. Mô hình hồi quy logistic</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-04-decision-tree.html">4. Cây quyết định</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-05-bagging-boosting.html">5. Bagging, RandomForest và Boosting</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-07-xay-dung-mo-hinh-voi-h2o.html">6. Xây dựng mô hình với H2O</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-08-svm.html">7. Support Vector Machine</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-09-feature-engineering.html">8. Feature Engineering</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-15-regularization.html">9. Regularization</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-17-nonlinear.html">10. Mô hình phi tuyến tính</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-30-credit-scoring.html">11. Credit Scoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-35-caret.html">12. Xây dựng mô hình dự báo với caret</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-65-chat-luong-mo-hinh.html">13. Chất lượng mô hình</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-70-tidymodels.html">14. Tidymodels</a></li>
</ul>
<p class="caption"><span class="caption-text">Unsupervised learning</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p04-01-unsupervised-learning.html">1. Unsupervised learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="p04-02-kmeans.html">2. k-means</a></li>
<li class="toctree-l1"><a class="reference internal" href="p04-03-hierarchical-clustering.html">3. Hierachical clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="p04-04-basket-analysis.html">4. Phân tích giỏ hàng</a></li>
<li class="toctree-l1"><a class="reference internal" href="p04-05-pca.html">5. Principal component analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="p04-06-factor-analysis.html">6. Phân tích nhân tố ẩn (factor analysis)</a></li>
</ul>
<p class="caption"><span class="caption-text">Chuỗi thời gian</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="p05-01-chuoi-thoi-gian.html">1. Giới thiệu về chuỗi thời gian</a></li>
<li class="toctree-l1"><a class="reference internal" href="p05-02-arima.html">2. Mô hình ARIMA</a></li>
<li class="toctree-l1"><a class="reference internal" href="p05-03-phan-tich-chuoi-thoi-gian-voi-tidyquant.html">3. Phân tích chuỗi thời gian với tidyquant và timetk</a></li>
<li class="toctree-l1"><a class="reference internal" href="p05-06-du-bao-ts-voi-prophet.html">4. Dự báo chuỗi thời gian với prophet</a></li>
<li class="toctree-l1"><a class="reference internal" href="p05-07-du-bao-ts-voi-timetk.html">5. Dự báo chuỗi thời gian với timetk</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">6. Abnomaly detection trong times series</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#phan-tach-cac-thanh-phan-chuoi-thoi-gian">6.1. Phân tách các thành phần chuỗi thời gian</a></li>
<li class="toctree-l2"><a class="reference internal" href="#xac-dinh-abnomalize">6.2. Xác định abnomalize</a></li>
<li class="toctree-l2"><a class="reference internal" href="#xac-dinh-vung-quan-sat-bat-thuong">6.3. Xác định vùng quan sát bất thường</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tai-lieu-tham-khao">6.4. Tài liệu tham khảo</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Ngôn ngữ tự nghiên</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p06-01-nlp-co-ban.html">1. Xử lý ngôn ngữ tự nhiên cơ bản</a></li>
<li class="toctree-l1"><a class="reference internal" href="p06-04-text-classification.html">2. Phân loại text</a></li>
<li class="toctree-l1"><a class="reference internal" href="p06-07-nlp-api.html">3. Sử dụng API từ các dịch vụ đám mây</a></li>
<li class="toctree-l1"><a class="reference internal" href="p06-10-ocr-tesseract.html">4. OCR với <code class="docutils literal notranslate"><span class="pre">tesseract</span></code></a></li>
</ul>
<p class="caption"><span class="caption-text">Các phương pháp khác</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p07-01-survival-analysis.html">1. Survival analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="p07-02-causal-impact.html">2. Causal Impact</a></li>
<li class="toctree-l1"><a class="reference internal" href="p07-03-collaborative-filtering.html">3. Collaborative Filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="p07-07-spatial-data.html">4. Spatial data</a></li>
<li class="toctree-l1"><a class="reference internal" href="p07-10-shiny.html">5. Shiny apps</a></li>
</ul>
<p class="caption"><span class="caption-text">Deep Learning</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p09-01-gioi-thieu-deep-learning.html">1. Giới thiệu cơ bản về Deep Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="p09-02-co-ban-kien-thuc-toan.html">2. Kiến thức cơ bản toán học cho deep learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="p09-03-mo-hinh-deep-learning-co-ban.html">3. Mô hình deep learning cơ bản</a></li>
<li class="toctree-l1"><a class="reference internal" href="p09-04-convolution-neural-network.html">4. Convolution neural networks</a></li>
</ul>
<p class="caption"><span class="caption-text">Cloud Computing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p10-01-cai-dat-rstudio-server-tren-amazon.html">1. Cài đặt server RStudio trên Amazon</a></li>
<li class="toctree-l1"><a class="reference internal" href="p10-03-web-service-azure.html">2. Xây dựng web service với Azure</a></li>
<li class="toctree-l1"><a class="reference internal" href="p10-09-apis-voi-plumber.html">3. API với Plumber</a></li>
</ul>
<p class="caption"><span class="caption-text">Kiến thức bổ trợ</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p11-01-git.html">1. Sử dụng GIT</a></li>
<li class="toctree-l1"><a class="reference internal" href="p11-02-cmd.html">2. CMD và Bash</a></li>
<li class="toctree-l1"><a class="reference internal" href="p11-03-docker.html">3. Sử dụng docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="p11-04-apis.html">4. API</a></li>
<li class="toctree-l1"><a class="reference internal" href="p11-05-html-css.html">5. Cơ bản về HTML và CSS</a></li>
<li class="toctree-l1"><a class="reference internal" href="p11-09-other.html">6. Các tricks khác</a></li>
</ul>
<p class="caption"><span class="caption-text">Case studies</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p13-01-casestudy-truc-quan-hoa.html">1. Trực quan hóa dữ liệu</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Phân tích dữ liệu với R</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>6. Abnomaly detection trong times series</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/p05-08-abnomaly-detection.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="abnomaly-detection-trong-times-series">
<h1>6. Abnomaly detection trong times series<a class="headerlink" href="#abnomaly-detection-trong-times-series" title="Permalink to this headline">¶</a></h1>
<p>Khi phân tích dữ liệu chuỗi thời gian, một trong các ứng dụng rất quan
trọng là xác định được các quan sát bất thường. Các quan sát này có thể
thể hiện sự thay đổi xu hướng hoặc có các hoạt động rủi ro bất thường.</p>
<p>Để xác định các quan sát bất thường trong chuỗi thời gian, ta có thể sử
dụng packages <code class="docutils literal notranslate"><span class="pre">anomalize</span></code> và <code class="docutils literal notranslate"><span class="pre">tibbletime</span></code>. Các bước để phân tích
<code class="docutils literal notranslate"><span class="pre">abnomaly</span></code> như sau:</p>
<ol class="arabic simple">
<li>Convert dataframe sang <code class="docutils literal notranslate"><span class="pre">tibbletime</span></code>, để index với dạng <code class="docutils literal notranslate"><span class="pre">date</span></code></li>
<li>Phân rã các thành phần trong time series thành <code class="docutils literal notranslate"><span class="pre">trend</span></code>, <code class="docutils literal notranslate"><span class="pre">seaonal</span></code>
và <code class="docutils literal notranslate"><span class="pre">remainder</span></code> với hàm <code class="docutils literal notranslate"><span class="pre">time_decompose()</span></code></li>
<li>Xác định các quan sát ngoại lai với hàm <code class="docutils literal notranslate"><span class="pre">anomalize()</span></code></li>
<li>Xác định các khoảng quan sát bất thường với <code class="docutils literal notranslate"><span class="pre">time_recompose()</span></code></li>
</ol>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="kn">library</span><span class="p">(</span>tidyverse<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>anomalize<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>tibbletime<span class="p">)</span>
</pre></div>
</div>
<p><strong>Dữ liệu mẫu</strong></p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span>data<span class="p">(</span><span class="s">&quot;tidyverse_cran_downloads&quot;</span><span class="p">)</span>
<span class="kp">class</span><span class="p">(</span>tidyverse_cran_downloads<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">## [1] &quot;grouped_tbl_time&quot; &quot;tbl_time&quot;         &quot;grouped_df&quot;</span>
<span class="c1">## [4] &quot;tbl_df&quot;           &quot;tbl&quot;              &quot;data.frame&quot;</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span>tidyverse_cran_downloads <span class="o">%&gt;%</span> <span class="kp">head</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">## # A time tibble: 6 x 3</span>
<span class="c1">## # Index:  date</span>
<span class="c1">## # Groups: package [1]</span>
<span class="c1">##   date       count package</span>
<span class="c1">##   &lt;date&gt;     &lt;dbl&gt; &lt;chr&gt;</span>
<span class="c1">## 1 2017-01-01   873 tidyr</span>
<span class="c1">## 2 2017-01-02  1840 tidyr</span>
<span class="c1">## 3 2017-01-03  2495 tidyr</span>
<span class="c1">## 4 2017-01-04  2906 tidyr</span>
<span class="c1">## 5 2017-01-05  2847 tidyr</span>
<span class="c1">## 6 2017-01-06  2756 tidyr</span>
</pre></div>
</div>
<p>Với ví dụ này, dữ liệu đã ở dạng tibble time và có thể sử dụng
<code class="docutils literal notranslate"><span class="pre">anomalize</span></code>. Tuy nhiên, trong các trường hợp dữ liệu đang ở dạng data
frame, ta cần làm như sau</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span>data <span class="o">%&gt;%</span>
  group_by<span class="p">(</span>group_var<span class="p">)</span> <span class="o">%&gt;%</span> <span class="c1"># Group var</span>
  arrange<span class="p">(</span><span class="kp">date</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="c1"># Sắp xếp thời gian từ thấp đến cao</span>
  as_tbl_time<span class="p">(</span>index <span class="o">=</span> <span class="kp">date</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="phan-tach-cac-thanh-phan-chuoi-thoi-gian">
<h2>6.1. Phân tách các thành phần chuỗi thời gian<a class="headerlink" href="#phan-tach-cac-thanh-phan-chuoi-thoi-gian" title="Permalink to this headline">¶</a></h2>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span>tidyverse_cran_downloads <span class="o">%&gt;%</span>
    time_decompose<span class="p">(</span>count<span class="p">,</span> method <span class="o">=</span> <span class="s">&quot;stl&quot;</span><span class="p">,</span> frequency <span class="o">=</span> <span class="s">&quot;auto&quot;</span><span class="p">,</span> trend <span class="o">=</span> <span class="s">&quot;auto&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">## # A time tibble: 6,375 x 6</span>
<span class="c1">## # Index:  date</span>
<span class="c1">## # Groups: package [15]</span>
<span class="c1">##    package date       observed season trend remainder</span>
<span class="c1">##    &lt;chr&gt;   &lt;date&gt;        &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;</span>
<span class="c1">##  1 tidyr   2017-01-01      873 -2761. 5053.    -1418.</span>
<span class="c1">##  2 tidyr   2017-01-02     1840   901. 5047.    -4108.</span>
<span class="c1">##  3 tidyr   2017-01-03     2495  1460. 5041.    -4006.</span>
<span class="c1">##  4 tidyr   2017-01-04     2906  1430. 5035.    -3559.</span>
<span class="c1">##  5 tidyr   2017-01-05     2847  1239. 5029.    -3421.</span>
<span class="c1">##  6 tidyr   2017-01-06     2756   367. 5024.    -2635.</span>
<span class="c1">##  7 tidyr   2017-01-07     1439 -2635. 5018.     -944.</span>
<span class="c1">##  8 tidyr   2017-01-08     1556 -2761. 5012.     -695.</span>
<span class="c1">##  9 tidyr   2017-01-09     3678   901. 5006.    -2229.</span>
<span class="c1">## 10 tidyr   2017-01-10     7086  1460. 5000.      626.</span>
<span class="c1">## # ... with 6,365 more rows</span>
</pre></div>
</div>
</div>
<div class="section" id="xac-dinh-abnomalize">
<h2>6.2. Xác định abnomalize<a class="headerlink" href="#xac-dinh-abnomalize" title="Permalink to this headline">¶</a></h2>
<p>Để xác định các quan sát bất thường, ta dùng hàm <code class="docutils literal notranslate"><span class="pre">anomalize</span></code>:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">methood</span> <span class="pre">=</span> <span class="pre">&quot;iqr&quot;</span></code>: Sử dụng Inter Quantile Range để xác định quan
sát bất thường</li>
<li><code class="docutils literal notranslate"><span class="pre">max_anoms</span> <span class="pre">=</span> <span class="pre">0.2</span></code>: Tham số xác định tỷ lệ phần trăm quan sát có thể
là quan sát bất thường</li>
</ul>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span>tidyverse_cran_downloads <span class="o">%&gt;%</span>
    time_decompose<span class="p">(</span>count<span class="p">,</span> method <span class="o">=</span> <span class="s">&quot;stl&quot;</span><span class="p">,</span> frequency <span class="o">=</span> <span class="s">&quot;auto&quot;</span><span class="p">,</span> trend <span class="o">=</span> <span class="s">&quot;auto&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span>
    anomalize<span class="p">(</span>remainder<span class="p">,</span> method <span class="o">=</span> <span class="s">&quot;iqr&quot;</span><span class="p">,</span> alpha <span class="o">=</span> <span class="m">0.05</span><span class="p">,</span> max_anoms <span class="o">=</span> <span class="m">0.2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">## # A time tibble: 6,375 x 9</span>
<span class="c1">## # Index:  date</span>
<span class="c1">## # Groups: package [15]</span>
<span class="c1">##    package date       observed season trend remainder remainder_l1</span>
<span class="c1">##    &lt;chr&gt;   &lt;date&gt;        &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;</span>
<span class="c1">##  1 tidyr   2017-01-01      873 -2761. 5053.    -1418.       -3748.</span>
<span class="c1">##  2 tidyr   2017-01-02     1840   901. 5047.    -4108.       -3748.</span>
<span class="c1">##  3 tidyr   2017-01-03     2495  1460. 5041.    -4006.       -3748.</span>
<span class="c1">##  4 tidyr   2017-01-04     2906  1430. 5035.    -3559.       -3748.</span>
<span class="c1">##  5 tidyr   2017-01-05     2847  1239. 5029.    -3421.       -3748.</span>
<span class="c1">##  6 tidyr   2017-01-06     2756   367. 5024.    -2635.       -3748.</span>
<span class="c1">##  7 tidyr   2017-01-07     1439 -2635. 5018.     -944.       -3748.</span>
<span class="c1">##  8 tidyr   2017-01-08     1556 -2761. 5012.     -695.       -3748.</span>
<span class="c1">##  9 tidyr   2017-01-09     3678   901. 5006.    -2229.       -3748.</span>
<span class="c1">## 10 tidyr   2017-01-10     7086  1460. 5000.      626.       -3748.</span>
<span class="c1">## # ... with 6,365 more rows, and 2 more variables: remainder_l2 &lt;dbl&gt;,</span>
<span class="c1">## #   anomaly &lt;chr&gt;</span>
</pre></div>
</div>
<p>Phân tách các quan sát bất thường trong chuỗi thời gian.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span>tidyverse_cran_downloads <span class="o">%&gt;%</span>

    <span class="c1"># Select a single time series</span>
    filter<span class="p">(</span>package <span class="o">==</span> <span class="s">&quot;lubridate&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span>
    ungroup<span class="p">()</span> <span class="o">%&gt;%</span>

    <span class="c1"># Anomalize</span>
    time_decompose<span class="p">(</span>count<span class="p">,</span> method <span class="o">=</span> <span class="s">&quot;stl&quot;</span><span class="p">,</span> frequency <span class="o">=</span> <span class="s">&quot;auto&quot;</span><span class="p">,</span> trend <span class="o">=</span> <span class="s">&quot;auto&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span>
    anomalize<span class="p">(</span>remainder<span class="p">,</span> method <span class="o">=</span> <span class="s">&quot;iqr&quot;</span><span class="p">,</span> alpha <span class="o">=</span> <span class="m">0.05</span><span class="p">,</span> max_anoms <span class="o">=</span> <span class="m">0.2</span><span class="p">)</span> <span class="o">%&gt;%</span>

    <span class="c1"># Plot Anomaly Decomposition</span>
    plot_anomaly_decomposition<span class="p">()</span> <span class="o">+</span>
    ggtitle<span class="p">(</span><span class="s">&quot;Lubridate Downloads: Anomaly Decomposition&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="image0" src="p05-08-abnomaly-detection_files/figure-html/unnamed-chunk-7-1.png" /></p>
</div>
<div class="section" id="xac-dinh-vung-quan-sat-bat-thuong">
<h2>6.3. Xác định vùng quan sát bất thường<a class="headerlink" href="#xac-dinh-vung-quan-sat-bat-thuong" title="Permalink to this headline">¶</a></h2>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span>tidyverse_cran_downloads <span class="o">%&gt;%</span>
    <span class="c1"># Select single time series</span>
    filter<span class="p">(</span>package <span class="o">==</span> <span class="s">&quot;lubridate&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span>
    ungroup<span class="p">()</span> <span class="o">%&gt;%</span>
    <span class="c1"># Anomalize</span>
    time_decompose<span class="p">(</span>count<span class="p">,</span> method <span class="o">=</span> <span class="s">&quot;stl&quot;</span><span class="p">,</span> frequency <span class="o">=</span> <span class="s">&quot;auto&quot;</span><span class="p">,</span> trend <span class="o">=</span> <span class="s">&quot;auto&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span>
    anomalize<span class="p">(</span>remainder<span class="p">,</span> method <span class="o">=</span> <span class="s">&quot;iqr&quot;</span><span class="p">,</span> alpha <span class="o">=</span> <span class="m">0.05</span><span class="p">,</span> max_anoms <span class="o">=</span> <span class="m">0.2</span><span class="p">)</span> <span class="o">%&gt;%</span>
    time_recompose<span class="p">()</span> <span class="o">%&gt;%</span>
    <span class="c1"># Plot Anomaly Decomposition</span>
    plot_anomalies<span class="p">(</span>time_recomposed <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="o">+</span>
    ggtitle<span class="p">(</span><span class="s">&quot;Lubridate Downloads: Anomalies Detected&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="image1" src="p05-08-abnomaly-detection_files/figure-html/unnamed-chunk-8-1.png" /></p>
</div>
<div class="section" id="tai-lieu-tham-khao">
<h2>6.4. Tài liệu tham khảo<a class="headerlink" href="#tai-lieu-tham-khao" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://www.business-science.io/code-tools/2018/04/08/introducing-anomalize.html">https://www.business-science.io/code-tools/2018/04/08/introducing-anomalize.html</a></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="p06-01-nlp-co-ban.html" class="btn btn-neutral float-right" title="1. Xử lý ngôn ngữ tự nhiên cơ bản" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="p05-07-du-bao-ts-voi-timetk.html" class="btn btn-neutral float-left" title="5. Dự báo chuỗi thời gian với timetk" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Anh Hoang Duc

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>