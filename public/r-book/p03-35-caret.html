

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="vi" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="vi" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>11. Xây dựng mô hình dự báo với caret &mdash; Tài liệu Phân tích dữ liệu với R 2019</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'./',
              VERSION:'2019',
              LANGUAGE:'vi',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
        <script type="text/javascript" src="_static/copybutton.js"></script>
        <script type="text/javascript" src="_static/translations.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Tìm Kiếm" href="search.html" />
    <link rel="next" title="12. Chất lượng mô hình" href="p03-65-chat-luong-mo-hinh.html" />
    <link rel="prev" title="10. Credit Scoring" href="p03-30-credit-scoring.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Phân tích dữ liệu với R
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Giới thiệu</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p01-01-gioi-thieu.html">Khoa học dữ liệu và nghề phân tích dữ liệu</a></li>
</ul>
<p class="caption"><span class="caption-text">Phân tích khám phá dữ liệu</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p02-03-bien-doi-du-lieu-dplyr.html">1. Ngữ pháp của biến đổi dữ liệu với DPLYR</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-04-phan-ra-va-xoay-chieu-du-lieu.html">2. Phân rã và xoay chiều dữ liệu</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-05-cac-chi-so-thong-ke.html">3. Các chỉ số thống kê mô tả cơ bản</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-06-lap-trinh-ham.html">4. Lập trình hàm</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-07-lap-trinh-ham-voi-purrr.html">5. Lập trình chức năng hàm với purrr</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-08-bien-doi-du-lieu-text.html">6. Biến đổi dữ liệu text</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-11-quan-ly-nhieu-mo-hinh.html">7. Quản lý kết quả phân tích từ nhiều mô hình</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-15-thong-ke-co-ban.html">8. Xác suất và phân phối thống kê cơ bản</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-16-power-analysis.html">9. Power analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-20-sampling-methods.html">10. Phương pháp ước lượng lấy mẫu</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-50-datatable.html">11. Biến đổi dữ liệu với <code class="docutils literal notranslate"><span class="pre">data.table</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-60-thu-thap-du-lieu-tu-website.html">12. Thu thập dữ liệu từ website</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-99-meo-trong-r.html">13. Các mẹo trong R</a></li>
</ul>
<p class="caption"><span class="caption-text">Supervised learning</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="p03-01-nguyen-ly-du-bao.html">1. Các nguyên lý dự báo</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-02-mo-hinh-ols.html">2. Mô hình OLS</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-03-logistic-regression.html">3. Mô hình hồi quy logistic</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-04-decision-tree.html">4. Cây quyết định</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-05-bagging-boosting.html">5. Bagging, RandomForest và Boosting</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-08-svm.html">6. Support Vector Machine</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-09-feature-engineering.html">7. Feature Engineering</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-15-regularization.html">8. Regularization</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-17-nonlinear.html">9. Mô hình phi tuyến tính</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-30-credit-scoring.html">10. Credit Scoring</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">11. Xây dựng mô hình dự báo với caret</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#gioi-thieu">11.1. Giới thiệu</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tuning-parameter">11.2. Tuning parameter</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tai-lieu-tham-khao">11.3. Tài liệu tham khảo</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="p03-65-chat-luong-mo-hinh.html">12. Chất lượng mô hình</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-70-tidymodels.html">13. Tidymodels</a></li>
</ul>
<p class="caption"><span class="caption-text">Unsupervised learning</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p04-01-unsupervised-learning.html">1. Unsupervised learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="p04-02-kmeans.html">2. k-means</a></li>
<li class="toctree-l1"><a class="reference internal" href="p04-03-hierarchical-clustering.html">3. Hierachical clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="p04-04-basket-analysis.html">4. Phân tích giỏ hàng</a></li>
<li class="toctree-l1"><a class="reference internal" href="p04-05-pca.html">5. Principal component analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="p04-06-factor-analysis.html">6. Phân tích nhân tố ẩn (factor analysis)</a></li>
</ul>
<p class="caption"><span class="caption-text">Chuỗi thời gian</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p05-01-chuoi-thoi-gian.html">1. Giới thiệu về chuỗi thời gian</a></li>
<li class="toctree-l1"><a class="reference internal" href="p05-02-arima.html">2. Mô hình ARIMA</a></li>
<li class="toctree-l1"><a class="reference internal" href="p05-03-phan-tich-chuoi-thoi-gian-voi-tidyquant.html">3. Phân tích chuỗi thời gian với tidyquant và timetk</a></li>
<li class="toctree-l1"><a class="reference internal" href="p05-06-du-bao-ts-voi-prophet.html">4. Dự báo chuỗi thời gian với prophet</a></li>
<li class="toctree-l1"><a class="reference internal" href="p05-07-du-bao-ts-voi-timetk.html">5. Dự báo chuỗi thời gian với timetk</a></li>
<li class="toctree-l1"><a class="reference internal" href="p05-08-abnomaly-detection.html">6. Abnomaly detection trong times series</a></li>
</ul>
<p class="caption"><span class="caption-text">Ngôn ngữ tự nghiên</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p06-01-nlp-co-ban.html">1. Xử lý ngôn ngữ tự nhiên cơ bản</a></li>
<li class="toctree-l1"><a class="reference internal" href="p06-04-text-classification.html">2. Phân loại text</a></li>
<li class="toctree-l1"><a class="reference internal" href="p06-07-nlp-api.html">3. Sử dụng API từ các dịch vụ đám mây</a></li>
<li class="toctree-l1"><a class="reference internal" href="p06-10-ocr-tesseract.html">4. OCR với <code class="docutils literal notranslate"><span class="pre">tesseract</span></code></a></li>
</ul>
<p class="caption"><span class="caption-text">Các phương pháp khác</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p07-01-survival-analysis.html">1. Survival analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="p07-02-causal-impact.html">2. Causal Impact</a></li>
<li class="toctree-l1"><a class="reference internal" href="p07-03-collaborative-filtering.html">3. Collaborative Filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="p07-07-spatial-data.html">4. Spatial data</a></li>
<li class="toctree-l1"><a class="reference internal" href="p07-10-shiny.html">5. Shiny apps</a></li>
</ul>
<p class="caption"><span class="caption-text">Deep Learning</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p09-01-gioi-thieu-deep-learning.html">1. Giới thiệu cơ bản về Deep Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="p09-02-co-ban-kien-thuc-toan.html">2. Kiến thức cơ bản toán học cho deep learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="p09-03-mo-hinh-deep-learning-co-ban.html">3. Mô hình deep learning cơ bản</a></li>
<li class="toctree-l1"><a class="reference internal" href="p09-04-convolution-neural-network.html">4. Convolution neural networks</a></li>
</ul>
<p class="caption"><span class="caption-text">Cloud Computing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p10-01-cai-dat-rstudio-server-tren-amazon.html">1. Cài đặt server RStudio trên Amazon</a></li>
<li class="toctree-l1"><a class="reference internal" href="p10-03-web-service-azure.html">2. Xây dựng web service với Azure</a></li>
<li class="toctree-l1"><a class="reference internal" href="p10-09-apis-voi-plumber.html">3. API với Plumber</a></li>
</ul>
<p class="caption"><span class="caption-text">Kiến thức bổ trợ</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p11-01-git.html">1. Sử dụng GIT</a></li>
<li class="toctree-l1"><a class="reference internal" href="p11-02-cmd.html">2. CMD và Bash</a></li>
<li class="toctree-l1"><a class="reference internal" href="p11-03-docker.html">3. Sử dụng docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="p11-04-apis.html">4. API</a></li>
<li class="toctree-l1"><a class="reference internal" href="p11-05-html-css.html">5. Cơ bản về HTML và CSS</a></li>
<li class="toctree-l1"><a class="reference internal" href="p11-09-other.html">6. Các tricks khác</a></li>
</ul>
<p class="caption"><span class="caption-text">Case studies</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p13-01-casestudy-truc-quan-hoa.html">1. Trực quan hóa dữ liệu</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Phân tích dữ liệu với R</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>11. Xây dựng mô hình dự báo với caret</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/p03-35-caret.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="xay-dung-mo-hinh-du-bao-voi-caret">
<h1>11. Xây dựng mô hình dự báo với caret<a class="headerlink" href="#xay-dung-mo-hinh-du-bao-voi-caret" title="Permalink to this headline">¶</a></h1>
<div class="section" id="gioi-thieu">
<h2>11.1. Giới thiệu<a class="headerlink" href="#gioi-thieu" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">Caret</span></code> (viết tắt của <code class="docutils literal notranslate"><span class="pre">Classification</span> <span class="pre">&amp;</span> <span class="pre">Regression</span></code>) là một package
được sử dụng rộng rãi trong việc xây dựng mô hình dự báo, đặc biệt hữu
dụng khi học và tìm hiểu các concept của <code class="docutils literal notranslate"><span class="pre">machine</span> <span class="pre">learning</span></code>. Tuy
nhiên, khi xây dựng mô hình thực tế sẽ gặp vấn đề về tốc độ.Chương này
chỉ thuần túy mang tính chất giới thiệu về <code class="docutils literal notranslate"><span class="pre">caret</span></code> trọng xây dựng mô
hình <code class="docutils literal notranslate"><span class="pre">supervised</span> <span class="pre">learning</span></code>.</p>
<p>Trong caret có 1 số hàm cơ bản sau:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">createDataPartition</span></code>: Tạo train &amp; test</li>
<li><code class="docutils literal notranslate"><span class="pre">train</span></code>: xây dựng mô hình, áp dụng cấu trúc <strong>gần như</strong> đồng nhất
giữa các mô hình (đây là điểm mạnh rất lớn của caret)</li>
</ul>
<p><strong>Mô hình đơn giản</strong>:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">pkg</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;caret&quot;</span><span class="p">,</span> <span class="s">&quot;dplyr&quot;</span><span class="p">,</span> <span class="s">&quot;mlbench&quot;</span><span class="p">)</span>
<span class="nf">lapply</span><span class="p">(</span><span class="n">pkg</span><span class="p">,</span> <span class="n">library</span><span class="p">,</span> <span class="n">character.only</span> <span class="o">=</span> <span class="bp">T</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">## [[1]]</span>
<span class="c1">##  [1] &quot;caret&quot;     &quot;ggplot2&quot;   &quot;lattice&quot;   &quot;methods&quot;   &quot;stats&quot;</span>
<span class="c1">##  [6] &quot;graphics&quot;  &quot;grDevices&quot; &quot;utils&quot;     &quot;datasets&quot;  &quot;base&quot;</span>
<span class="c1">##</span>
<span class="c1">## [[2]]</span>
<span class="c1">##  [1] &quot;dplyr&quot;     &quot;caret&quot;     &quot;ggplot2&quot;   &quot;lattice&quot;   &quot;methods&quot;</span>
<span class="c1">##  [6] &quot;stats&quot;     &quot;graphics&quot;  &quot;grDevices&quot; &quot;utils&quot;     &quot;datasets&quot;</span>
<span class="c1">## [11] &quot;base&quot;</span>
<span class="c1">##</span>
<span class="c1">## [[3]]</span>
<span class="c1">##  [1] &quot;mlbench&quot;   &quot;dplyr&quot;     &quot;caret&quot;     &quot;ggplot2&quot;   &quot;lattice&quot;</span>
<span class="c1">##  [6] &quot;methods&quot;   &quot;stats&quot;     &quot;graphics&quot;  &quot;grDevices&quot; &quot;utils&quot;</span>
<span class="c1">## [11] &quot;datasets&quot;  &quot;base&quot;</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Tạo tập train &amp; test</span>
<span class="n">inTrain</span> <span class="o">&lt;-</span> <span class="nf">createDataPartition</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="p">,</span>
                               <span class="n">p</span> <span class="o">=</span> <span class="m">0.75</span><span class="p">,</span>
                               <span class="n">list</span> <span class="o">=</span> <span class="bp">F</span><span class="p">)</span>
<span class="n">train</span> <span class="o">&lt;-</span> <span class="n">iris[inTrain</span><span class="p">,</span><span class="n">]</span>
<span class="n">test</span> <span class="o">&lt;-</span> <span class="n">iris[</span><span class="o">-</span><span class="n">inTrain</span><span class="p">,</span><span class="n">]</span>
<span class="c1">#Mô hình</span>
<span class="n">rf.model</span> <span class="o">&lt;-</span> <span class="nf">train</span><span class="p">(</span><span class="n">Species</span> <span class="o">~</span> <span class="n">.,</span>
                  <span class="n">data</span> <span class="o">=</span> <span class="n">train</span><span class="p">,</span>
                  <span class="n">method</span> <span class="o">=</span> <span class="s">&quot;rf&quot;</span><span class="p">,</span>
                  <span class="n">preProc</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;center&quot;</span><span class="p">,</span> <span class="s">&quot;scale&quot;</span><span class="p">))</span> <span class="c1">#Preprocess: Center &amp; scale</span>
<span class="n">rf.model</span> <span class="o">%&gt;%</span> <span class="n">summary</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##                 Length Class      Mode</span>
<span class="c1">## call               4   -none-     call</span>
<span class="c1">## type               1   -none-     character</span>
<span class="c1">## predicted        114   factor     numeric</span>
<span class="c1">## err.rate        2000   -none-     numeric</span>
<span class="c1">## confusion         12   -none-     numeric</span>
<span class="c1">## votes            342   matrix     numeric</span>
<span class="c1">## oob.times        114   -none-     numeric</span>
<span class="c1">## classes            3   -none-     character</span>
<span class="c1">## importance         4   -none-     numeric</span>
<span class="c1">## importanceSD       0   -none-     NULL</span>
<span class="c1">## localImportance    0   -none-     NULL</span>
<span class="c1">## proximity          0   -none-     NULL</span>
<span class="c1">## ntree              1   -none-     numeric</span>
<span class="c1">## mtry               1   -none-     numeric</span>
<span class="c1">## forest            14   -none-     list</span>
<span class="c1">## y                114   factor     numeric</span>
<span class="c1">## test               0   -none-     NULL</span>
<span class="c1">## inbag              0   -none-     NULL</span>
<span class="c1">## xNames             4   -none-     character</span>
<span class="c1">## problemType        1   -none-     character</span>
<span class="c1">## tuneValue          1   data.frame list</span>
<span class="c1">## obsLevels          3   -none-     character</span>
</pre></div>
</div>
<p><strong>Mô hình phức tạp</strong>:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Train &amp; test</span>
<span class="n">inTrain</span> <span class="o">&lt;-</span> <span class="nf">createDataPartition</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="p">,</span>
                               <span class="n">p</span> <span class="o">=</span> <span class="m">0.75</span><span class="p">,</span>
                               <span class="n">list</span> <span class="o">=</span> <span class="bp">F</span><span class="p">)</span>
<span class="n">train</span> <span class="o">&lt;-</span> <span class="n">iris[inTrain</span><span class="p">,</span><span class="n">]</span>
<span class="n">test</span> <span class="o">&lt;-</span> <span class="n">iris[</span><span class="o">-</span><span class="n">inTrain</span><span class="p">,</span><span class="n">]</span>

<span class="c1">#Xây dựng mô hình</span>

<span class="n">ctrl</span> <span class="o">&lt;-</span> <span class="nf">trainControl</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="s">&quot;repeatedcv&quot;</span><span class="p">,</span> <span class="c1">#repeated cross validate</span>
                     <span class="n">repeats</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span>
                     <span class="n">classProbs</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>

<span class="n">rf.model</span> <span class="o">&lt;-</span> <span class="nf">train</span><span class="p">(</span><span class="n">Species</span> <span class="o">~</span> <span class="n">.,</span>
                  <span class="n">data</span> <span class="o">=</span> <span class="n">train</span><span class="p">,</span>
                  <span class="n">method</span> <span class="o">=</span> <span class="s">&quot;rf&quot;</span><span class="p">,</span>
                  <span class="n">trainControl</span> <span class="o">=</span> <span class="n">ctrl</span><span class="p">,</span>
                  <span class="n">metric</span> <span class="o">=</span> <span class="s">&quot;Accuracy&quot;</span><span class="p">,</span>
                  <span class="n">preProc</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;center&quot;</span><span class="p">,</span> <span class="s">&quot;scale&quot;</span><span class="p">))</span> <span class="c1">#Preprocess: Center &amp; scale</span>

<span class="n">fit.lda</span> <span class="o">&lt;-</span> <span class="nf">train</span><span class="p">(</span><span class="n">Species</span> <span class="o">~</span> <span class="n">.,</span>
                  <span class="n">data</span> <span class="o">=</span> <span class="n">train</span><span class="p">,</span>
                  <span class="n">method</span> <span class="o">=</span> <span class="s">&quot;lda&quot;</span><span class="p">,</span>
                  <span class="n">trainControl</span> <span class="o">=</span> <span class="n">ctrl</span><span class="p">,</span>
                  <span class="n">metric</span> <span class="o">=</span> <span class="s">&quot;Accuracy&quot;</span><span class="p">,</span>
                  <span class="n">preProc</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;center&quot;</span><span class="p">,</span> <span class="s">&quot;scale&quot;</span><span class="p">))</span> <span class="c1">#Preprocess: Center &amp; scale</span>

<span class="n">fit.multi</span> <span class="o">&lt;-</span> <span class="nf">train</span><span class="p">(</span><span class="n">Species</span> <span class="o">~</span> <span class="n">.,</span>
                  <span class="n">data</span> <span class="o">=</span> <span class="n">train</span><span class="p">,</span>
                  <span class="n">method</span> <span class="o">=</span> <span class="s">&quot;multinom&quot;</span><span class="p">,</span>
                  <span class="n">trainControl</span> <span class="o">=</span> <span class="n">ctrl</span><span class="p">,</span>
                  <span class="n">metric</span> <span class="o">=</span> <span class="s">&quot;Accuracy&quot;</span><span class="p">,</span>
                  <span class="n">preProc</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;center&quot;</span><span class="p">,</span> <span class="s">&quot;scale&quot;</span><span class="p">))</span> <span class="c1">#Preprocess: Center &amp; scale</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 6.176570</span>
<span class="c1">## iter  20 value 5.341061</span>
<span class="c1">## iter  30 value 4.778221</span>
<span class="c1">## iter  40 value 4.641302</span>
<span class="c1">## iter  50 value 4.365494</span>
<span class="c1">## iter  60 value 4.361504</span>
<span class="c1">## iter  70 value 4.052398</span>
<span class="c1">## iter  80 value 4.050875</span>
<span class="c1">## iter  90 value 3.998230</span>
<span class="c1">## iter 100 value 3.997568</span>
<span class="c1">## final  value 3.997568</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 27.114628</span>
<span class="c1">## iter  20 value 20.773516</span>
<span class="c1">## final  value 20.773491</span>
<span class="c1">## converged</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 6.221362</span>
<span class="c1">## iter  20 value 5.465538</span>
<span class="c1">## iter  30 value 5.020350</span>
<span class="c1">## iter  40 value 4.951651</span>
<span class="c1">## iter  50 value 4.933149</span>
<span class="c1">## iter  60 value 4.931498</span>
<span class="c1">## iter  70 value 4.928467</span>
<span class="c1">## iter  80 value 4.928229</span>
<span class="c1">## iter  90 value 4.927767</span>
<span class="c1">## iter 100 value 4.927738</span>
<span class="c1">## final  value 4.927738</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 3.026705</span>
<span class="c1">## iter  20 value 1.866203</span>
<span class="c1">## iter  30 value 0.923497</span>
<span class="c1">## iter  40 value 0.771896</span>
<span class="c1">## iter  50 value 0.749492</span>
<span class="c1">## iter  60 value 0.559132</span>
<span class="c1">## iter  70 value 0.268798</span>
<span class="c1">## iter  80 value 0.194487</span>
<span class="c1">## iter  90 value 0.175106</span>
<span class="c1">## iter 100 value 0.160562</span>
<span class="c1">## final  value 0.160562</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 18.985319</span>
<span class="c1">## iter  20 value 18.362246</span>
<span class="c1">## final  value 18.362245</span>
<span class="c1">## converged</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 3.078461</span>
<span class="c1">## iter  20 value 2.080872</span>
<span class="c1">## iter  30 value 1.541416</span>
<span class="c1">## iter  40 value 1.463696</span>
<span class="c1">## iter  50 value 1.452629</span>
<span class="c1">## iter  60 value 1.422461</span>
<span class="c1">## iter  70 value 1.401208</span>
<span class="c1">## iter  80 value 1.397582</span>
<span class="c1">## iter  90 value 1.394820</span>
<span class="c1">## iter 100 value 1.392655</span>
<span class="c1">## final  value 1.392655</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 10.442630</span>
<span class="c1">## iter  20 value 1.971397</span>
<span class="c1">## iter  30 value 0.318888</span>
<span class="c1">## iter  40 value 0.207513</span>
<span class="c1">## iter  50 value 0.027753</span>
<span class="c1">## iter  60 value 0.021888</span>
<span class="c1">## iter  70 value 0.020673</span>
<span class="c1">## iter  80 value 0.020435</span>
<span class="c1">## iter  90 value 0.020058</span>
<span class="c1">## iter 100 value 0.019512</span>
<span class="c1">## final  value 0.019512</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 20.798333</span>
<span class="c1">## iter  20 value 20.121614</span>
<span class="c1">## final  value 20.121613</span>
<span class="c1">## converged</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 10.459458</span>
<span class="c1">## iter  20 value 3.946601</span>
<span class="c1">## iter  30 value 2.858295</span>
<span class="c1">## iter  40 value 2.666495</span>
<span class="c1">## iter  50 value 2.554138</span>
<span class="c1">## iter  60 value 2.382597</span>
<span class="c1">## iter  70 value 2.289623</span>
<span class="c1">## iter  80 value 2.285488</span>
<span class="c1">## iter  90 value 2.252438</span>
<span class="c1">## iter 100 value 2.251352</span>
<span class="c1">## final  value 2.251352</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 6.409820</span>
<span class="c1">## iter  20 value 2.438666</span>
<span class="c1">## iter  30 value 1.524416</span>
<span class="c1">## iter  40 value 1.307778</span>
<span class="c1">## iter  50 value 1.202816</span>
<span class="c1">## iter  60 value 1.153514</span>
<span class="c1">## iter  70 value 1.003864</span>
<span class="c1">## iter  80 value 0.976504</span>
<span class="c1">## iter  90 value 0.917271</span>
<span class="c1">## iter 100 value 0.865057</span>
<span class="c1">## final  value 0.865057</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 18.450806</span>
<span class="c1">## iter  20 value 18.128582</span>
<span class="c1">## final  value 18.128581</span>
<span class="c1">## converged</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 6.434735</span>
<span class="c1">## iter  20 value 2.696777</span>
<span class="c1">## iter  30 value 2.197456</span>
<span class="c1">## iter  40 value 2.113034</span>
<span class="c1">## iter  50 value 2.028999</span>
<span class="c1">## iter  60 value 1.953341</span>
<span class="c1">## iter  70 value 1.877024</span>
<span class="c1">## iter  80 value 1.871800</span>
<span class="c1">## iter  90 value 1.868866</span>
<span class="c1">## iter 100 value 1.859438</span>
<span class="c1">## final  value 1.859438</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 4.013380</span>
<span class="c1">## iter  20 value 3.300112</span>
<span class="c1">## iter  30 value 2.421079</span>
<span class="c1">## iter  40 value 1.516880</span>
<span class="c1">## iter  50 value 0.300459</span>
<span class="c1">## iter  60 value 0.146707</span>
<span class="c1">## iter  70 value 0.113139</span>
<span class="c1">## iter  80 value 0.109961</span>
<span class="c1">## iter  90 value 0.076279</span>
<span class="c1">## iter 100 value 0.071565</span>
<span class="c1">## final  value 0.071565</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 17.592085</span>
<span class="c1">## iter  20 value 17.444398</span>
<span class="c1">## iter  20 value 17.444398</span>
<span class="c1">## iter  20 value 17.444398</span>
<span class="c1">## final  value 17.444398</span>
<span class="c1">## converged</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 4.062540</span>
<span class="c1">## iter  20 value 3.408424</span>
<span class="c1">## iter  30 value 2.675189</span>
<span class="c1">## iter  40 value 1.965960</span>
<span class="c1">## iter  50 value 1.630389</span>
<span class="c1">## iter  60 value 1.605742</span>
<span class="c1">## iter  70 value 1.599344</span>
<span class="c1">## iter  80 value 1.591235</span>
<span class="c1">## iter  90 value 1.585818</span>
<span class="c1">## iter 100 value 1.580624</span>
<span class="c1">## final  value 1.580624</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 9.154722</span>
<span class="c1">## iter  20 value 0.345289</span>
<span class="c1">## iter  30 value 0.021335</span>
<span class="c1">## iter  40 value 0.003976</span>
<span class="c1">## iter  50 value 0.002815</span>
<span class="c1">## iter  60 value 0.001679</span>
<span class="c1">## iter  70 value 0.001475</span>
<span class="c1">## iter  80 value 0.000833</span>
<span class="c1">## iter  90 value 0.000793</span>
<span class="c1">## iter 100 value 0.000743</span>
<span class="c1">## final  value 0.000743</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 20.937251</span>
<span class="c1">## iter  20 value 20.328498</span>
<span class="c1">## final  value 20.328497</span>
<span class="c1">## converged</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 9.175117</span>
<span class="c1">## iter  20 value 1.358223</span>
<span class="c1">## iter  30 value 0.969741</span>
<span class="c1">## iter  40 value 0.913134</span>
<span class="c1">## iter  50 value 0.861629</span>
<span class="c1">## iter  60 value 0.816820</span>
<span class="c1">## iter  70 value 0.778065</span>
<span class="c1">## iter  80 value 0.774683</span>
<span class="c1">## iter  90 value 0.768872</span>
<span class="c1">## iter 100 value 0.764491</span>
<span class="c1">## final  value 0.764491</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 5.985223</span>
<span class="c1">## iter  20 value 0.188201</span>
<span class="c1">## iter  30 value 0.014862</span>
<span class="c1">## iter  40 value 0.007541</span>
<span class="c1">## iter  50 value 0.006478</span>
<span class="c1">## iter  60 value 0.005331</span>
<span class="c1">## iter  70 value 0.004105</span>
<span class="c1">## iter  80 value 0.003909</span>
<span class="c1">## iter  90 value 0.003436</span>
<span class="c1">## iter 100 value 0.003362</span>
<span class="c1">## final  value 0.003362</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 17.800007</span>
<span class="c1">## final  value 17.634138</span>
<span class="c1">## converged</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 6.012575</span>
<span class="c1">## iter  20 value 1.213522</span>
<span class="c1">## iter  30 value 1.039497</span>
<span class="c1">## iter  40 value 0.993055</span>
<span class="c1">## iter  50 value 0.969230</span>
<span class="c1">## iter  60 value 0.927397</span>
<span class="c1">## iter  70 value 0.861154</span>
<span class="c1">## iter  80 value 0.856888</span>
<span class="c1">## iter  90 value 0.854375</span>
<span class="c1">## iter 100 value 0.852510</span>
<span class="c1">## final  value 0.852510</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 8.064391</span>
<span class="c1">## iter  20 value 5.178569</span>
<span class="c1">## iter  30 value 5.132698</span>
<span class="c1">## iter  40 value 5.117701</span>
<span class="c1">## iter  50 value 5.116423</span>
<span class="c1">## iter  60 value 5.116321</span>
<span class="c1">## final  value 5.116315</span>
<span class="c1">## converged</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 19.758999</span>
<span class="c1">## iter  20 value 19.427449</span>
<span class="c1">## final  value 19.427449</span>
<span class="c1">## converged</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 8.092545</span>
<span class="c1">## iter  20 value 5.265086</span>
<span class="c1">## iter  30 value 5.225933</span>
<span class="c1">## iter  40 value 5.213166</span>
<span class="c1">## iter  50 value 5.210079</span>
<span class="c1">## iter  60 value 5.207047</span>
<span class="c1">## iter  70 value 5.206066</span>
<span class="c1">## iter  80 value 5.204485</span>
<span class="c1">## iter  90 value 5.202816</span>
<span class="c1">## iter 100 value 5.201612</span>
<span class="c1">## final  value 5.201612</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 5.794120</span>
<span class="c1">## iter  20 value 4.103309</span>
<span class="c1">## iter  30 value 3.641266</span>
<span class="c1">## iter  40 value 0.527809</span>
<span class="c1">## iter  50 value 0.045513</span>
<span class="c1">## iter  60 value 0.042125</span>
<span class="c1">## iter  70 value 0.040490</span>
<span class="c1">## iter  80 value 0.037526</span>
<span class="c1">## iter  90 value 0.037342</span>
<span class="c1">## iter 100 value 0.037315</span>
<span class="c1">## final  value 0.037315</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 22.038344</span>
<span class="c1">## iter  20 value 21.254531</span>
<span class="c1">## final  value 21.254531</span>
<span class="c1">## converged</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 5.839575</span>
<span class="c1">## iter  20 value 4.341468</span>
<span class="c1">## iter  30 value 4.024860</span>
<span class="c1">## iter  40 value 3.979235</span>
<span class="c1">## iter  50 value 3.968696</span>
<span class="c1">## iter  60 value 3.939459</span>
<span class="c1">## iter  70 value 3.926564</span>
<span class="c1">## iter  80 value 3.926097</span>
<span class="c1">## iter  90 value 3.924382</span>
<span class="c1">## iter 100 value 3.923744</span>
<span class="c1">## final  value 3.923744</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 5.681941</span>
<span class="c1">## iter  20 value 4.246581</span>
<span class="c1">## iter  30 value 2.975122</span>
<span class="c1">## iter  40 value 2.736340</span>
<span class="c1">## iter  50 value 1.558157</span>
<span class="c1">## iter  60 value 1.505793</span>
<span class="c1">## iter  70 value 1.411722</span>
<span class="c1">## iter  80 value 1.357959</span>
<span class="c1">## iter  90 value 1.209468</span>
<span class="c1">## iter 100 value 1.134581</span>
<span class="c1">## final  value 1.134581</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 20.508767</span>
<span class="c1">## iter  20 value 20.019049</span>
<span class="c1">## final  value 20.019049</span>
<span class="c1">## converged</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 5.727211</span>
<span class="c1">## iter  20 value 4.417710</span>
<span class="c1">## iter  30 value 3.536318</span>
<span class="c1">## iter  40 value 3.346961</span>
<span class="c1">## iter  50 value 3.281763</span>
<span class="c1">## iter  60 value 3.234644</span>
<span class="c1">## iter  70 value 3.195353</span>
<span class="c1">## iter  80 value 3.184344</span>
<span class="c1">## iter  90 value 3.182614</span>
<span class="c1">## iter 100 value 3.180034</span>
<span class="c1">## final  value 3.180034</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 4.343479</span>
<span class="c1">## iter  20 value 3.436159</span>
<span class="c1">## iter  30 value 2.187951</span>
<span class="c1">## iter  40 value 2.062865</span>
<span class="c1">## iter  50 value 1.929782</span>
<span class="c1">## iter  60 value 1.857871</span>
<span class="c1">## iter  70 value 1.375510</span>
<span class="c1">## iter  80 value 1.321750</span>
<span class="c1">## iter  90 value 1.287253</span>
<span class="c1">## iter 100 value 1.255095</span>
<span class="c1">## final  value 1.255095</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 20.087721</span>
<span class="c1">## iter  20 value 19.931552</span>
<span class="c1">## iter  20 value 19.931552</span>
<span class="c1">## iter  20 value 19.931552</span>
<span class="c1">## final  value 19.931552</span>
<span class="c1">## converged</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 4.404276</span>
<span class="c1">## iter  20 value 3.601415</span>
<span class="c1">## iter  30 value 3.245441</span>
<span class="c1">## iter  40 value 3.203369</span>
<span class="c1">## iter  50 value 3.167227</span>
<span class="c1">## iter  60 value 3.120101</span>
<span class="c1">## iter  70 value 3.095445</span>
<span class="c1">## iter  80 value 3.085733</span>
<span class="c1">## iter  90 value 3.078655</span>
<span class="c1">## iter 100 value 3.073284</span>
<span class="c1">## final  value 3.073284</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 10.137304</span>
<span class="c1">## iter  20 value 0.098722</span>
<span class="c1">## iter  30 value 0.017566</span>
<span class="c1">## iter  40 value 0.015084</span>
<span class="c1">## iter  50 value 0.006000</span>
<span class="c1">## iter  60 value 0.005127</span>
<span class="c1">## iter  70 value 0.004391</span>
<span class="c1">## iter  80 value 0.004234</span>
<span class="c1">## iter  90 value 0.002741</span>
<span class="c1">## iter 100 value 0.002711</span>
<span class="c1">## final  value 0.002711</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 19.787810</span>
<span class="c1">## iter  20 value 18.647934</span>
<span class="c1">## final  value 18.647933</span>
<span class="c1">## converged</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 10.153408</span>
<span class="c1">## iter  20 value 0.950217</span>
<span class="c1">## iter  30 value 0.883673</span>
<span class="c1">## iter  40 value 0.808340</span>
<span class="c1">## iter  50 value 0.797202</span>
<span class="c1">## iter  60 value 0.749538</span>
<span class="c1">## iter  70 value 0.716719</span>
<span class="c1">## iter  80 value 0.696124</span>
<span class="c1">## iter  90 value 0.693784</span>
<span class="c1">## iter 100 value 0.684138</span>
<span class="c1">## final  value 0.684138</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 10.414742</span>
<span class="c1">## iter  20 value 5.013869</span>
<span class="c1">## iter  30 value 4.154269</span>
<span class="c1">## iter  40 value 4.045036</span>
<span class="c1">## iter  50 value 4.018613</span>
<span class="c1">## iter  60 value 3.918570</span>
<span class="c1">## iter  70 value 3.765089</span>
<span class="c1">## iter  80 value 3.752942</span>
<span class="c1">## iter  90 value 3.733236</span>
<span class="c1">## iter 100 value 3.725114</span>
<span class="c1">## final  value 3.725114</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 20.625836</span>
<span class="c1">## iter  20 value 19.692398</span>
<span class="c1">## iter  20 value 19.692398</span>
<span class="c1">## iter  20 value 19.692398</span>
<span class="c1">## final  value 19.692398</span>
<span class="c1">## converged</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 10.431418</span>
<span class="c1">## iter  20 value 5.142600</span>
<span class="c1">## iter  30 value 4.658652</span>
<span class="c1">## iter  40 value 4.576101</span>
<span class="c1">## iter  50 value 4.438865</span>
<span class="c1">## iter  60 value 4.432239</span>
<span class="c1">## iter  70 value 4.417833</span>
<span class="c1">## iter  80 value 4.414917</span>
<span class="c1">## iter  90 value 4.411650</span>
<span class="c1">## iter 100 value 4.410447</span>
<span class="c1">## final  value 4.410447</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 3.385860</span>
<span class="c1">## iter  20 value 0.010911</span>
<span class="c1">## iter  30 value 0.001706</span>
<span class="c1">## iter  40 value 0.001012</span>
<span class="c1">## iter  50 value 0.000740</span>
<span class="c1">## iter  60 value 0.000704</span>
<span class="c1">## iter  70 value 0.000609</span>
<span class="c1">## iter  80 value 0.000404</span>
<span class="c1">## iter  90 value 0.000326</span>
<span class="c1">## iter 100 value 0.000261</span>
<span class="c1">## final  value 0.000261</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 15.580084</span>
<span class="c1">## iter  20 value 15.421268</span>
<span class="c1">## final  value 15.421267</span>
<span class="c1">## converged</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 3.419283</span>
<span class="c1">## iter  20 value 0.433849</span>
<span class="c1">## iter  30 value 0.363252</span>
<span class="c1">## iter  40 value 0.344132</span>
<span class="c1">## iter  50 value 0.313760</span>
<span class="c1">## iter  60 value 0.304172</span>
<span class="c1">## iter  70 value 0.282828</span>
<span class="c1">## iter  80 value 0.278172</span>
<span class="c1">## iter  90 value 0.276230</span>
<span class="c1">## iter 100 value 0.273982</span>
<span class="c1">## final  value 0.273982</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 1.799919</span>
<span class="c1">## iter  20 value 0.642055</span>
<span class="c1">## iter  30 value 0.196554</span>
<span class="c1">## iter  40 value 0.066964</span>
<span class="c1">## iter  50 value 0.058042</span>
<span class="c1">## iter  60 value 0.043480</span>
<span class="c1">## iter  70 value 0.040586</span>
<span class="c1">## iter  80 value 0.037745</span>
<span class="c1">## iter  90 value 0.029316</span>
<span class="c1">## iter 100 value 0.027160</span>
<span class="c1">## final  value 0.027160</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 18.691779</span>
<span class="c1">## iter  20 value 16.613514</span>
<span class="c1">## final  value 16.613513</span>
<span class="c1">## converged</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 1.854280</span>
<span class="c1">## iter  20 value 0.914366</span>
<span class="c1">## iter  30 value 0.611080</span>
<span class="c1">## iter  40 value 0.561045</span>
<span class="c1">## iter  50 value 0.556407</span>
<span class="c1">## iter  60 value 0.551178</span>
<span class="c1">## iter  70 value 0.550070</span>
<span class="c1">## iter  80 value 0.548636</span>
<span class="c1">## iter  90 value 0.547935</span>
<span class="c1">## iter 100 value 0.547324</span>
<span class="c1">## final  value 0.547324</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 10.518605</span>
<span class="c1">## iter  20 value 0.194840</span>
<span class="c1">## iter  30 value 0.039807</span>
<span class="c1">## iter  40 value 0.025768</span>
<span class="c1">## iter  50 value 0.020933</span>
<span class="c1">## iter  60 value 0.013461</span>
<span class="c1">## iter  70 value 0.010176</span>
<span class="c1">## iter  80 value 0.010135</span>
<span class="c1">## iter  90 value 0.010063</span>
<span class="c1">## iter 100 value 0.009245</span>
<span class="c1">## final  value 0.009245</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 22.575972</span>
<span class="c1">## iter  20 value 22.208531</span>
<span class="c1">## final  value 22.208531</span>
<span class="c1">## converged</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 10.543746</span>
<span class="c1">## iter  20 value 1.946736</span>
<span class="c1">## iter  30 value 1.858828</span>
<span class="c1">## iter  40 value 1.799531</span>
<span class="c1">## iter  50 value 1.787093</span>
<span class="c1">## iter  60 value 1.757268</span>
<span class="c1">## iter  70 value 1.737547</span>
<span class="c1">## iter  80 value 1.723744</span>
<span class="c1">## iter  90 value 1.720960</span>
<span class="c1">## iter 100 value 1.717537</span>
<span class="c1">## final  value 1.717537</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 3.862422</span>
<span class="c1">## iter  20 value 0.014472</span>
<span class="c1">## iter  30 value 0.002966</span>
<span class="c1">## iter  40 value 0.000834</span>
<span class="c1">## iter  50 value 0.000624</span>
<span class="c1">## iter  60 value 0.000405</span>
<span class="c1">## iter  70 value 0.000392</span>
<span class="c1">## iter  80 value 0.000238</span>
<span class="c1">## iter  90 value 0.000204</span>
<span class="c1">## iter 100 value 0.000160</span>
<span class="c1">## final  value 0.000160</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 15.727185</span>
<span class="c1">## iter  20 value 15.603029</span>
<span class="c1">## iter  20 value 15.603029</span>
<span class="c1">## iter  20 value 15.603029</span>
<span class="c1">## final  value 15.603029</span>
<span class="c1">## converged</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 3.885052</span>
<span class="c1">## iter  20 value 0.321954</span>
<span class="c1">## iter  30 value 0.277975</span>
<span class="c1">## iter  40 value 0.255690</span>
<span class="c1">## iter  50 value 0.245302</span>
<span class="c1">## iter  60 value 0.237720</span>
<span class="c1">## iter  70 value 0.233685</span>
<span class="c1">## iter  80 value 0.232290</span>
<span class="c1">## iter  90 value 0.226223</span>
<span class="c1">## iter 100 value 0.225617</span>
<span class="c1">## final  value 0.225617</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 3.384080</span>
<span class="c1">## iter  20 value 2.511031</span>
<span class="c1">## iter  30 value 2.166650</span>
<span class="c1">## iter  40 value 1.351716</span>
<span class="c1">## iter  50 value 0.906749</span>
<span class="c1">## iter  60 value 0.705780</span>
<span class="c1">## iter  70 value 0.703010</span>
<span class="c1">## iter  80 value 0.655348</span>
<span class="c1">## iter  90 value 0.281100</span>
<span class="c1">## iter 100 value 0.182635</span>
<span class="c1">## final  value 0.182635</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 19.461298</span>
<span class="c1">## iter  20 value 17.638899</span>
<span class="c1">## final  value 17.638897</span>
<span class="c1">## converged</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 3.430241</span>
<span class="c1">## iter  20 value 2.643057</span>
<span class="c1">## iter  30 value 2.439236</span>
<span class="c1">## iter  40 value 2.371260</span>
<span class="c1">## iter  50 value 2.361813</span>
<span class="c1">## iter  60 value 2.326110</span>
<span class="c1">## iter  70 value 2.305013</span>
<span class="c1">## iter  80 value 2.303377</span>
<span class="c1">## iter  90 value 2.302917</span>
<span class="c1">## iter 100 value 2.302207</span>
<span class="c1">## final  value 2.302207</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 6.197876</span>
<span class="c1">## iter  20 value 6.095849</span>
<span class="c1">## iter  30 value 6.056736</span>
<span class="c1">## iter  40 value 6.044429</span>
<span class="c1">## iter  50 value 6.042804</span>
<span class="c1">## iter  60 value 6.042788</span>
<span class="c1">## iter  70 value 6.042626</span>
<span class="c1">## final  value 6.042625</span>
<span class="c1">## converged</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 20.497584</span>
<span class="c1">## iter  20 value 19.919930</span>
<span class="c1">## final  value 19.919929</span>
<span class="c1">## converged</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 6.243954</span>
<span class="c1">## iter  20 value 6.152978</span>
<span class="c1">## iter  30 value 6.121176</span>
<span class="c1">## iter  40 value 6.115733</span>
<span class="c1">## iter  50 value 6.115472</span>
<span class="c1">## iter  60 value 6.115322</span>
<span class="c1">## iter  70 value 6.115066</span>
<span class="c1">## iter  80 value 6.115057</span>
<span class="c1">## iter  90 value 6.115037</span>
<span class="c1">## iter 100 value 6.115030</span>
<span class="c1">## final  value 6.115030</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 7.053560</span>
<span class="c1">## iter  20 value 4.473896</span>
<span class="c1">## iter  30 value 4.423906</span>
<span class="c1">## iter  40 value 4.416190</span>
<span class="c1">## iter  50 value 4.413294</span>
<span class="c1">## iter  60 value 4.412730</span>
<span class="c1">## iter  70 value 4.411702</span>
<span class="c1">## iter  80 value 4.411548</span>
<span class="c1">## iter  90 value 4.411373</span>
<span class="c1">## iter 100 value 4.411188</span>
<span class="c1">## final  value 4.411188</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 19.176513</span>
<span class="c1">## iter  20 value 18.970278</span>
<span class="c1">## iter  20 value 18.970277</span>
<span class="c1">## iter  20 value 18.970277</span>
<span class="c1">## final  value 18.970277</span>
<span class="c1">## converged</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 7.079494</span>
<span class="c1">## iter  20 value 4.567783</span>
<span class="c1">## iter  30 value 4.526056</span>
<span class="c1">## iter  40 value 4.518037</span>
<span class="c1">## iter  50 value 4.515478</span>
<span class="c1">## iter  60 value 4.513350</span>
<span class="c1">## iter  70 value 4.510088</span>
<span class="c1">## iter  80 value 4.508878</span>
<span class="c1">## iter  90 value 4.508439</span>
<span class="c1">## iter 100 value 4.507504</span>
<span class="c1">## final  value 4.507504</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 7.916037</span>
<span class="c1">## iter  20 value 1.959222</span>
<span class="c1">## iter  30 value 0.722919</span>
<span class="c1">## iter  40 value 0.632232</span>
<span class="c1">## iter  50 value 0.624568</span>
<span class="c1">## iter  60 value 0.532305</span>
<span class="c1">## iter  70 value 0.482408</span>
<span class="c1">## iter  80 value 0.470478</span>
<span class="c1">## iter  90 value 0.457533</span>
<span class="c1">## iter 100 value 0.446186</span>
<span class="c1">## final  value 0.446186</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 18.206453</span>
<span class="c1">## iter  20 value 17.788612</span>
<span class="c1">## final  value 17.788611</span>
<span class="c1">## converged</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 7.934039</span>
<span class="c1">## iter  20 value 2.891377</span>
<span class="c1">## iter  30 value 2.852060</span>
<span class="c1">## iter  40 value 2.797591</span>
<span class="c1">## iter  50 value 2.792562</span>
<span class="c1">## iter  60 value 2.757872</span>
<span class="c1">## iter  70 value 2.744258</span>
<span class="c1">## iter  80 value 2.736582</span>
<span class="c1">## iter  90 value 2.733009</span>
<span class="c1">## iter 100 value 2.725634</span>
<span class="c1">## final  value 2.725634</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 6.817112</span>
<span class="c1">## iter  20 value 0.075736</span>
<span class="c1">## iter  30 value 0.016001</span>
<span class="c1">## iter  40 value 0.002923</span>
<span class="c1">## iter  50 value 0.001730</span>
<span class="c1">## iter  60 value 0.001523</span>
<span class="c1">## iter  70 value 0.001304</span>
<span class="c1">## iter  80 value 0.001225</span>
<span class="c1">## iter  90 value 0.000792</span>
<span class="c1">## iter 100 value 0.000733</span>
<span class="c1">## final  value 0.000733</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 19.418005</span>
<span class="c1">## final  value 19.110079</span>
<span class="c1">## converged</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 6.845305</span>
<span class="c1">## iter  20 value 0.990769</span>
<span class="c1">## iter  30 value 0.804644</span>
<span class="c1">## iter  40 value 0.739128</span>
<span class="c1">## iter  50 value 0.727589</span>
<span class="c1">## iter  60 value 0.673328</span>
<span class="c1">## iter  70 value 0.638444</span>
<span class="c1">## iter  80 value 0.626744</span>
<span class="c1">## iter  90 value 0.623631</span>
<span class="c1">## iter 100 value 0.614244</span>
<span class="c1">## final  value 0.614244</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 2.578148</span>
<span class="c1">## iter  20 value 1.103958</span>
<span class="c1">## iter  30 value 0.412362</span>
<span class="c1">## iter  40 value 0.110806</span>
<span class="c1">## iter  50 value 0.100675</span>
<span class="c1">## iter  60 value 0.090952</span>
<span class="c1">## iter  70 value 0.058322</span>
<span class="c1">## iter  80 value 0.054836</span>
<span class="c1">## iter  90 value 0.052897</span>
<span class="c1">## iter 100 value 0.042801</span>
<span class="c1">## final  value 0.042801</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 16.668806</span>
<span class="c1">## iter  20 value 15.748596</span>
<span class="c1">## final  value 15.748595</span>
<span class="c1">## converged</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 2.629536</span>
<span class="c1">## iter  20 value 1.480691</span>
<span class="c1">## iter  30 value 1.106003</span>
<span class="c1">## iter  40 value 0.936605</span>
<span class="c1">## iter  50 value 0.923092</span>
<span class="c1">## iter  60 value 0.903206</span>
<span class="c1">## iter  70 value 0.896825</span>
<span class="c1">## iter  80 value 0.895602</span>
<span class="c1">## iter  90 value 0.895271</span>
<span class="c1">## iter 100 value 0.894722</span>
<span class="c1">## final  value 0.894722</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 6.349289</span>
<span class="c1">## iter  20 value 0.047378</span>
<span class="c1">## iter  30 value 0.005655</span>
<span class="c1">## iter  40 value 0.004342</span>
<span class="c1">## iter  50 value 0.003552</span>
<span class="c1">## iter  60 value 0.002990</span>
<span class="c1">## iter  70 value 0.002296</span>
<span class="c1">## iter  80 value 0.002254</span>
<span class="c1">## iter  90 value 0.001722</span>
<span class="c1">## iter 100 value 0.001688</span>
<span class="c1">## final  value 0.001688</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 18.291748</span>
<span class="c1">## iter  20 value 17.643578</span>
<span class="c1">## final  value 17.643577</span>
<span class="c1">## converged</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 6.369603</span>
<span class="c1">## iter  20 value 0.496882</span>
<span class="c1">## iter  30 value 0.458508</span>
<span class="c1">## iter  40 value 0.445248</span>
<span class="c1">## iter  50 value 0.421904</span>
<span class="c1">## iter  60 value 0.418124</span>
<span class="c1">## iter  70 value 0.417763</span>
<span class="c1">## iter  80 value 0.417257</span>
<span class="c1">## iter  90 value 0.416451</span>
<span class="c1">## iter 100 value 0.416095</span>
<span class="c1">## final  value 0.416095</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 2.408374</span>
<span class="c1">## iter  20 value 1.613814</span>
<span class="c1">## iter  30 value 1.030583</span>
<span class="c1">## iter  40 value 0.538519</span>
<span class="c1">## iter  50 value 0.456572</span>
<span class="c1">## iter  60 value 0.382378</span>
<span class="c1">## iter  70 value 0.255440</span>
<span class="c1">## iter  80 value 0.239926</span>
<span class="c1">## iter  90 value 0.185494</span>
<span class="c1">## iter 100 value 0.137846</span>
<span class="c1">## final  value 0.137846</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 18.423398</span>
<span class="c1">## final  value 18.227066</span>
<span class="c1">## converged</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 2.468938</span>
<span class="c1">## iter  20 value 1.734914</span>
<span class="c1">## iter  30 value 1.252585</span>
<span class="c1">## iter  40 value 1.064920</span>
<span class="c1">## iter  50 value 0.990976</span>
<span class="c1">## iter  60 value 0.968958</span>
<span class="c1">## iter  70 value 0.961054</span>
<span class="c1">## iter  80 value 0.951385</span>
<span class="c1">## iter  90 value 0.944826</span>
<span class="c1">## iter 100 value 0.940981</span>
<span class="c1">## final  value 0.940981</span>
<span class="c1">## stopped after 100 iterations</span>
<span class="c1">## # weights:  18 (10 variable)</span>
<span class="c1">## initial  value 125.241801</span>
<span class="c1">## iter  10 value 20.325785</span>
<span class="c1">## iter  20 value 19.765691</span>
<span class="c1">## final  value 19.765690</span>
<span class="c1">## converged</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#So sánh 2 mô hình</span>
<span class="n">boosting_results</span> <span class="o">&lt;-</span> <span class="nf">resamples</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="n">rf</span><span class="o">=</span><span class="n">rf.model</span><span class="p">,</span> <span class="n">LDA</span><span class="o">=</span><span class="n">fit.lda</span><span class="p">,</span> <span class="n">MULTI</span> <span class="o">=</span> <span class="n">fit.multi</span><span class="p">))</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">boosting_results</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##</span>
<span class="c1">## Call:</span>
<span class="c1">## summary.resamples(object = boosting_results)</span>
<span class="c1">##</span>
<span class="c1">## Models: rf, LDA, MULTI</span>
<span class="c1">## Number of resamples: 25</span>
<span class="c1">##</span>
<span class="c1">## Accuracy</span>
<span class="c1">##            Min.   1st Qu.    Median      Mean   3rd Qu.      Max. NA&#39;s</span>
<span class="c1">## rf    0.8974359 0.9500000 0.9555556 0.9558570 0.9743590 0.9787234    0</span>
<span class="c1">## LDA   0.9250000 0.9512195 0.9736842 0.9676165 0.9767442 1.0000000    0</span>
<span class="c1">## MULTI 0.8888889 0.9411765 0.9523810 0.9485925 0.9767442 1.0000000    0</span>
<span class="c1">##</span>
<span class="c1">## Kappa</span>
<span class="c1">##            Min.   1st Qu.    Median      Mean   3rd Qu.      Max. NA&#39;s</span>
<span class="c1">## rf    0.8436874 0.9242424 0.9332344 0.9327520 0.9615385 0.9676531    0</span>
<span class="c1">## LDA   0.8863636 0.9249531 0.9604579 0.9503733 0.9646672 1.0000000    0</span>
<span class="c1">## MULTI 0.8301887 0.9100529 0.9274611 0.9220380 0.9650974 1.0000000    0</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">dotplot</span><span class="p">(</span><span class="n">boosting_results</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="image0" src="p03-35-caret_files/figure-html/unnamed-chunk-3-1.png" /></p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Test RF</span>
<span class="n">predict_result</span> <span class="o">&lt;-</span> <span class="nf">predict</span><span class="p">(</span><span class="n">rf.model</span><span class="p">,</span> <span class="n">test</span><span class="p">)</span>
<span class="nf">confusionMatrix</span><span class="p">(</span><span class="n">predict_result</span><span class="p">,</span> <span class="n">test</span><span class="o">$</span><span class="n">Species</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">## Confusion Matrix and Statistics</span>
<span class="c1">##</span>
<span class="c1">##             Reference</span>
<span class="c1">## Prediction   setosa versicolor virginica</span>
<span class="c1">##   setosa         12          0         0</span>
<span class="c1">##   versicolor      0         10         1</span>
<span class="c1">##   virginica       0          2        11</span>
<span class="c1">##</span>
<span class="c1">## Overall Statistics</span>
<span class="c1">##</span>
<span class="c1">##                Accuracy : 0.9167</span>
<span class="c1">##                  95% CI : (0.7753, 0.9825)</span>
<span class="c1">##     No Information Rate : 0.3333</span>
<span class="c1">##     P-Value [Acc &gt; NIR] : 3.978e-13</span>
<span class="c1">##</span>
<span class="c1">##                   Kappa : 0.875</span>
<span class="c1">##  Mcnemar&#39;s Test P-Value : NA</span>
<span class="c1">##</span>
<span class="c1">## Statistics by Class:</span>
<span class="c1">##</span>
<span class="c1">##                      Class: setosa Class: versicolor Class: virginica</span>
<span class="c1">## Sensitivity                 1.0000            0.8333           0.9167</span>
<span class="c1">## Specificity                 1.0000            0.9583           0.9167</span>
<span class="c1">## Pos Pred Value              1.0000            0.9091           0.8462</span>
<span class="c1">## Neg Pred Value              1.0000            0.9200           0.9565</span>
<span class="c1">## Prevalence                  0.3333            0.3333           0.3333</span>
<span class="c1">## Detection Rate              0.3333            0.2778           0.3056</span>
<span class="c1">## Detection Prevalence        0.3333            0.3056           0.3611</span>
<span class="c1">## Balanced Accuracy           1.0000            0.8958           0.9167</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Test LDA</span>
<span class="n">predict_result</span> <span class="o">&lt;-</span> <span class="nf">predict</span><span class="p">(</span><span class="n">fit.lda</span><span class="p">,</span> <span class="n">test</span><span class="p">)</span>
<span class="nf">confusionMatrix</span><span class="p">(</span><span class="n">predict_result</span><span class="p">,</span> <span class="n">test</span><span class="o">$</span><span class="n">Species</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">## Confusion Matrix and Statistics</span>
<span class="c1">##</span>
<span class="c1">##             Reference</span>
<span class="c1">## Prediction   setosa versicolor virginica</span>
<span class="c1">##   setosa         12          0         0</span>
<span class="c1">##   versicolor      0         12         0</span>
<span class="c1">##   virginica       0          0        12</span>
<span class="c1">##</span>
<span class="c1">## Overall Statistics</span>
<span class="c1">##</span>
<span class="c1">##                Accuracy : 1</span>
<span class="c1">##                  95% CI : (0.9026, 1)</span>
<span class="c1">##     No Information Rate : 0.3333</span>
<span class="c1">##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16</span>
<span class="c1">##</span>
<span class="c1">##                   Kappa : 1</span>
<span class="c1">##  Mcnemar&#39;s Test P-Value : NA</span>
<span class="c1">##</span>
<span class="c1">## Statistics by Class:</span>
<span class="c1">##</span>
<span class="c1">##                      Class: setosa Class: versicolor Class: virginica</span>
<span class="c1">## Sensitivity                 1.0000            1.0000           1.0000</span>
<span class="c1">## Specificity                 1.0000            1.0000           1.0000</span>
<span class="c1">## Pos Pred Value              1.0000            1.0000           1.0000</span>
<span class="c1">## Neg Pred Value              1.0000            1.0000           1.0000</span>
<span class="c1">## Prevalence                  0.3333            0.3333           0.3333</span>
<span class="c1">## Detection Rate              0.3333            0.3333           0.3333</span>
<span class="c1">## Detection Prevalence        0.3333            0.3333           0.3333</span>
<span class="c1">## Balanced Accuracy           1.0000            1.0000           1.0000</span>
</pre></div>
</div>
</div>
<div class="section" id="tuning-parameter">
<h2>11.2. Tuning parameter<a class="headerlink" href="#tuning-parameter" title="Permalink to this headline">¶</a></h2>
<p>Khi tối ưu hóa các tham số, ta nên dùng cross validation hoặc boostrap
(quy tắc 632)</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">set.seed</span><span class="p">(</span><span class="m">998</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">mlbench</span><span class="p">)</span>
<span class="nf">data</span><span class="p">(</span><span class="n">Sonar</span><span class="p">)</span>
<span class="n">inTraining</span> <span class="o">&lt;-</span> <span class="nf">createDataPartition</span><span class="p">(</span><span class="n">Sonar</span><span class="o">$</span><span class="n">Class</span><span class="p">,</span>
                               <span class="n">p</span> <span class="o">=</span> <span class="m">0.75</span><span class="p">,</span>
                               <span class="n">list</span> <span class="o">=</span> <span class="bp">F</span><span class="p">)</span>
<span class="n">training</span> <span class="o">&lt;-</span> <span class="n">Sonar[inTraining</span><span class="p">,</span><span class="n">]</span>
<span class="n">testing</span> <span class="o">&lt;-</span> <span class="n">Sonar[</span><span class="o">-</span><span class="n">inTraining</span><span class="p">,</span><span class="n">]</span>

<span class="n">fitControl</span> <span class="o">&lt;-</span> <span class="nf">trainControl</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="s">&quot;repeatedcv&quot;</span><span class="p">,</span>
                           <span class="n">number</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span>
                           <span class="n">repeats</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span>
                           <span class="n">classProbs</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span>
                           <span class="n">summaryFunction</span> <span class="o">=</span> <span class="n">twoClassSummary</span><span class="p">)</span>
<span class="n">xgb.model</span> <span class="o">&lt;-</span> <span class="nf">train</span><span class="p">(</span><span class="n">Class</span> <span class="o">~</span> <span class="n">.,</span>
                   <span class="n">data</span> <span class="o">=</span> <span class="n">training</span><span class="p">,</span>
                   <span class="n">method</span> <span class="o">=</span> <span class="s">&quot;xgbTree&quot;</span><span class="p">,</span>
                   <span class="n">trControl</span> <span class="o">=</span> <span class="n">fitControl</span><span class="p">,</span>
                   <span class="n">verbose</span> <span class="o">=</span> <span class="bp">F</span><span class="p">,</span>
                   <span class="n">metric</span> <span class="o">=</span> <span class="s">&quot;ROC&quot;</span><span class="p">)</span>
<span class="c1">#Kết quả mô hình</span>
<span class="n">xgb.model</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">## eXtreme Gradient Boosting</span>
<span class="c1">##</span>
<span class="c1">## 157 samples</span>
<span class="c1">##  60 predictor</span>
<span class="c1">##   2 classes: &#39;M&#39;, &#39;R&#39;</span>
<span class="c1">##</span>
<span class="c1">## No pre-processing</span>
<span class="c1">## Resampling: Cross-Validated (2 fold, repeated 2 times)</span>
<span class="c1">## Summary of sample sizes: 79, 78, 78, 79</span>
<span class="c1">## Resampling results across tuning parameters:</span>
<span class="c1">##</span>
<span class="c1">##   eta  max_depth  colsample_bytree  nrounds  ROC        Sens</span>
<span class="c1">##   0.3  1          0.6                50      0.8497873  0.7857143</span>
<span class="c1">##   0.3  1          0.6               100      0.8479819  0.7797619</span>
<span class="c1">##   0.3  1          0.6               150      0.8464268  0.7678571</span>
<span class="c1">##   0.3  1          0.8                50      0.8522183  0.7976190</span>
<span class="c1">##   0.3  1          0.8               100      0.8489472  0.7857143</span>
<span class="c1">##   0.3  1          0.8               150      0.8444605  0.7619048</span>
<span class="c1">##   0.3  2          0.6                50      0.8628986  0.7797619</span>
<span class="c1">##   0.3  2          0.6               100      0.8588008  0.7678571</span>
<span class="c1">##   0.3  2          0.6               150      0.8588008  0.7678571</span>
<span class="c1">##   0.3  2          0.8                50      0.8462614  0.7440476</span>
<span class="c1">##   0.3  2          0.8               100      0.8500867  0.7738095</span>
<span class="c1">##   0.3  2          0.8               150      0.8500867  0.7738095</span>
<span class="c1">##   0.3  3          0.6                50      0.8547431  0.8273810</span>
<span class="c1">##   0.3  3          0.6               100      0.8552124  0.8154762</span>
<span class="c1">##   0.3  3          0.6               150      0.8552124  0.8154762</span>
<span class="c1">##   0.3  3          0.8                50      0.8587650  0.8273810</span>
<span class="c1">##   0.3  3          0.8               100      0.8598554  0.8333333</span>
<span class="c1">##   0.3  3          0.8               150      0.8598554  0.8333333</span>
<span class="c1">##   0.4  1          0.6                50      0.8459710  0.7619048</span>
<span class="c1">##   0.4  1          0.6               100      0.8458637  0.7678571</span>
<span class="c1">##   0.4  1          0.6               150      0.8440673  0.7559524</span>
<span class="c1">##   0.4  1          0.8                50      0.8519993  0.7797619</span>
<span class="c1">##   0.4  1          0.8               100      0.8518519  0.7797619</span>
<span class="c1">##   0.4  1          0.8               150      0.8515078  0.7678571</span>
<span class="c1">##   0.4  2          0.6                50      0.8654592  0.8035714</span>
<span class="c1">##   0.4  2          0.6               100      0.8666926  0.7976190</span>
<span class="c1">##   0.4  2          0.6               150      0.8666926  0.7976190</span>
<span class="c1">##   0.4  2          0.8                50      0.8608921  0.8035714</span>
<span class="c1">##   0.4  2          0.8               100      0.8607089  0.8095238</span>
<span class="c1">##   0.4  2          0.8               150      0.8607089  0.8095238</span>
<span class="c1">##   0.4  3          0.6                50      0.8417122  0.7797619</span>
<span class="c1">##   0.4  3          0.6               100      0.8405593  0.7678571</span>
<span class="c1">##   0.4  3          0.6               150      0.8405593  0.7678571</span>
<span class="c1">##   0.4  3          0.8                50      0.8585058  0.7976190</span>
<span class="c1">##   0.4  3          0.8               100      0.8576970  0.8035714</span>
<span class="c1">##   0.4  3          0.8               150      0.8576970  0.8035714</span>
<span class="c1">##   Spec</span>
<span class="c1">##   0.7464339</span>
<span class="c1">##   0.7464339</span>
<span class="c1">##   0.7603228</span>
<span class="c1">##   0.7466216</span>
<span class="c1">##   0.7329204</span>
<span class="c1">##   0.7468093</span>
<span class="c1">##   0.7605105</span>
<span class="c1">##   0.7539414</span>
<span class="c1">##   0.7539414</span>
<span class="c1">##   0.7745871</span>
<span class="c1">##   0.7539414</span>
<span class="c1">##   0.7539414</span>
<span class="c1">##   0.7331081</span>
<span class="c1">##   0.7331081</span>
<span class="c1">##   0.7331081</span>
<span class="c1">##   0.7336712</span>
<span class="c1">##   0.7404279</span>
<span class="c1">##   0.7404279</span>
<span class="c1">##   0.7122748</span>
<span class="c1">##   0.7601351</span>
<span class="c1">##   0.7466216</span>
<span class="c1">##   0.7263514</span>
<span class="c1">##   0.7533784</span>
<span class="c1">##   0.7670796</span>
<span class="c1">##   0.7610736</span>
<span class="c1">##   0.7610736</span>
<span class="c1">##   0.7610736</span>
<span class="c1">##   0.7327327</span>
<span class="c1">##   0.7327327</span>
<span class="c1">##   0.7327327</span>
<span class="c1">##   0.7263514</span>
<span class="c1">##   0.7402402</span>
<span class="c1">##   0.7402402</span>
<span class="c1">##   0.7533784</span>
<span class="c1">##   0.7533784</span>
<span class="c1">##   0.7533784</span>
<span class="c1">##</span>
<span class="c1">## Tuning parameter &#39;gamma&#39; was held constant at a value of 0</span>
<span class="c1">##</span>
<span class="c1">## Tuning parameter &#39;min_child_weight&#39; was held constant at a value of 1</span>
<span class="c1">## ROC was used to select the optimal model using  the largest value.</span>
<span class="c1">## The final values used for the model were nrounds = 100, max_depth = 2,</span>
<span class="c1">##  eta = 0.4, gamma = 0, colsample_bytree = 0.6 and min_child_weight = 1.</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Confusion Matrix tập testing</span>

<span class="nf">confusionMatrix</span><span class="p">(</span><span class="nf">predict</span><span class="p">(</span><span class="n">xgb.model</span><span class="p">,</span> <span class="n">testing</span><span class="p">),</span> <span class="n">testing</span><span class="o">$</span><span class="n">Class</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">## Confusion Matrix and Statistics</span>
<span class="c1">##</span>
<span class="c1">##           Reference</span>
<span class="c1">## Prediction  M  R</span>
<span class="c1">##          M 24  2</span>
<span class="c1">##          R  3 22</span>
<span class="c1">##</span>
<span class="c1">##                Accuracy : 0.902</span>
<span class="c1">##                  95% CI : (0.7859, 0.9674)</span>
<span class="c1">##     No Information Rate : 0.5294</span>
<span class="c1">##     P-Value [Acc &gt; NIR] : 1.209e-08</span>
<span class="c1">##</span>
<span class="c1">##                   Kappa : 0.8037</span>
<span class="c1">##  Mcnemar&#39;s Test P-Value : 1</span>
<span class="c1">##</span>
<span class="c1">##             Sensitivity : 0.8889</span>
<span class="c1">##             Specificity : 0.9167</span>
<span class="c1">##          Pos Pred Value : 0.9231</span>
<span class="c1">##          Neg Pred Value : 0.8800</span>
<span class="c1">##              Prevalence : 0.5294</span>
<span class="c1">##          Detection Rate : 0.4706</span>
<span class="c1">##    Detection Prevalence : 0.5098</span>
<span class="c1">##       Balanced Accuracy : 0.9028</span>
<span class="c1">##</span>
<span class="c1">##        &#39;Positive&#39; Class : M</span>
<span class="c1">##</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Lấy kết quả dạng xác suất</span>
<span class="nf">predict</span><span class="p">(</span><span class="n">xgb.model</span><span class="p">,</span> <span class="nf">head</span><span class="p">(</span><span class="n">testing</span><span class="p">),</span> <span class="n">type</span> <span class="o">=</span> <span class="s">&quot;prob&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##              M           R</span>
<span class="c1">## 1 0.0681190491 0.931880951</span>
<span class="c1">## 2 0.0031862601 0.996813740</span>
<span class="c1">## 3 0.0003743432 0.999625657</span>
<span class="c1">## 4 0.0203228425 0.979677157</span>
<span class="c1">## 5 0.9945857525 0.005414248</span>
<span class="c1">## 6 0.5634216666 0.436578333</span>
</pre></div>
</div>
</div>
<div class="section" id="tai-lieu-tham-khao">
<h2>11.3. Tài liệu tham khảo<a class="headerlink" href="#tai-lieu-tham-khao" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://topepo.github.io/caret/model-training-and-tuning.html">Caret
packages</a></li>
<li><a class="reference external" href="http://machinelearningmastery.com/machine-learning-ensembles-with-r/">Ensemble
methods</a></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="p03-65-chat-luong-mo-hinh.html" class="btn btn-neutral float-right" title="12. Chất lượng mô hình" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="p03-30-credit-scoring.html" class="btn btn-neutral float-left" title="10. Credit Scoring" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Anh Hoang Duc

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>