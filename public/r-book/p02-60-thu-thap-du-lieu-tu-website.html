

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="vi" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="vi" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>12. Thu thập dữ liệu từ website &mdash; Tài liệu Phân tích dữ liệu với R 2019</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'./',
              VERSION:'2019',
              LANGUAGE:'vi',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
        <script type="text/javascript" src="_static/copybutton.js"></script>
        <script type="text/javascript" src="_static/translations.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Tìm Kiếm" href="search.html" />
    <link rel="next" title="13. Các mẹo trong R" href="p02-99-meo-trong-r.html" />
    <link rel="prev" title="11. Biến đổi dữ liệu với data.table" href="p02-50-datatable.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Phân tích dữ liệu với R
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Giới thiệu</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p01-01-gioi-thieu.html">Khoa học dữ liệu và nghề phân tích dữ liệu</a></li>
</ul>
<p class="caption"><span class="caption-text">Phân tích khám phá dữ liệu</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="p02-03-bien-doi-du-lieu-dplyr.html">1. Ngữ pháp của biến đổi dữ liệu với DPLYR</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-04-phan-ra-va-xoay-chieu-du-lieu.html">2. Phân rã và xoay chiều dữ liệu</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-05-cac-chi-so-thong-ke.html">3. Các chỉ số thống kê mô tả cơ bản</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-06-lap-trinh-ham.html">4. Lập trình hàm</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-07-lap-trinh-ham-voi-purrr.html">5. Lập trình chức năng hàm với purrr</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-08-bien-doi-du-lieu-text.html">6. Biến đổi dữ liệu text</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-11-quan-ly-nhieu-mo-hinh.html">7. Quản lý kết quả phân tích từ nhiều mô hình</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-15-thong-ke-co-ban.html">8. Xác suất và phân phối thống kê cơ bản</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-16-power-analysis.html">9. Power analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-20-sampling-methods.html">10. Phương pháp ước lượng lấy mẫu</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-50-datatable.html">11. Biến đổi dữ liệu với <code class="docutils literal notranslate"><span class="pre">data.table</span></code></a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">12. Thu thập dữ liệu từ website</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#rvest">12.1. rvest</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ung-dung-scrape-techcombank-atm">12.2. Ứng dụng - Scrape Techcombank ATM</a></li>
<li class="toctree-l2"><a class="reference internal" href="#su-dung-rselenium">12.3. Sử dụng RSelenium</a></li>
<li class="toctree-l2"><a class="reference internal" href="#su-dung-seleniumpipe">12.4. Sử dụng SeleniumPipe</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tai-lieu-tham-khao">12.5. Tài liệu tham khảo</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="p02-99-meo-trong-r.html">13. Các mẹo trong R</a></li>
</ul>
<p class="caption"><span class="caption-text">Supervised learning</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p03-01-nguyen-ly-du-bao.html">1. Các nguyên lý dự báo</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-02-mo-hinh-ols.html">2. Mô hình OLS</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-03-logistic-regression.html">3. Mô hình hồi quy logistic</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-04-decision-tree.html">4. Cây quyết định</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-05-bagging-boosting.html">5. Bagging, RandomForest và Boosting</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-07-xay-dung-mo-hinh-voi-h2o.html">6. Xây dựng mô hình với H2O</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-08-svm.html">7. Support Vector Machine</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-09-feature-engineering.html">8. Feature Engineering</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-15-regularization.html">9. Regularization</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-17-nonlinear.html">10. Mô hình phi tuyến tính</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-30-credit-scoring.html">11. Credit Scoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-35-caret.html">12. Xây dựng mô hình dự báo với caret</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-65-chat-luong-mo-hinh.html">13. Chất lượng mô hình</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-70-tidymodels.html">14. Tidymodels</a></li>
</ul>
<p class="caption"><span class="caption-text">Unsupervised learning</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p04-01-unsupervised-learning.html">1. Unsupervised learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="p04-02-kmeans.html">2. k-means</a></li>
<li class="toctree-l1"><a class="reference internal" href="p04-03-hierarchical-clustering.html">3. Hierachical clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="p04-04-basket-analysis.html">4. Phân tích giỏ hàng</a></li>
<li class="toctree-l1"><a class="reference internal" href="p04-05-pca.html">5. Principal component analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="p04-06-factor-analysis.html">6. Phân tích nhân tố ẩn (factor analysis)</a></li>
</ul>
<p class="caption"><span class="caption-text">Chuỗi thời gian</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p05-01-chuoi-thoi-gian.html">1. Giới thiệu về chuỗi thời gian</a></li>
<li class="toctree-l1"><a class="reference internal" href="p05-02-arima.html">2. Mô hình ARIMA</a></li>
<li class="toctree-l1"><a class="reference internal" href="p05-03-phan-tich-chuoi-thoi-gian-voi-tidyquant.html">3. Phân tích chuỗi thời gian với tidyquant và timetk</a></li>
<li class="toctree-l1"><a class="reference internal" href="p05-06-du-bao-ts-voi-prophet.html">4. Dự báo chuỗi thời gian với prophet</a></li>
<li class="toctree-l1"><a class="reference internal" href="p05-07-du-bao-ts-voi-timetk.html">5. Dự báo chuỗi thời gian với timetk</a></li>
<li class="toctree-l1"><a class="reference internal" href="p05-08-abnomaly-detection.html">6. Abnomaly detection trong times series</a></li>
</ul>
<p class="caption"><span class="caption-text">Ngôn ngữ tự nghiên</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p06-01-nlp-co-ban.html">1. Xử lý ngôn ngữ tự nhiên cơ bản</a></li>
<li class="toctree-l1"><a class="reference internal" href="p06-04-text-classification.html">2. Phân loại text</a></li>
<li class="toctree-l1"><a class="reference internal" href="p06-07-nlp-api.html">3. Sử dụng API từ các dịch vụ đám mây</a></li>
<li class="toctree-l1"><a class="reference internal" href="p06-10-ocr-tesseract.html">4. OCR với <code class="docutils literal notranslate"><span class="pre">tesseract</span></code></a></li>
</ul>
<p class="caption"><span class="caption-text">Các phương pháp khác</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p07-01-survival-analysis.html">1. Survival analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="p07-02-causal-impact.html">2. Causal Impact</a></li>
<li class="toctree-l1"><a class="reference internal" href="p07-03-collaborative-filtering.html">3. Collaborative Filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="p07-07-spatial-data.html">4. Spatial data</a></li>
<li class="toctree-l1"><a class="reference internal" href="p07-10-shiny.html">5. Shiny apps</a></li>
</ul>
<p class="caption"><span class="caption-text">Deep Learning</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p09-01-gioi-thieu-deep-learning.html">1. Giới thiệu cơ bản về Deep Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="p09-02-co-ban-kien-thuc-toan.html">2. Kiến thức cơ bản toán học cho deep learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="p09-03-mo-hinh-deep-learning-co-ban.html">3. Mô hình deep learning cơ bản</a></li>
<li class="toctree-l1"><a class="reference internal" href="p09-04-convolution-neural-network.html">4. Convolution neural networks</a></li>
</ul>
<p class="caption"><span class="caption-text">Cloud Computing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p10-01-cai-dat-rstudio-server-tren-amazon.html">1. Cài đặt server RStudio trên Amazon</a></li>
<li class="toctree-l1"><a class="reference internal" href="p10-03-web-service-azure.html">2. Xây dựng web service với Azure</a></li>
<li class="toctree-l1"><a class="reference internal" href="p10-09-apis-voi-plumber.html">3. API với Plumber</a></li>
</ul>
<p class="caption"><span class="caption-text">Kiến thức bổ trợ</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p11-01-git.html">1. Sử dụng GIT</a></li>
<li class="toctree-l1"><a class="reference internal" href="p11-02-cmd.html">2. CMD và Bash</a></li>
<li class="toctree-l1"><a class="reference internal" href="p11-03-docker.html">3. Sử dụng docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="p11-04-apis.html">4. API</a></li>
<li class="toctree-l1"><a class="reference internal" href="p11-05-html-css.html">5. Cơ bản về HTML và CSS</a></li>
<li class="toctree-l1"><a class="reference internal" href="p11-09-other.html">6. Các tricks khác</a></li>
</ul>
<p class="caption"><span class="caption-text">Case studies</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p13-01-casestudy-truc-quan-hoa.html">1. Trực quan hóa dữ liệu</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Phân tích dữ liệu với R</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>12. Thu thập dữ liệu từ website</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/p02-60-thu-thap-du-lieu-tu-website.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="thu-thap-du-lieu-tu-website">
<h1>12. Thu thập dữ liệu từ website<a class="headerlink" href="#thu-thap-du-lieu-tu-website" title="Permalink to this headline">¶</a></h1>
<div class="section" id="rvest">
<h2>12.1. rvest<a class="headerlink" href="#rvest" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">rvest</span></code> là package cho phép đọc dữ liệu html từ web trong hệ sinh thái
của <code class="docutils literal notranslate"><span class="pre">tidyverse</span></code>. Sử dụng <code class="docutils literal notranslate"><span class="pre">rvest</span></code> cho phép thu thập dữ liệu một cách
nhanh chóng từ web.</p>
<p>Mỗi thành phần của 1 file html được cấu thành từ các <code class="docutils literal notranslate"><span class="pre">tag</span></code> và các đối
tượng nhất định được quy định bởi <code class="docutils literal notranslate"><span class="pre">css</span></code> của website đó. Khi thu thập
dữ liệu từ web, ta cần biết được chính xác đối tượng ta muốn thu thập dữ
liệu đang được gắn với tag nào của html. Có hai cách để biết được object
thuộc tag nào:</p>
<ul class="simple">
<li>Sử dụng <code class="docutils literal notranslate"><span class="pre">Chrome</span> <span class="pre">&gt;&gt;</span> <span class="pre">F12</span></code></li>
<li>Sử dụng selectorgadget addin của chrome để xác định node</li>
</ul>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span>vignette<span class="p">(</span><span class="s">&quot;selectorgadget&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Ví dụ 1</strong>:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span>url <span class="o">&lt;-</span> <span class="s">&#39;http://www.imdb.com/search/title?count=100&amp;release_date=2016,2016&amp;title_type=feature&#39;</span>

webpage <span class="o">&lt;-</span> read_html<span class="p">(</span><span class="kp">url</span><span class="p">)</span>
webpage <span class="o">%&gt;%</span>
  html_nodes<span class="p">(</span><span class="s">&quot;.text-primary&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span>
  html_text <span class="o">%&gt;%</span>
  <span class="kp">as.numeric</span>

webpage <span class="o">%&gt;%</span>
  html_nodes<span class="p">(</span><span class="s">&#39;.lister-item-header a&#39;</span><span class="p">)</span> <span class="o">%&gt;%</span>
  html_text

webpage <span class="o">%&gt;%</span>
  html_nodes<span class="p">(</span><span class="s">&#39;.ratings-bar+ .text-muted&#39;</span><span class="p">)</span> <span class="o">%&gt;%</span>
  html_text

webpage <span class="o">%&gt;%</span>
  html_nodes<span class="p">(</span><span class="s">&#39;table&#39;</span><span class="p">)</span> <span class="o">%&gt;%</span>
  html_text
</pre></div>
</div>
<p><strong>Ví dụ 2</strong></p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="kn">library</span><span class="p">(</span>rvest<span class="p">)</span>
lego_movie <span class="o">&lt;-</span> read_html<span class="p">(</span><span class="s">&quot;http://www.imdb.com/title/tt1490017/&quot;</span><span class="p">)</span>

lego_movie <span class="o">%&gt;%</span>
  html_nodes<span class="p">(</span><span class="s">&quot;table&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span>
  html_table<span class="p">()</span> <span class="o">%&gt;%</span>
  as.data.frame <span class="o">%&gt;%</span> View
</pre></div>
</div>
</div>
<div class="section" id="ung-dung-scrape-techcombank-atm">
<h2>12.2. Ứng dụng - Scrape Techcombank ATM<a class="headerlink" href="#ung-dung-scrape-techcombank-atm" title="Permalink to this headline">¶</a></h2>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span>branch_full <span class="o">&lt;-</span> <span class="kt">character</span><span class="p">()</span>
<span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">){</span>
url <span class="o">&lt;-</span> <span class="kp">paste0</span><span class="p">(</span><span class="s">&#39;https://www.techcombank.com.vn/mang-luoi-dia-diem-atm/danh-sach-chi-nhanh-phong-giao-dich-va-atm?page=&#39;</span><span class="p">,</span>i<span class="p">)</span>

webpage <span class="o">&lt;-</span> read_html<span class="p">(</span><span class="kp">url</span><span class="p">,</span> encoding <span class="o">=</span> <span class="s">&quot;UTF-8&quot;</span><span class="p">)</span>
webpage <span class="o">%&gt;%</span>
  html_nodes<span class="p">(</span><span class="s">&quot;.title-entries a&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span>
  html_text <span class="o">%&gt;%</span>
  as.character <span class="o">-&gt;</span> branch
branch_full <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span>branch_full<span class="p">,</span> branch<span class="p">)</span>
<span class="p">}</span>
df <span class="o">&lt;-</span> <span class="kt">data.frame</span><span class="p">(</span>branch <span class="o">=</span> branch_full<span class="p">)</span>
df <span class="o">%&gt;%</span> DT<span class="o">::</span>datatable<span class="p">()</span>

<span class="kn">library</span><span class="p">(</span>rvest<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>dplyr<span class="p">)</span>
i <span class="o">&lt;-</span> <span class="m">1</span>
url <span class="o">&lt;-</span> <span class="kp">paste0</span><span class="p">(</span><span class="s">&#39;https://www.techcombank.com.vn/mang-luoi-dia-diem-atm/danh-sach-chi-nhanh-phong-giao-dich-va-atm?page=&#39;</span><span class="p">,</span>i<span class="p">)</span>

webpage <span class="o">&lt;-</span> read_html<span class="p">(</span><span class="kp">iconv</span><span class="p">(</span><span class="kp">url</span><span class="p">,</span>  from <span class="o">=</span> <span class="s">&quot;ISO-8859-1&quot;</span><span class="p">,</span> to <span class="o">=</span> <span class="s">&quot;UTF-8&quot;</span><span class="p">),</span> encoding <span class="o">=</span> <span class="s">&quot;UTF-8&quot;</span><span class="p">)</span>
webpage <span class="o">&lt;-</span> read_html<span class="p">(</span><span class="kp">url</span><span class="p">,</span> encoding <span class="o">=</span> <span class="s">&quot;UTF-8&quot;</span><span class="p">)</span>

webpage <span class="o">&lt;-</span> read_html<span class="p">(</span><span class="kp">iconv</span><span class="p">(</span><span class="kp">url</span><span class="p">,</span>
                          <span class="c1"># from = &quot;ISO-8859-1&quot;,</span>
                           to <span class="o">=</span> <span class="s">&quot;UTF-8&quot;</span><span class="p">),</span> encoding <span class="o">=</span> <span class="s">&quot;utf8&quot;</span><span class="p">)</span>

webpage <span class="o">%&gt;%</span>
  html_nodes<span class="p">(</span><span class="s">&quot;.title-entries a&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span>
  html_text <span class="o">%&gt;%</span>
  as.character <span class="o">%&gt;%</span>
  repair_encoding<span class="p">()</span> <span class="o">-&gt;</span> branch
df <span class="o">&lt;-</span> <span class="kt">data.frame</span><span class="p">(</span>branch <span class="o">=</span> branch<span class="p">)</span>
df
</pre></div>
</div>
</div>
<div class="section" id="su-dung-rselenium">
<h2>12.3. Sử dụng RSelenium<a class="headerlink" href="#su-dung-rselenium" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">rvest</span></code> rất thuận tiện trong việc thu thập dữ liệu. Tuy nhiên, khi làm
việc với website, ta phải làm việc cùng lúc với nhiều trag web và tương
tác với các thành phần khác nhau trong website. Ví dụ:</p>
<ul class="simple">
<li>Click vào login</li>
<li>Nhập mật khẩu</li>
<li>Close một cửa sổ</li>
</ul>
<p>Để giải quyết vấn đề trên, ta cần phải sử dụng <code class="docutils literal notranslate"><span class="pre">selenium</span></code> và
<code class="docutils literal notranslate"><span class="pre">RSelenium</span></code>. Các bước sử dụng <code class="docutils literal notranslate"><span class="pre">selenium</span></code> và <code class="docutils literal notranslate"><span class="pre">RSelenium</span></code>:</p>
<ul class="simple">
<li>Download <a class="reference external" href="https://www.seleniumhq.org/download/">selenium server
standalone</a></li>
<li>Donwload <a class="reference external" href="http://chromedriver.chromium.org/downloads">chrome
driver</a></li>
<li>Sử dụng <code class="docutils literal notranslate"><span class="pre">RSelenium</span></code> và điều hướng website</li>
</ul>
<p><strong>Cách khởi động server</strong></p>
<ul class="simple">
<li><strong>Cách 1</strong>: Khởi động server tự động</li>
</ul>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span>selServ <span class="o">&lt;-</span> selenium<span class="p">(</span>verbose <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="c1">#installs selenium</span>
selServ<span class="o">$</span>process
</pre></div>
</div>
<ul class="simple">
<li><strong>Cách 2</strong>: Chạy server thủ công</li>
</ul>
<div class="highlight-batch notranslate"><div class="highlight"><pre><span></span>d<span class="p">:</span>

<span class="k">cd</span> D:\OneDrive - VPBank\1. Personal projects\Crawl data\selenium

java -jar selenium-server-standalone-2.47.0.jar -Dwebdriver.chrome.driver=./chromedriver.exe
</pre></div>
</div>
<ul class="simple">
<li>Sử dụng Selenium để điều hướng web</li>
</ul>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Step 1: Khởi động server</span>
<span class="kn">library</span><span class="p">(</span>dplyr<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>RSelenium<span class="p">)</span>
remDr <span class="o">&lt;-</span> remoteDriver<span class="p">(</span>remoteServerAddr <span class="o">=</span> <span class="s">&quot;127.0.0.1&quot;</span>
                      <span class="p">,</span> port <span class="o">=</span> <span class="m">4444</span>
                      <span class="p">,</span> browserName <span class="o">=</span> <span class="s">&quot;chrome&quot;</span><span class="p">)</span>
remDr<span class="o">$</span><span class="kp">open</span><span class="p">(</span>silent <span class="o">=</span> <span class="bp">F</span><span class="p">)</span>

<span class="c1">#Gọi website</span>
remDr<span class="o">$</span>navigate<span class="p">(</span><span class="s">&quot;http://www.facebook.com&quot;</span><span class="p">)</span>
remDr<span class="o">$</span>navigate<span class="p">(</span><span class="s">&quot;http://vietnamnet.vn/&quot;</span><span class="p">)</span>
remDr<span class="o">$</span>getCurrentUrl<span class="p">()</span>
remDr<span class="o">$</span>goBack<span class="p">()</span>
remDr<span class="o">$</span>goForward<span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li>Chèn các đối tượng vào server</li>
</ul>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span>url <span class="o">&lt;-</span> <span class="s">&quot;http://email-dbs.vpbank.com.vn/admin/index.php&quot;</span>
remDr<span class="o">$</span>navigate<span class="p">(</span><span class="kp">url</span><span class="p">)</span>
<span class="c1">#Loại 1: Chèn thông tin</span>
webElem_1 <span class="o">&lt;-</span> remDr<span class="o">$</span>findElement<span class="p">(</span>using <span class="o">=</span> <span class="s">&quot;css&quot;</span><span class="p">,</span> <span class="s">&quot;[name = &#39;ss_username&#39;]&quot;</span><span class="p">)</span>
webElem_1<span class="o">$</span>sendKeysToElement<span class="p">(</span><span class="kt">list</span><span class="p">(</span><span class="s">&#39;Ebank&#39;</span><span class="p">))</span>
webElem_2 <span class="o">&lt;-</span> remDr<span class="o">$</span>findElement<span class="p">(</span>using <span class="o">=</span> <span class="s">&quot;css&quot;</span><span class="p">,</span> <span class="s">&quot;[name = &#39;ss_password&#39;]&quot;</span><span class="p">)</span>
webElem_2<span class="o">$</span>sendKeysToElement<span class="p">(</span><span class="kt">list</span><span class="p">(</span><span class="s">&#39;NganHangSo@15092016&#39;</span><span class="p">))</span>
webElem_3 <span class="o">&lt;-</span> remDr<span class="o">$</span>findElement<span class="p">(</span>using <span class="o">=</span> <span class="s">&quot;css&quot;</span><span class="p">,</span> <span class="s">&quot;[name = &#39;ss_takemeto&#39;]&quot;</span><span class="p">)</span>
webElem_3<span class="o">$</span>sendKeysToElement<span class="p">(</span><span class="kt">list</span><span class="p">(</span><span class="s">&#39;My Campaign Statistics&#39;</span><span class="p">))</span>

<span class="c1">#Loại 2: Chèn click</span>
webElem_4 <span class="o">&lt;-</span> remDr<span class="o">$</span>findElement<span class="p">(</span>using <span class="o">=</span> <span class="s">&quot;css&quot;</span><span class="p">,</span> <span class="s">&quot;[name = &#39;SubmitButton&#39;]&quot;</span><span class="p">)</span>
webElem_4<span class="o">$</span>clickElement<span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li>Crawl data bằng rvest hoặc save toàn bộ dữ liệu</li>
</ul>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span>url <span class="o">&lt;-</span> <span class="s">&quot;http://email-dbs.vpbank.com.vn/admin/index.php?Page=Stats&amp;Action=Newsletters&amp;SubAction=ViewSummary&amp;id=763#&quot;</span>
remDr<span class="o">$</span>navigate<span class="p">(</span><span class="kp">url</span><span class="p">)</span>

<span class="kn">library</span><span class="p">(</span>XML<span class="p">)</span>
html_source <span class="o">&lt;-</span> remDr<span class="o">$</span>getPageSource<span class="p">()[[</span><span class="m">1</span><span class="p">]]</span>
html_parse <span class="o">&lt;-</span> html_source <span class="o">%&gt;%</span> htmlParse
doc <span class="o">&lt;-</span> readHTMLTable<span class="p">(</span>html_parse<span class="p">)</span>
doc<span class="p">[[</span><span class="m">8</span><span class="p">]]</span> <span class="o">%&gt;%</span> <span class="kp">head</span>
</pre></div>
</div>
<p><strong>Cách 2</strong></p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span>html_source <span class="o">&lt;-</span> remDr<span class="o">$</span>getPageSource<span class="p">()[[</span><span class="m">1</span><span class="p">]]</span>
html_source <span class="o">%&gt;%</span>
  write.table<span class="p">(</span>file <span class="o">=</span> <span class="s">&quot;my_html.html&quot;</span><span class="p">,</span>
                           row.names <span class="o">=</span> <span class="bp">F</span><span class="p">,</span>
                           quote <span class="o">=</span> <span class="bp">F</span><span class="p">,</span>
                           col.names <span class="o">=</span> <span class="bp">F</span><span class="p">,</span>
                           fileEncoding <span class="o">=</span> <span class="s">&quot;utf8&quot;</span><span class="p">)</span>
html_source <span class="o">%&gt;%</span> <span class="kp">class</span>
read_html<span class="p">(</span><span class="s">&quot;my_html.html&quot;</span><span class="p">,</span> encoding <span class="o">=</span> <span class="s">&quot;UTF-8&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span>
  html_nodes<span class="p">(</span><span class="s">&quot;table&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> my_table
my_table<span class="p">[[</span><span class="m">8</span><span class="p">]]</span> <span class="o">%&gt;%</span> html_table <span class="o">-&gt;</span> pop
</pre></div>
</div>
</div>
<div class="section" id="su-dung-seleniumpipe">
<h2>12.4. Sử dụng SeleniumPipe<a class="headerlink" href="#su-dung-seleniumpipe" title="Permalink to this headline">¶</a></h2>
<p>Bên cạnh <code class="docutils literal notranslate"><span class="pre">RSelenium</span></code>, ta có thể sử dụng <code class="docutils literal notranslate"><span class="pre">SeleniumPipe</span></code> để điều hướng
website sử dụng toán tử <code class="docutils literal notranslate"><span class="pre">%&gt;%</span></code></p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span>remDr <span class="o">&lt;-</span> remoteDr<span class="p">(</span>port <span class="o">=</span> <span class="m">4444</span>
                      <span class="p">,</span> browserName <span class="o">=</span> <span class="s">&quot;chrome&quot;</span><span class="p">)</span>

remDr <span class="o">%&gt;%</span> go<span class="p">(</span><span class="s">&quot;http://www.google.com/ncr&quot;</span><span class="p">)</span>

webElem <span class="o">&lt;-</span> remDr <span class="o">%&gt;%</span> findElement<span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="s">&quot;q&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="tai-lieu-tham-khao">
<h2>12.5. Tài liệu tham khảo<a class="headerlink" href="#tai-lieu-tham-khao" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://cran.r-project.org/web/packages/RSelenium/index.html">RSelenium</a></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="p02-99-meo-trong-r.html" class="btn btn-neutral float-right" title="13. Các mẹo trong R" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="p02-50-datatable.html" class="btn btn-neutral float-left" title="11. Biến đổi dữ liệu với data.table" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Anh Hoang Duc

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>