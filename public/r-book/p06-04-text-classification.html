

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="vi" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="vi" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>2. Phân loại text &mdash; Tài liệu Phân tích dữ liệu với R 2019</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'./',
              VERSION:'2019',
              LANGUAGE:'vi',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
        <script type="text/javascript" src="_static/copybutton.js"></script>
        <script type="text/javascript" src="_static/translations.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Tìm Kiếm" href="search.html" />
    <link rel="next" title="3. Sử dụng API từ các dịch vụ đám mây" href="p06-07-nlp-api.html" />
    <link rel="prev" title="1. Xử lý ngôn ngữ tự nhiên cơ bản" href="p06-01-nlp-co-ban.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Phân tích dữ liệu với R
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Giới thiệu</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p01-01-gioi-thieu.html">Khoa học dữ liệu và nghề phân tích dữ liệu</a></li>
</ul>
<p class="caption"><span class="caption-text">Phân tích khám phá dữ liệu</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p02-03-bien-doi-du-lieu-dplyr.html">1. Ngữ pháp của biến đổi dữ liệu với DPLYR</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-04-phan-ra-va-xoay-chieu-du-lieu.html">2. Phân rã và xoay chiều dữ liệu</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-05-cac-chi-so-thong-ke.html">3. Các chỉ số thống kê mô tả cơ bản</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-06-lap-trinh-ham.html">4. Lập trình hàm</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-07-lap-trinh-ham-voi-purrr.html">5. Lập trình chức năng hàm với purrr</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-08-bien-doi-du-lieu-text.html">6. Biến đổi dữ liệu text</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-11-quan-ly-nhieu-mo-hinh.html">7. Quản lý kết quả phân tích từ nhiều mô hình</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-15-thong-ke-co-ban.html">8. Xác suất và phân phối thống kê cơ bản</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-16-power-analysis.html">9. Power analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-20-sampling-methods.html">10. Phương pháp ước lượng lấy mẫu</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-50-datatable.html">11. Biến đổi dữ liệu với <code class="docutils literal notranslate"><span class="pre">data.table</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-60-thu-thap-du-lieu-tu-website.html">12. Thu thập dữ liệu từ website</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-99-meo-trong-r.html">13. Các mẹo trong R</a></li>
</ul>
<p class="caption"><span class="caption-text">Supervised learning</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p03-01-nguyen-ly-du-bao.html">1. Các nguyên lý dự báo</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-02-mo-hinh-ols.html">2. Mô hình OLS</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-03-logistic-regression.html">3. Mô hình hồi quy logistic</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-04-decision-tree.html">4. Cây quyết định</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-05-bagging-boosting.html">5. Bagging, RandomForest và Boosting</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-07-xay-dung-mo-hinh-voi-h2o.html">6. Xây dựng mô hình với H2O</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-08-svm.html">7. Support Vector Machine</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-09-feature-engineering.html">8. Feature Engineering</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-15-regularization.html">9. Regularization</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-17-nonlinear.html">10. Mô hình phi tuyến tính</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-30-credit-scoring.html">11. Credit Scoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-35-caret.html">12. Xây dựng mô hình dự báo với caret</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-65-chat-luong-mo-hinh.html">13. Chất lượng mô hình</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-70-tidymodels.html">14. Tidymodels</a></li>
</ul>
<p class="caption"><span class="caption-text">Unsupervised learning</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p04-01-unsupervised-learning.html">1. Unsupervised learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="p04-02-kmeans.html">2. k-means</a></li>
<li class="toctree-l1"><a class="reference internal" href="p04-03-hierarchical-clustering.html">3. Hierachical clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="p04-04-basket-analysis.html">4. Phân tích giỏ hàng</a></li>
<li class="toctree-l1"><a class="reference internal" href="p04-05-pca.html">5. Principal component analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="p04-06-factor-analysis.html">6. Phân tích nhân tố ẩn (factor analysis)</a></li>
</ul>
<p class="caption"><span class="caption-text">Chuỗi thời gian</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p05-01-chuoi-thoi-gian.html">1. Giới thiệu về chuỗi thời gian</a></li>
<li class="toctree-l1"><a class="reference internal" href="p05-02-arima.html">2. Mô hình ARIMA</a></li>
<li class="toctree-l1"><a class="reference internal" href="p05-03-phan-tich-chuoi-thoi-gian-voi-tidyquant.html">3. Phân tích chuỗi thời gian với tidyquant và timetk</a></li>
<li class="toctree-l1"><a class="reference internal" href="p05-06-du-bao-ts-voi-prophet.html">4. Dự báo chuỗi thời gian với prophet</a></li>
<li class="toctree-l1"><a class="reference internal" href="p05-07-du-bao-ts-voi-timetk.html">5. Dự báo chuỗi thời gian với timetk</a></li>
<li class="toctree-l1"><a class="reference internal" href="p05-08-abnomaly-detection.html">6. Abnomaly detection trong times series</a></li>
</ul>
<p class="caption"><span class="caption-text">Ngôn ngữ tự nghiên</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="p06-01-nlp-co-ban.html">1. Xử lý ngôn ngữ tự nhiên cơ bản</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">2. Phân loại text</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#gioi-thieu">2.1. Giới thiệu</a></li>
<li class="toctree-l2"><a class="reference internal" href="#thuc-hanh-voi-r">2.2. Thực hành với R</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tai-lieu-tham-khao">2.3. Tài liệu tham khảo</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="p06-07-nlp-api.html">3. Sử dụng API từ các dịch vụ đám mây</a></li>
<li class="toctree-l1"><a class="reference internal" href="p06-10-ocr-tesseract.html">4. OCR với <code class="docutils literal notranslate"><span class="pre">tesseract</span></code></a></li>
</ul>
<p class="caption"><span class="caption-text">Các phương pháp khác</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p07-01-survival-analysis.html">1. Survival analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="p07-02-causal-impact.html">2. Causal Impact</a></li>
<li class="toctree-l1"><a class="reference internal" href="p07-03-collaborative-filtering.html">3. Collaborative Filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="p07-07-spatial-data.html">4. Spatial data</a></li>
<li class="toctree-l1"><a class="reference internal" href="p07-10-shiny.html">5. Shiny apps</a></li>
</ul>
<p class="caption"><span class="caption-text">Deep Learning</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p09-01-gioi-thieu-deep-learning.html">1. Giới thiệu cơ bản về Deep Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="p09-02-co-ban-kien-thuc-toan.html">2. Kiến thức cơ bản toán học cho deep learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="p09-03-mo-hinh-deep-learning-co-ban.html">3. Mô hình deep learning cơ bản</a></li>
<li class="toctree-l1"><a class="reference internal" href="p09-04-convolution-neural-network.html">4. Convolution neural networks</a></li>
</ul>
<p class="caption"><span class="caption-text">Cloud Computing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p10-01-cai-dat-rstudio-server-tren-amazon.html">1. Cài đặt server RStudio trên Amazon</a></li>
<li class="toctree-l1"><a class="reference internal" href="p10-03-web-service-azure.html">2. Xây dựng web service với Azure</a></li>
<li class="toctree-l1"><a class="reference internal" href="p10-09-apis-voi-plumber.html">3. API với Plumber</a></li>
</ul>
<p class="caption"><span class="caption-text">Kiến thức bổ trợ</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p11-01-git.html">1. Sử dụng GIT</a></li>
<li class="toctree-l1"><a class="reference internal" href="p11-02-cmd.html">2. CMD và Bash</a></li>
<li class="toctree-l1"><a class="reference internal" href="p11-03-docker.html">3. Sử dụng docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="p11-04-apis.html">4. API</a></li>
<li class="toctree-l1"><a class="reference internal" href="p11-05-html-css.html">5. Cơ bản về HTML và CSS</a></li>
<li class="toctree-l1"><a class="reference internal" href="p11-09-other.html">6. Các tricks khác</a></li>
</ul>
<p class="caption"><span class="caption-text">Case studies</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p13-01-casestudy-truc-quan-hoa.html">1. Trực quan hóa dữ liệu</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Phân tích dữ liệu với R</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>2. Phân loại text</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/p06-04-text-classification.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="phan-loai-text">
<h1>2. Phân loại text<a class="headerlink" href="#phan-loai-text" title="Permalink to this headline">¶</a></h1>
<div class="section" id="gioi-thieu">
<h2>2.1. Giới thiệu<a class="headerlink" href="#gioi-thieu" title="Permalink to this headline">¶</a></h2>
<p>Khi xử lý dữ liệu <code class="docutils literal notranslate"><span class="pre">text</span></code>, bên cạnh các bước cơ bản như tìm trực quan
hóa tần suất, số lượng từ, xây dựng wordcloud, còn có nhiều kỹ thuật
khác ứng dụng học máy trong xử lý ngôn ngữ. Trong chương này, ta sẽ tìm
hiểu cách thức phân loại dữ liệu text.</p>
<p>Khác với định dạng bảng thông thường, khi xây dựng mô hình dự báo trong
text, ta cần phải biến dữ liệu từ dạng text sang dạng bảng. Dữ liệu mới
(dạng bảng) sẽ được sử dụng trong việc xây dựng mô hình. Trong các kỹ
thuật dạng này, <code class="docutils literal notranslate"><span class="pre">word2vec</span></code> của <code class="docutils literal notranslate"><span class="pre">h2o</span></code> là thuật toán vượt trội, biến
dữ liệu <code class="docutils literal notranslate"><span class="pre">text</span></code> bản gốc thành dữ liệu mới giúp xây dựng mô hình dự báo
hiệu quả.</p>
<p>Khái quát hơn, các bước của việc dự báo dữ liệu text diễn ra như sau.</p>
<ul class="simple">
<li>Thực hiện <code class="docutils literal notranslate"><span class="pre">word2vec</span></code>:<ul>
<li>Tokenize words</li>
<li>Loại bỏ các từ thừa</li>
<li>Xây mô hình word2vec</li>
<li>Test thử mô hình với các từ gần nghĩa</li>
</ul>
</li>
<li>Sử dụng mô hình word2vec để biến đổi text thành vector</li>
<li>Xây dựng mô hình dự báo như bình thường</li>
<li>Sử dụng word2vec để biến đổi text (validation) thành vector và dự báo
với mô hình vừa xây</li>
</ul>
</div>
<div class="section" id="thuc-hanh-voi-r">
<h2>2.2. Thực hành với R<a class="headerlink" href="#thuc-hanh-voi-r" title="Permalink to this headline">¶</a></h2>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="kn">library</span><span class="p">(</span>tidyverse<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>h2o<span class="p">)</span>
h2o.init<span class="p">()</span>

<span class="c1">#df &lt;- read_csv(&quot;data/craigslistJobTitles.csv&quot;)</span>

job.titles.path <span class="o">=</span> <span class="s">&quot;data/craigslistJobTitles.csv&quot;</span>

job.titles <span class="o">&lt;-</span> h2o.importFile<span class="p">(</span>job.titles.path<span class="p">,</span>
                             destination_frame <span class="o">=</span> <span class="s">&quot;jobtitles&quot;</span><span class="p">,</span>
                             col.names <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;category&quot;</span><span class="p">,</span> <span class="s">&quot;jobtitle&quot;</span><span class="p">),</span>
                             col.types <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;Enum&quot;</span><span class="p">,</span> <span class="s">&quot;String&quot;</span><span class="p">),</span> header <span class="o">=</span> <span class="bp">F</span><span class="p">)</span>

STOP_WORDS <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;ax&quot;</span><span class="p">,</span><span class="s">&quot;i&quot;</span><span class="p">,</span><span class="s">&quot;you&quot;</span><span class="p">,</span><span class="s">&quot;edu&quot;</span><span class="p">,</span><span class="s">&quot;s&quot;</span><span class="p">,</span><span class="s">&quot;t&quot;</span><span class="p">,</span><span class="s">&quot;m&quot;</span><span class="p">,</span><span class="s">&quot;subject&quot;</span><span class="p">,</span><span class="s">&quot;can&quot;</span><span class="p">,</span><span class="s">&quot;lines&quot;</span><span class="p">,</span><span class="s">&quot;re&quot;</span><span class="p">,</span><span class="s">&quot;what&quot;</span><span class="p">,</span>
               <span class="s">&quot;there&quot;</span><span class="p">,</span><span class="s">&quot;all&quot;</span><span class="p">,</span><span class="s">&quot;we&quot;</span><span class="p">,</span><span class="s">&quot;one&quot;</span><span class="p">,</span><span class="s">&quot;the&quot;</span><span class="p">,</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="s">&quot;an&quot;</span><span class="p">,</span><span class="s">&quot;of&quot;</span><span class="p">,</span><span class="s">&quot;or&quot;</span><span class="p">,</span><span class="s">&quot;in&quot;</span><span class="p">,</span><span class="s">&quot;for&quot;</span><span class="p">,</span><span class="s">&quot;by&quot;</span><span class="p">,</span><span class="s">&quot;on&quot;</span><span class="p">,</span>
               <span class="s">&quot;but&quot;</span><span class="p">,</span><span class="s">&quot;is&quot;</span><span class="p">,</span><span class="s">&quot;in&quot;</span><span class="p">,</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="s">&quot;not&quot;</span><span class="p">,</span><span class="s">&quot;with&quot;</span><span class="p">,</span><span class="s">&quot;as&quot;</span><span class="p">,</span><span class="s">&quot;was&quot;</span><span class="p">,</span><span class="s">&quot;if&quot;</span><span class="p">,</span><span class="s">&quot;they&quot;</span><span class="p">,</span><span class="s">&quot;are&quot;</span><span class="p">,</span><span class="s">&quot;this&quot;</span><span class="p">,</span><span class="s">&quot;and&quot;</span><span class="p">,</span><span class="s">&quot;it&quot;</span><span class="p">,</span><span class="s">&quot;have&quot;</span><span class="p">,</span>
               <span class="s">&quot;from&quot;</span><span class="p">,</span><span class="s">&quot;at&quot;</span><span class="p">,</span><span class="s">&quot;my&quot;</span><span class="p">,</span><span class="s">&quot;be&quot;</span><span class="p">,</span><span class="s">&quot;by&quot;</span><span class="p">,</span><span class="s">&quot;not&quot;</span><span class="p">,</span><span class="s">&quot;that&quot;</span><span class="p">,</span><span class="s">&quot;to&quot;</span><span class="p">,</span><span class="s">&quot;from&quot;</span><span class="p">,</span><span class="s">&quot;com&quot;</span><span class="p">,</span><span class="s">&quot;org&quot;</span><span class="p">,</span><span class="s">&quot;like&quot;</span><span class="p">,</span><span class="s">&quot;likes&quot;</span><span class="p">,</span><span class="s">&quot;so&quot;</span><span class="p">)</span>


<span class="c1"># Hàm tokenize trong H2O</span>

tokenize <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>sentences<span class="p">,</span> stop.words <span class="o">=</span> STOP_WORDS<span class="p">)</span> <span class="p">{</span>
  tokenized <span class="o">&lt;-</span> h2o.tokenize<span class="p">(</span>sentences<span class="p">,</span> <span class="s">&quot;\\\\W+&quot;</span><span class="p">)</span>

  <span class="c1"># convert to lower case</span>
  tokenized.lower <span class="o">&lt;-</span> h2o.tolower<span class="p">(</span>tokenized<span class="p">)</span>
  <span class="c1"># remove short words (less than 2 characters)</span>
  tokenized.lengths <span class="o">&lt;-</span> h2o.nchar<span class="p">(</span>tokenized.lower<span class="p">)</span>
  tokenized.filtered <span class="o">&lt;-</span> tokenized.lower<span class="p">[</span><span class="kp">is.na</span><span class="p">(</span>tokenized.lengths<span class="p">)</span> <span class="o">||</span> tokenized.lengths <span class="o">&gt;=</span> <span class="m">2</span><span class="p">,]</span>
  <span class="c1"># remove words that contain numbers</span>
  tokenized.words <span class="o">&lt;-</span> tokenized.filtered<span class="p">[</span>h2o.grep<span class="p">(</span><span class="s">&quot;[0-9]&quot;</span><span class="p">,</span> tokenized.filtered<span class="p">,</span> invert <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> output.logical <span class="o">=</span> <span class="kc">TRUE</span><span class="p">),]</span>

  <span class="c1"># remove stop words</span>
  tokenized.words<span class="p">[</span><span class="kp">is.na</span><span class="p">(</span>tokenized.words<span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="o">!</span> tokenized.words <span class="o">%in%</span> STOP_WORDS<span class="p">),]</span>
<span class="p">}</span>

<span class="c1"># Xây hàm mô hình dự báo với word2vec và GBM (mô hình phân loại)</span>
predict <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>job.title<span class="p">,</span> w2v<span class="p">,</span> gbm<span class="p">)</span> <span class="p">{</span>
  words <span class="o">&lt;-</span> tokenize<span class="p">(</span><span class="kp">as.character</span><span class="p">(</span>as.h2o<span class="p">(</span>job.title<span class="p">)))</span>
  job.title.vec <span class="o">&lt;-</span> h2o.transform<span class="p">(</span>w2v<span class="p">,</span> words<span class="p">,</span> aggregate_method <span class="o">=</span> <span class="s">&quot;AVERAGE&quot;</span><span class="p">)</span>
  h2o.predict<span class="p">(</span>gbm<span class="p">,</span> job.title.vec<span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li>Xây dựng mô hình <code class="docutils literal notranslate"><span class="pre">word2vec</span></code></li>
</ul>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="kp">print</span><span class="p">(</span><span class="s">&quot;Break job titles into sequence of words&quot;</span><span class="p">)</span>
words <span class="o">&lt;-</span> tokenize<span class="p">(</span>job.titles<span class="o">$</span>jobtitle<span class="p">)</span>

<span class="kp">print</span><span class="p">(</span><span class="s">&quot;Build word2vec model&quot;</span><span class="p">)</span>
w2v.model <span class="o">&lt;-</span> h2o.word2vec<span class="p">(</span>words<span class="p">,</span> sent_sample_rate <span class="o">=</span> <span class="m">0</span><span class="p">,</span> epochs <span class="o">=</span> <span class="m">10</span><span class="p">)</span>

<span class="c1"># Kiểm tra lại mô hình</span>
<span class="kp">print</span><span class="p">(</span><span class="s">&quot;Sanity check - find synonyms for the word &#39;teacher&#39;&quot;</span><span class="p">)</span>
h2o.findSynonyms<span class="p">(</span>w2v.model<span class="p">,</span> <span class="s">&quot;supervisor&quot;</span><span class="p">,</span> count <span class="o">=</span> <span class="m">5</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li>Việc kiểm tra các từ gần nghĩa chỉ có tác dụng với các từ có trong mô
hình</li>
</ul>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span>word.df <span class="o">&lt;-</span> words <span class="o">%&gt;%</span> <span class="kp">as.data.frame</span><span class="p">()</span> <span class="o">%&gt;%</span> rename<span class="p">(</span>word <span class="o">=</span> C1<span class="p">)</span>
<span class="kp">print</span><span class="p">(</span>word.df <span class="o">%&gt;%</span> filter<span class="p">(</span>word <span class="o">==</span> <span class="s">&quot;hello&quot;</span><span class="p">))</span>
</pre></div>
</div>
<ul class="simple">
<li>Xây dựng mô hình phân loại công việc</li>
</ul>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="kp">print</span><span class="p">(</span><span class="s">&quot;Calculate a vector for each job title&quot;</span><span class="p">)</span>
job.title.vecs <span class="o">&lt;-</span> h2o.transform<span class="p">(</span>w2v.model<span class="p">,</span> words<span class="p">,</span> aggregate_method <span class="o">=</span> <span class="s">&quot;AVERAGE&quot;</span><span class="p">)</span>

<span class="kp">print</span><span class="p">(</span><span class="s">&quot;Prepare training&amp;validation data (keep only job titles made of known words)&quot;</span><span class="p">)</span>
job.title.vecs <span class="o">%&gt;%</span> <span class="kp">dim</span>
valid.job.titles <span class="o">&lt;-</span> <span class="o">!</span><span class="kp">is.na</span><span class="p">(</span>job.title.vecs<span class="o">$</span>C1<span class="p">)</span>

data <span class="o">&lt;-</span> h2o.cbind<span class="p">(</span>job.titles<span class="p">[</span>valid.job.titles<span class="p">,</span> <span class="s">&quot;category&quot;</span><span class="p">],</span> job.title.vecs<span class="p">[</span>valid.job.titles<span class="p">,</span> <span class="p">])</span>
data <span class="o">%&gt;%</span> <span class="kp">names</span>

<span class="c1"># Chia train và test</span>
data.split <span class="o">&lt;-</span> h2o.splitFrame<span class="p">(</span>data<span class="p">,</span> ratios <span class="o">=</span> <span class="m">0.8</span><span class="p">)</span>

<span class="kp">print</span><span class="p">(</span><span class="s">&quot;Build a basic GBM model&quot;</span><span class="p">)</span>
gbm.model <span class="o">&lt;-</span> h2o.gbm<span class="p">(</span>x <span class="o">=</span> <span class="kp">names</span><span class="p">(</span>job.title.vecs<span class="p">),</span> y <span class="o">=</span> <span class="s">&quot;category&quot;</span><span class="p">,</span>
                     training_frame <span class="o">=</span> data.split<span class="p">[[</span><span class="m">1</span><span class="p">]],</span> validation_frame <span class="o">=</span> data.split<span class="p">[[</span><span class="m">2</span><span class="p">]])</span>

<span class="c1"># Dự báo với job description mới</span>
<span class="kp">print</span><span class="p">(</span><span class="s">&quot;Predict!&quot;</span><span class="p">)</span>
<span class="kp">print</span><span class="p">(</span>predict<span class="p">(</span><span class="s">&quot;school teacher having holidays every month&quot;</span><span class="p">,</span> w2v.model<span class="p">,</span> gbm.model<span class="p">))</span>
<span class="kp">print</span><span class="p">(</span>predict<span class="p">(</span><span class="s">&quot;developer with 3+ Java experience, jumping&quot;</span><span class="p">,</span> w2v.model<span class="p">,</span> gbm.model<span class="p">))</span>
<span class="kp">print</span><span class="p">(</span>predict<span class="p">(</span><span class="s">&quot;Financial accountant CPA preferred&quot;</span><span class="p">,</span> w2v.model<span class="p">,</span> gbm.model<span class="p">))</span>
<span class="kp">print</span><span class="p">(</span>predict<span class="p">(</span><span class="s">&quot;strong finance background&quot;</span><span class="p">,</span> w2v.model<span class="p">,</span> gbm.model<span class="p">))</span>
<span class="kp">print</span><span class="p">(</span>predict<span class="p">(</span><span class="s">&quot;Need someone who can sell beer&quot;</span><span class="p">,</span> w2v.model<span class="p">,</span> gbm.model<span class="p">))</span>
<span class="kp">print</span><span class="p">(</span>predict<span class="p">(</span><span class="s">&quot;answer customer based on their request&quot;</span><span class="p">,</span> w2v.model<span class="p">,</span> gbm.model<span class="p">))</span>

<span class="c1"># Dự báo được cả các word không có trong mô hình bằng cách lấy trung bình tất cả các category</span>
<span class="kp">print</span><span class="p">(</span>predict<span class="p">(</span><span class="s">&quot;việt nam&quot;</span><span class="p">,</span> w2v.model<span class="p">,</span> gbm.model<span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="tai-lieu-tham-khao">
<h2>2.3. Tài liệu tham khảo<a class="headerlink" href="#tai-lieu-tham-khao" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://www.slideshare.net/0xdata/nlp-with-h2o">https://www.slideshare.net/0xdata/nlp-with-h2o</a></li>
<li><a class="reference external" href="https://www.shanelynn.ie/get-busy-with-word-embeddings-introduction/">https://www.shanelynn.ie/get-busy-with-word-embeddings-introduction/</a></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="p06-07-nlp-api.html" class="btn btn-neutral float-right" title="3. Sử dụng API từ các dịch vụ đám mây" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="p06-01-nlp-co-ban.html" class="btn btn-neutral float-left" title="1. Xử lý ngôn ngữ tự nhiên cơ bản" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Anh Hoang Duc

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>