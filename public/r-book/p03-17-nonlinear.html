

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="vi" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="vi" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>9. Mô hình phi tuyến tính &mdash; Tài liệu Phân tích dữ liệu với R 2019</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'./',
              VERSION:'2019',
              LANGUAGE:'vi',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
        <script type="text/javascript" src="_static/copybutton.js"></script>
        <script type="text/javascript" src="_static/translations.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Tìm Kiếm" href="search.html" />
    <link rel="next" title="10. Credit Scoring" href="p03-30-credit-scoring.html" />
    <link rel="prev" title="8. Regularization" href="p03-15-regularization.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Phân tích dữ liệu với R
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Giới thiệu</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p01-01-gioi-thieu.html">Khoa học dữ liệu và nghề phân tích dữ liệu</a></li>
</ul>
<p class="caption"><span class="caption-text">Phân tích khám phá dữ liệu</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p02-03-bien-doi-du-lieu-dplyr.html">1. Ngữ pháp của biến đổi dữ liệu với DPLYR</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-04-phan-ra-va-xoay-chieu-du-lieu.html">2. Phân rã và xoay chiều dữ liệu</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-05-cac-chi-so-thong-ke.html">3. Các chỉ số thống kê mô tả cơ bản</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-06-lap-trinh-ham.html">4. Lập trình hàm</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-07-lap-trinh-ham-voi-purrr.html">5. Lập trình chức năng hàm với purrr</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-08-bien-doi-du-lieu-text.html">6. Biến đổi dữ liệu text</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-11-quan-ly-nhieu-mo-hinh.html">7. Quản lý kết quả phân tích từ nhiều mô hình</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-15-thong-ke-co-ban.html">8. Xác suất và phân phối thống kê cơ bản</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-16-power-analysis.html">9. Power analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-20-sampling-methods.html">10. Phương pháp ước lượng lấy mẫu</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-50-datatable.html">11. Biến đổi dữ liệu với <code class="docutils literal notranslate"><span class="pre">data.table</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-60-thu-thap-du-lieu-tu-website.html">12. Thu thập dữ liệu từ website</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-99-meo-trong-r.html">13. Các mẹo trong R</a></li>
</ul>
<p class="caption"><span class="caption-text">Supervised learning</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="p03-01-nguyen-ly-du-bao.html">1. Các nguyên lý dự báo</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-02-mo-hinh-ols.html">2. Mô hình OLS</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-03-logistic-regression.html">3. Mô hình hồi quy logistic</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-04-decision-tree.html">4. Cây quyết định</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-05-bagging-boosting.html">5. Bagging, RandomForest và Boosting</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-08-svm.html">6. Support Vector Machine</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-09-feature-engineering.html">7. Feature Engineering</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-15-regularization.html">8. Regularization</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">9. Mô hình phi tuyến tính</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#gioi-thieu">9.1. Giới thiệu</a></li>
<li class="toctree-l2"><a class="reference internal" href="#polynomial-regression">9.2. Polynomial regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-functions">9.3. Step functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#basis-functions">9.4. Basis functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#regression-splines">9.5. Regression splines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#piecewise-polynomials">9.5.1. Piecewise polynomials</a></li>
<li class="toctree-l3"><a class="reference internal" href="#smoothing-splines">9.5.2. Smoothing splines</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#lua-chon-gia-tri">9.6. Lựa chọn giá trị <span class="math notranslate">\(\lambda\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="#local-regression">9.7. Local regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="#generalized-additive-models-gam">9.8. Generalized Additive Models (GAM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#thuc-hanh">9.9. Thực hành</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#polynomial">9.9.1. Polynomial</a></li>
<li class="toctree-l3"><a class="reference internal" href="#splines">9.9.2. Splines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gam">9.9.3. GAM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tai-lieu-tham-khao">9.10. Tài liệu tham khảo</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="p03-30-credit-scoring.html">10. Credit Scoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-35-caret.html">11. Xây dựng mô hình dự báo với caret</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-65-chat-luong-mo-hinh.html">12. Chất lượng mô hình</a></li>
<li class="toctree-l1"><a class="reference internal" href="p03-70-tidymodels.html">13. Tidymodels</a></li>
</ul>
<p class="caption"><span class="caption-text">Unsupervised learning</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p04-01-unsupervised-learning.html">1. Unsupervised learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="p04-02-kmeans.html">2. k-means</a></li>
<li class="toctree-l1"><a class="reference internal" href="p04-03-hierarchical-clustering.html">3. Hierachical clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="p04-04-basket-analysis.html">4. Phân tích giỏ hàng</a></li>
<li class="toctree-l1"><a class="reference internal" href="p04-05-pca.html">5. Principal component analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="p04-06-factor-analysis.html">6. Phân tích nhân tố ẩn (factor analysis)</a></li>
</ul>
<p class="caption"><span class="caption-text">Chuỗi thời gian</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p05-01-chuoi-thoi-gian.html">1. Giới thiệu về chuỗi thời gian</a></li>
<li class="toctree-l1"><a class="reference internal" href="p05-02-arima.html">2. Mô hình ARIMA</a></li>
<li class="toctree-l1"><a class="reference internal" href="p05-03-phan-tich-chuoi-thoi-gian-voi-tidyquant.html">3. Phân tích chuỗi thời gian với tidyquant và timetk</a></li>
<li class="toctree-l1"><a class="reference internal" href="p05-06-du-bao-ts-voi-prophet.html">4. Dự báo chuỗi thời gian với prophet</a></li>
<li class="toctree-l1"><a class="reference internal" href="p05-07-du-bao-ts-voi-timetk.html">5. Dự báo chuỗi thời gian với timetk</a></li>
<li class="toctree-l1"><a class="reference internal" href="p05-08-abnomaly-detection.html">6. Abnomaly detection trong times series</a></li>
</ul>
<p class="caption"><span class="caption-text">Ngôn ngữ tự nghiên</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p06-01-nlp-co-ban.html">1. Xử lý ngôn ngữ tự nhiên cơ bản</a></li>
<li class="toctree-l1"><a class="reference internal" href="p06-04-text-classification.html">2. Phân loại text</a></li>
<li class="toctree-l1"><a class="reference internal" href="p06-07-nlp-api.html">3. Sử dụng API từ các dịch vụ đám mây</a></li>
<li class="toctree-l1"><a class="reference internal" href="p06-10-ocr-tesseract.html">4. OCR với <code class="docutils literal notranslate"><span class="pre">tesseract</span></code></a></li>
</ul>
<p class="caption"><span class="caption-text">Các phương pháp khác</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p07-01-survival-analysis.html">1. Survival analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="p07-02-causal-impact.html">2. Causal Impact</a></li>
<li class="toctree-l1"><a class="reference internal" href="p07-03-collaborative-filtering.html">3. Collaborative Filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="p07-07-spatial-data.html">4. Spatial data</a></li>
<li class="toctree-l1"><a class="reference internal" href="p07-10-shiny.html">5. Shiny apps</a></li>
</ul>
<p class="caption"><span class="caption-text">Deep Learning</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p09-01-gioi-thieu-deep-learning.html">1. Giới thiệu cơ bản về Deep Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="p09-02-co-ban-kien-thuc-toan.html">2. Kiến thức cơ bản toán học cho deep learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="p09-03-mo-hinh-deep-learning-co-ban.html">3. Mô hình deep learning cơ bản</a></li>
<li class="toctree-l1"><a class="reference internal" href="p09-04-convolution-neural-network.html">4. Convolution neural networks</a></li>
</ul>
<p class="caption"><span class="caption-text">Cloud Computing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p10-01-cai-dat-rstudio-server-tren-amazon.html">1. Cài đặt server RStudio trên Amazon</a></li>
<li class="toctree-l1"><a class="reference internal" href="p10-03-web-service-azure.html">2. Xây dựng web service với Azure</a></li>
<li class="toctree-l1"><a class="reference internal" href="p10-09-apis-voi-plumber.html">3. API với Plumber</a></li>
</ul>
<p class="caption"><span class="caption-text">Kiến thức bổ trợ</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p11-01-git.html">1. Sử dụng GIT</a></li>
<li class="toctree-l1"><a class="reference internal" href="p11-02-cmd.html">2. CMD và Bash</a></li>
<li class="toctree-l1"><a class="reference internal" href="p11-03-docker.html">3. Sử dụng docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="p11-04-apis.html">4. API</a></li>
<li class="toctree-l1"><a class="reference internal" href="p11-05-html-css.html">5. Cơ bản về HTML và CSS</a></li>
<li class="toctree-l1"><a class="reference internal" href="p11-09-other.html">6. Các tricks khác</a></li>
</ul>
<p class="caption"><span class="caption-text">Case studies</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p13-01-casestudy-truc-quan-hoa.html">1. Trực quan hóa dữ liệu</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Phân tích dữ liệu với R</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>9. Mô hình phi tuyến tính</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/p03-17-nonlinear.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="mo-hinh-phi-tuyen-tinh">
<h1>9. Mô hình phi tuyến tính<a class="headerlink" href="#mo-hinh-phi-tuyen-tinh" title="Permalink to this headline">¶</a></h1>
<p>Ở các phần trước, ta đã đề cập đến các kỹ thuật phân tích có tính ứng
dụng thực tiễn cao như <code class="docutils literal notranslate"><span class="pre">linear</span> <span class="pre">regression</span></code>, <code class="docutils literal notranslate"><span class="pre">logistic</span> <span class="pre">regression</span></code>
hay <code class="docutils literal notranslate"><span class="pre">tree</span> <span class="pre">based</span> <span class="pre">methods</span></code>. Ở chương này, ta sẽ đề cập nhiều hơn đến các
mô hình mở rộng của <code class="docutils literal notranslate"><span class="pre">regression</span></code> và sử dụng các mô hình phi tuyến</p>
<div class="section" id="gioi-thieu">
<h2>9.1. Giới thiệu<a class="headerlink" href="#gioi-thieu" title="Permalink to this headline">¶</a></h2>
<p>Mô hình tuyến tính như OLS, Ridge, Lasso có rất nhiều nhược điểm và giả
thuyết cần phải thỏa mãm. Ngoài nhánh <code class="docutils literal notranslate"><span class="pre">linear</span> <span class="pre">regression</span></code>, ta còn có
mô hình:</p>
<ul class="simple">
<li><strong>Polynomial regression</strong>: Hàm bậc cao X, <span class="math notranslate">\(X^2\)</span>, <span class="math notranslate">\(X^3\)</span></li>
<li><strong>Step functions</strong>: Chia biến thành k miền khác nhau</li>
<li><strong>Regression splines</strong>: Chia biến y thành k miền khác nhau, với mỗi
miền sẽ xây dựng một polynomial regression sao cho biến y liên tục
trên toàn miền</li>
<li><strong>Smoothing splines</strong>: Tương tự như regression splines, nhưng thêm
điều kiện tối ưu hóa tổng bình phương sai số</li>
<li><strong>Local regression</strong>: Tương tự như splines nhưng cho phép các miền
của biến y chồng lên nhau</li>
<li><strong>Generalized additive models</strong>: Mở rộng tất cả các phương pháp trên</li>
</ul>
</div>
<div class="section" id="polynomial-regression">
<h2>9.2. Polynomial regression<a class="headerlink" href="#polynomial-regression" title="Permalink to this headline">¶</a></h2>
<p>Phương trình của polynomial regression</p>
<div class="math notranslate">
\[y_i = \beta_0 + \beta_1X_i + \beta_2X_i^2+...+\beta_dX_i^d +\epsilon\]</div>
<p><strong>Lưu ý</strong>:</p>
<ul class="simple">
<li>Phương trình trên có thể ước lượng đơn giản với OLS</li>
<li>Không nên sử dụng <span class="math notranslate">\(d \geq 4\)</span></li>
</ul>
</div>
<div class="section" id="step-functions">
<h2>9.3. Step functions<a class="headerlink" href="#step-functions" title="Permalink to this headline">¶</a></h2>
<p>Chia biến y thành các k khu vực (bins), tìm hằng số không đổi cho mỗi
bin, thay đổi các biến liên tục thành các biến category có sắp xếp.</p>
<p><img alt="image0" src="Images/p03-17-01.png" /></p>
</div>
<div class="section" id="basis-functions">
<h2>9.4. Basis functions<a class="headerlink" href="#basis-functions" title="Permalink to this headline">¶</a></h2>
<p>Các hàm polynomial và step function (còn gọi là piecewise constant
function) là dạng hàm đặc biệt của basis function.</p>
<p>Gọi <span class="math notranslate">\(b_i(.)\)</span> là hàm đã biết trước của <span class="math notranslate">\(X\)</span>, ta có:</p>
<div class="math notranslate">
\[y_i = \beta_0 + \beta_1b_1(x_i) + ... +
\beta_kb_k(x_i) + \epsilon\]</div>
<ul class="simple">
<li>Đối với polynomial: <span class="math notranslate">\(b_j(x_i) = x_i^j\)</span></li>
<li>Đối với step function: <span class="math notranslate">\(b_j(x_i)= I(c_j \leq x_i \prec_{j+1}\)</span></li>
</ul>
</div>
<div class="section" id="regression-splines">
<h2>9.5. Regression splines<a class="headerlink" href="#regression-splines" title="Permalink to this headline">¶</a></h2>
<div class="section" id="piecewise-polynomials">
<h3>9.5.1. Piecewise polynomials<a class="headerlink" href="#piecewise-polynomials" title="Permalink to this headline">¶</a></h3>
<p>Hàm piecewise polynomial chia X thành nhiều nhóm, và xây dựng polynomial
cho từng nhóm. Điểm mà các hệ số tương quan của X thay đổi giữa các khu
vực gọi là <em>knots</em></p>
<p><img alt="image1" src="Images/p03-17-03.png" /></p>
<p>Để các hàm splines được <em>smooth</em>, ta giải hệ phương trình để tất cả các
điểm trên đồ thị, đạo hàm bậc 1 và 2 đều liên tục.</p>
<p><img alt="image2" src="Images/p03-17-04.png" /></p>
<p><strong>Lưu ý</strong>:</p>
<ul class="simple">
<li>Cách tính trên có thể được thay bằng giải phương trình của
*truncated power basis** (Xem thêm mục 7.4.3)</li>
<li><em>Natural splines</em> là phương trình của cubic splines nhưng thêm điều
kiện là phương trình phải tuyến tính (linear) tại các điểm biên
(boundary constraints)</li>
</ul>
<p><img alt="image3" src="Images/p03-17-05.png" /></p>
<ul class="simple">
<li>Để lựa chọn số lượng <em>knots K</em>, ta sử dụng Cross-Validation. MSE nhỏ
nhất sẽ được sử dụng</li>
</ul>
<p><strong>So sánh với polynomial</strong>: Regression splines có những ưu điểm sau so
với polynomial:</p>
<ul class="simple">
<li>Cho phép thêm các knots tại các khu vực mà hệ số tương quan thay đổi
nhanh</li>
<li>Giữ bậc của các biến trong mô hình thấp</li>
</ul>
</div>
<div class="section" id="smoothing-splines">
<h3>9.5.2. Smoothing splines<a class="headerlink" href="#smoothing-splines" title="Permalink to this headline">¶</a></h3>
<p>Khi xây dựng mô hình, ta muốn xây dựng một hàm f(x) sao cho RSS là nhỏ
nhất. Tuy nhiên, ta có thể biến RSS có giá trị bằng 0 bằng cách chọn
f(x) sao cho f(x) bao quanh tất cả các giá trị của y.</p>
<p>Do đó, ta muốn xây dựng đường f(x) sao cho RSS nhỏ nhất đồng thời
smooth.</p>
<div class="math notranslate">
\[\sum_{i=1}^n(y_i-g(x_i))^2+\lambda\int g^{''}(t)^2dt\]</div>
<p>Trong đó:</p>
<ul class="simple">
<li><span class="math notranslate">\(\lambda\)</span> được gọi là <em>tuning parameter</em></li>
<li><span class="math notranslate">\(g\)</span> được gọi là smoothing spline</li>
</ul>
<p>Đối với phương trình trên:</p>
<ul class="simple">
<li><span class="math notranslate">\(\sum_{i=1}^n(y_i-g(x_i))^2\)</span> được gọi là <em>loss function</em>, mục
tiêu để phương trình lý thuyết và thực tế gần nhau nhất</li>
<li><span class="math notranslate">\(\lambda\int g^{''}(t)^2dt\)</span> được gọi là <em>penalty</em> của hàm lý
thuyết.<ul>
<li><span class="math notranslate">\(g^{'}\)</span> đo lường độ dốc của các hệ số trong phương trình tại
điểm t,</li>
<li><span class="math notranslate">\(g^{''}\)</span> đo lường độ thay đổi của các hệ số trong phương
trình tại điểm t. Tích phân của <span class="math notranslate">\(g^{''}\)</span> đo lường tổng các
sự thay đổi của các hệ số trên toàn miền dữ liệu tính toán.<ul>
<li>Nếu hệ số <span class="math notranslate">\(\beta\)</span> trên toàn miền không đổi, phần penalty
này sẽ có giá trị bằng 0</li>
<li><span class="math notranslate">\(\lambda\)</span> càng lớn, phương trình sẽ càng <em>trơn</em> (smooth).
Nếu <span class="math notranslate">\(\lambda = 0\)</span>, phương trình sẽ là các đường nối các
điểm <span class="math notranslate">\(y_i\)</span>. Nếu <span class="math notranslate">\(\lambda \rightarrow \infty\)</span>,
phương trình sẽ là 1 đường thẳng và trở về OLS</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>Lưu ý</strong>: Hàm <span class="math notranslate">\(g(x)\)</span> thỏa mãn các điều kiện trên là đường
<em>natural cubic splines</em> với các knots là tất cả các điểm riêng biệt
<span class="math notranslate">\(x_i\)</span></p>
</div>
</div>
<div class="section" id="lua-chon-gia-tri">
<h2>9.6. Lựa chọn giá trị <span class="math notranslate">\(\lambda\)</span><a class="headerlink" href="#lua-chon-gia-tri" title="Permalink to this headline">¶</a></h2>
<p><strong>Effective degress of freedom</strong>: Xem thêm mục 7.5</p>
</div>
<div class="section" id="local-regression">
<h2>9.7. Local regression<a class="headerlink" href="#local-regression" title="Permalink to this headline">¶</a></h2>
<p>Xem thêm mục 7.6</p>
</div>
<div class="section" id="generalized-additive-models-gam">
<h2>9.8. Generalized Additive Models (GAM)<a class="headerlink" href="#generalized-additive-models-gam" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate">
\[y_i = \beta_0 + f_1(x_{i1}) + ... + f_px_{ip} + \epsilon_i\]</div>
<p><strong>Lưu ý</strong>: GAM cũng có thể được dùng cho logistic như sau:</p>
<div class="math notranslate">
\[log(\frac{p(X)}{1-p(X)})=\beta_0 + f_1(x_{i1}) + ... + f_px_{ip}\]</div>
</div>
<div class="section" id="thuc-hanh">
<h2>9.9. Thực hành<a class="headerlink" href="#thuc-hanh" title="Permalink to this headline">¶</a></h2>
<div class="section" id="polynomial">
<h3>9.9.1. Polynomial<a class="headerlink" href="#polynomial" title="Permalink to this headline">¶</a></h3>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ISLR</span><span class="p">)</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">wage</span> <span class="o">~</span> <span class="nf">poly</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="m">4</span><span class="p">),</span> <span class="n">data</span> <span class="o">=</span> <span class="n">Wage</span><span class="p">)</span>
<span class="n">fit</span> <span class="o">%&gt;%</span> <span class="n">summary</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##</span>
<span class="c1">## Call:</span>
<span class="c1">## lm(formula = wage ~ poly(age, 4), data = Wage)</span>
<span class="c1">##</span>
<span class="c1">## Residuals:</span>
<span class="c1">##     Min      1Q  Median      3Q     Max</span>
<span class="c1">## -98.707 -24.626  -4.993  15.217 203.693</span>
<span class="c1">##</span>
<span class="c1">## Coefficients:</span>
<span class="c1">##                Estimate Std. Error t value Pr(&gt;|t|)</span>
<span class="c1">## (Intercept)    111.7036     0.7287 153.283  &lt; 2e-16 ***</span>
<span class="c1">## poly(age, 4)1  447.0679    39.9148  11.201  &lt; 2e-16 ***</span>
<span class="c1">## poly(age, 4)2 -478.3158    39.9148 -11.983  &lt; 2e-16 ***</span>
<span class="c1">## poly(age, 4)3  125.5217    39.9148   3.145  0.00168 **</span>
<span class="c1">## poly(age, 4)4  -77.9112    39.9148  -1.952  0.05104 .</span>
<span class="c1">## ---</span>
<span class="c1">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span>
<span class="c1">##</span>
<span class="c1">## Residual standard error: 39.91 on 2995 degrees of freedom</span>
<span class="c1">## Multiple R-squared:  0.08626,    Adjusted R-squared:  0.08504</span>
<span class="c1">## F-statistic: 70.69 on 4 and 2995 DF,  p-value: &lt; 2.2e-16</span>
</pre></div>
</div>
</div>
<div class="section" id="splines">
<h3>9.9.2. Splines<a class="headerlink" href="#splines" title="Permalink to this headline">¶</a></h3>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">splines</span><span class="p">)</span>
<span class="n">fit</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">wage</span>∼<span class="nf">bs</span><span class="p">(</span><span class="n">age</span> <span class="p">,</span><span class="n">knots</span> <span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">25</span> <span class="p">,</span><span class="m">40</span> <span class="p">,</span><span class="m">60</span><span class="p">)</span> <span class="p">),</span><span class="n">data</span><span class="o">=</span><span class="n">Wage</span> <span class="p">)</span>

<span class="c1">#Tạo biến mới</span>
<span class="n">agelims</span> <span class="o">&lt;-</span> <span class="nf">range</span><span class="p">(</span><span class="n">Wage</span><span class="o">$</span><span class="n">age</span><span class="p">)</span>
<span class="n">age.grid</span> <span class="o">&lt;-</span> <span class="nf">seq</span><span class="p">(</span><span class="n">from</span><span class="o">=</span> <span class="n">agelims[1]</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span> <span class="n">agelims[2]</span><span class="p">)</span>
<span class="c1">#Dự báo</span>
<span class="n">pred</span> <span class="o">&lt;-</span>  <span class="nf">predict</span><span class="p">(</span><span class="n">fit</span> <span class="p">,</span> <span class="n">newdata</span> <span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">age</span> <span class="o">=</span><span class="n">age.grid</span><span class="p">),</span><span class="n">se</span><span class="o">=</span><span class="bp">T</span><span class="p">)</span>
<span class="c1">#Đồ thị</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">Wage</span><span class="o">$</span><span class="n">age</span> <span class="p">,</span> <span class="n">Wage</span><span class="o">$</span><span class="n">wage</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span><span class="s">&quot; gray &quot;</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="n">age.grid</span><span class="p">,</span> <span class="n">pred</span><span class="o">$</span><span class="n">fit</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span><span class="m">2</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="n">age.grid</span><span class="p">,</span> <span class="n">pred</span><span class="o">$</span><span class="n">fit</span> <span class="o">+</span> <span class="m">2</span><span class="o">*</span> <span class="n">pred</span><span class="o">$</span><span class="n">se</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="n">age.grid</span><span class="p">,</span> <span class="n">pred</span><span class="o">$</span><span class="n">fit</span> <span class="o">-</span> <span class="m">2</span><span class="o">*</span> <span class="n">pred</span><span class="o">$</span><span class="n">se</span><span class="p">,</span> <span class="n">lty</span> <span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="image4" src="p03-17-nonlinear_files/figure-html/unnamed-chunk-3-1.png" /></p>
</div>
<div class="section" id="gam">
<h3>9.9.3. GAM<a class="headerlink" href="#gam" title="Permalink to this headline">¶</a></h3>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">gam</span><span class="p">)</span>
<span class="n">gam1</span> <span class="o">&lt;-</span> <span class="nf">lm</span><span class="p">(</span><span class="n">wage</span>∼<span class="nf">ns</span><span class="p">(</span><span class="n">year</span> <span class="p">,</span><span class="m">4</span><span class="p">)</span> <span class="o">+</span><span class="nf">ns</span><span class="p">(</span><span class="n">age</span> <span class="p">,</span><span class="m">5</span><span class="p">)</span> <span class="o">+</span><span class="n">education</span> <span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">Wage</span> <span class="p">)</span>
<span class="n">gam1</span> <span class="o">%&gt;%</span> <span class="n">summary</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##</span>
<span class="c1">## Call:</span>
<span class="c1">## lm(formula = wage ~ ns(year, 4) + ns(age, 5) + education, data = Wage)</span>
<span class="c1">##</span>
<span class="c1">## Residuals:</span>
<span class="c1">##      Min       1Q   Median       3Q      Max</span>
<span class="c1">## -120.513  -19.608   -3.583   14.112  214.535</span>
<span class="c1">##</span>
<span class="c1">## Coefficients:</span>
<span class="c1">##                             Estimate Std. Error t value Pr(&gt;|t|)</span>
<span class="c1">## (Intercept)                   46.949      4.704   9.980  &lt; 2e-16 ***</span>
<span class="c1">## ns(year, 4)1                   8.625      3.466   2.488  0.01289 *</span>
<span class="c1">## ns(year, 4)2                   3.762      2.959   1.271  0.20369</span>
<span class="c1">## ns(year, 4)3                   8.127      4.211   1.930  0.05375 .</span>
<span class="c1">## ns(year, 4)4                   6.806      2.397   2.840  0.00455 **</span>
<span class="c1">## ns(age, 5)1                   45.170      4.193  10.771  &lt; 2e-16 ***</span>
<span class="c1">## ns(age, 5)2                   38.450      5.076   7.575 4.78e-14 ***</span>
<span class="c1">## ns(age, 5)3                   34.239      4.383   7.813 7.69e-15 ***</span>
<span class="c1">## ns(age, 5)4                   48.678     10.572   4.605 4.31e-06 ***</span>
<span class="c1">## ns(age, 5)5                    6.557      8.367   0.784  0.43328</span>
<span class="c1">## education2. HS Grad           10.983      2.430   4.520 6.43e-06 ***</span>
<span class="c1">## education3. Some College      23.473      2.562   9.163  &lt; 2e-16 ***</span>
<span class="c1">## education4. College Grad      38.314      2.547  15.042  &lt; 2e-16 ***</span>
<span class="c1">## education5. Advanced Degree   62.554      2.761  22.654  &lt; 2e-16 ***</span>
<span class="c1">## ---</span>
<span class="c1">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span>
<span class="c1">##</span>
<span class="c1">## Residual standard error: 35.16 on 2986 degrees of freedom</span>
<span class="c1">## Multiple R-squared:  0.293,  Adjusted R-squared:  0.2899</span>
<span class="c1">## F-statistic:  95.2 on 13 and 2986 DF,  p-value: &lt; 2.2e-16</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">gam.m3</span> <span class="o">&lt;-</span> <span class="nf">gam</span><span class="p">(</span><span class="n">wage</span>∼<span class="nf">s</span><span class="p">(</span><span class="n">year</span> <span class="p">,</span><span class="m">4</span><span class="p">)</span> <span class="o">+</span><span class="nf">s</span><span class="p">(</span><span class="n">age</span> <span class="p">,</span><span class="m">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">education</span> <span class="p">,</span><span class="n">data</span><span class="o">=</span> <span class="n">Wage</span><span class="p">)</span>
<span class="n">gam.m3</span> <span class="o">%&gt;%</span> <span class="n">summary</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##</span>
<span class="c1">## Call: gam(formula = wage ~ s(year, 4) + s(age, 5) + education, data = Wage)</span>
<span class="c1">## Deviance Residuals:</span>
<span class="c1">##     Min      1Q  Median      3Q     Max</span>
<span class="c1">## -119.43  -19.70   -3.33   14.17  213.48</span>
<span class="c1">##</span>
<span class="c1">## (Dispersion Parameter for gaussian family taken to be 1235.69)</span>
<span class="c1">##</span>
<span class="c1">##     Null Deviance: 5222086 on 2999 degrees of freedom</span>
<span class="c1">## Residual Deviance: 3689770 on 2986 degrees of freedom</span>
<span class="c1">## AIC: 29887.75</span>
<span class="c1">##</span>
<span class="c1">## Number of Local Scoring Iterations: 2</span>
<span class="c1">##</span>
<span class="c1">## Anova for Parametric Effects</span>
<span class="c1">##              Df  Sum Sq Mean Sq F value    Pr(&gt;F)</span>
<span class="c1">## s(year, 4)    1   27162   27162  21.981 2.877e-06 ***</span>
<span class="c1">## s(age, 5)     1  195338  195338 158.081 &lt; 2.2e-16 ***</span>
<span class="c1">## education     4 1069726  267432 216.423 &lt; 2.2e-16 ***</span>
<span class="c1">## Residuals  2986 3689770    1236</span>
<span class="c1">## ---</span>
<span class="c1">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span>
<span class="c1">##</span>
<span class="c1">## Anova for Nonparametric Effects</span>
<span class="c1">##             Npar Df Npar F  Pr(F)</span>
<span class="c1">## (Intercept)</span>
<span class="c1">## s(year, 4)        3  1.086 0.3537</span>
<span class="c1">## s(age, 5)         4 32.380 &lt;2e-16 ***</span>
<span class="c1">## education</span>
<span class="c1">## ---</span>
<span class="c1">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span>
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">))</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">gam.m3</span><span class="p">,</span> <span class="n">se</span><span class="o">=</span><span class="kc">TRUE</span> <span class="p">,</span><span class="n">col</span> <span class="o">=</span><span class="s">&quot; blue &quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="image5" src="p03-17-nonlinear_files/figure-html/unnamed-chunk-4-1.png" /></p>
</div>
</div>
<div class="section" id="tai-lieu-tham-khao">
<h2>9.10. Tài liệu tham khảo<a class="headerlink" href="#tai-lieu-tham-khao" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Introduction to Statistical Learning - chapter 7</li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="p03-30-credit-scoring.html" class="btn btn-neutral float-right" title="10. Credit Scoring" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="p03-15-regularization.html" class="btn btn-neutral float-left" title="8. Regularization" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Anh Hoang Duc

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>