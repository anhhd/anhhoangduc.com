<!DOCTYPE html>
<html class="writer-html5" lang="vn" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>4. Machine learning với H2O &mdash; Phân tích dữ liệu với Python 2019 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="_static/nbsphinx-code-cells.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=1ea3fed6"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="_static/copybutton.js?v=f281be69"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="5. Xây dựng API dự báo với Flask" href="p02-20-api-flask.html" />
    <link rel="prev" title="3. Xgboost với sklearn" href="p02-03-xgboost.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Phân tích dữ liệu với Python
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Python cơ bản</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p01-01-intro-jupyter-notebook.html">1. Giới thiệu về Python và Jupyter Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="p01-02-gioi-thieu-co-ban-python.html">2. Các cấu trúc cơ bản trong Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="p01-03-numpy.html">3. Numpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="p01-05-pandas.html">4. Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="p01-06-datetime.html">5. Dữ liệu thời gian trong Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="p01-07-lam-viec-voi-text.html">6. Biến đổi dữ liệu text trong python</a></li>
<li class="toctree-l1"><a class="reference internal" href="p01-08-matplotlib.html">7. Trực quan hóa với Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="p01-08-matplotlib.html#Sử-dụng-style-plot">8. Sử dụng style plot</a></li>
<li class="toctree-l1"><a class="reference internal" href="p01-09-seaborn.html">9. Trực quan hóa với Seaborn</a></li>
<li class="toctree-l1"><a class="reference internal" href="p01-10-ngu-phap-bieu-do.html">10. Ngữ pháp của biểu đồ</a></li>
<li class="toctree-l1"><a class="reference internal" href="p01-13-lam-viec-voi-files.html">11. Làm việc với các file trong máy tính</a></li>
<li class="toctree-l1"><a class="reference internal" href="p01-19-so-sanh-python-r.html">12. So sánh R với Python cơ bản</a></li>
<li class="toctree-l1"><a class="reference internal" href="p01-99-tricks-python.html">13. Các mẹo trong Python</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Machine learning với sklearn</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="p02-01-sklearn.html">1. Giới thiệu cơ bản về Scikit learn</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-02-sklearn-advanced.html">2. sklearn nâng cao</a></li>
<li class="toctree-l1"><a class="reference internal" href="p02-03-xgboost.html">3. Xgboost với sklearn</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">4. Machine learning với <code class="docutils literal notranslate"><span class="pre">H2O</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Giới-thiệu">4.1. Giới thiệu</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Tài-liệu-tham-khảo">4.2. Tài liệu tham khảo</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="p02-20-api-flask.html">5. Xây dựng API dự báo với Flask</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lập trình trong Python</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p06-01-lap-trinh-doi-tuong-python.html">1. Lập trình hướng - đối tượng với Python</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Xây dựng Python package</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p07-01-functions-in-python.html">1. Viết hàm trong Python</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Case studies</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="p09-01-data-exploration-case-study.html">1. Ví dụ phân tích với pandas và matplotlib</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Phân tích dữ liệu với Python</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">4. </span>Machine learning với <code class="docutils literal notranslate"><span class="pre">H2O</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/p02-07-machine-learning-h2o.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Machine-learning-với-H2O">
<h1><span class="section-number">4. </span>Machine learning với <code class="docutils literal notranslate"><span class="pre">H2O</span></code><a class="headerlink" href="#Machine-learning-với-H2O" title="Link to this heading"></a></h1>
<section id="Giới-thiệu">
<h2><span class="section-number">4.1. </span>Giới thiệu<a class="headerlink" href="#Giới-thiệu" title="Link to this heading"></a></h2>
<p>Tương tự như R, <code class="docutils literal notranslate"><span class="pre">H2O</span></code> phát triển module máy học trên <code class="docutils literal notranslate"><span class="pre">python</span></code>. Từ <code class="docutils literal notranslate"><span class="pre">h2o</span></code> version <code class="docutils literal notranslate"><span class="pre">3.26.0.7</span></code>, H2O cho phép upload ngược lại <code class="docutils literal notranslate"><span class="pre">MOJO</span> <span class="pre">object</span></code> để có thể sử dụng trong mô hình.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">h2o</span>
</pre></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">h2o</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h2o</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">nthreads</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_mem_size</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Checking whether there is an H2O instance running at http://localhost:54321 ..... not found.
Attempting to start a local H2O server...
; Java HotSpot(TM) 64-Bit Server VM (build 25.172-b11, mixed mode)
  Starting server from C:\Users\Admin\Anaconda3\lib\site-packages\h2o\backend\bin\h2o.jar
  Ice root: C:\Users\Admin\AppData\Local\Temp\tmpzkoh5o7z
  JVM stdout: C:\Users\Admin\AppData\Local\Temp\tmpzkoh5o7z\h2o_Admin_started_from_python.out
  JVM stderr: C:\Users\Admin\AppData\Local\Temp\tmpzkoh5o7z\h2o_Admin_started_from_python.err
  Server is running at http://127.0.0.1:54321
Connecting to H2O server at http://127.0.0.1:54321 ... successful.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div style="overflow:auto"><table style="width:50%"><tr><td>H2O cluster uptime:</td>
<td>04 secs</td></tr>
<tr><td>H2O cluster timezone:</td>
<td>Asia/Bangkok</td></tr>
<tr><td>H2O data parsing timezone:</td>
<td>UTC</td></tr>
<tr><td>H2O cluster version:</td>
<td>3.26.0.8</td></tr>
<tr><td>H2O cluster version age:</td>
<td>2 days </td></tr>
<tr><td>H2O cluster name:</td>
<td>H2O_from_python_Admin_1mfbvt</td></tr>
<tr><td>H2O cluster total nodes:</td>
<td>1</td></tr>
<tr><td>H2O cluster free memory:</td>
<td>3.556 Gb</td></tr>
<tr><td>H2O cluster total cores:</td>
<td>4</td></tr>
<tr><td>H2O cluster allowed cores:</td>
<td>4</td></tr>
<tr><td>H2O cluster status:</td>
<td>accepting new members, healthy</td></tr>
<tr><td>H2O connection url:</td>
<td>http://127.0.0.1:54321</td></tr>
<tr><td>H2O connection proxy:</td>
<td>{'http': None, 'https': None}</td></tr>
<tr><td>H2O internal security:</td>
<td>False</td></tr>
<tr><td>H2O API Extensions:</td>
<td>Amazon S3, Algos, AutoML, Core V3, TargetEncoder, Core V4</td></tr>
<tr><td>Python version:</td>
<td>3.6.5 final</td></tr></table></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">airlines_data</span> <span class="o">=</span> <span class="n">h2o</span><span class="o">.</span><span class="n">import_file</span><span class="p">(</span><span class="s2">&quot;./99_dataset/allyears2k.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Parse progress: |█████████████████████████████████████████████████████████| 100%
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">airlines_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<table>
<thead>
<tr><th style="text-align: right;">  Year</th><th style="text-align: right;">  Month</th><th style="text-align: right;">  DayofMonth</th><th style="text-align: right;">  DayOfWeek</th><th style="text-align: right;">  DepTime</th><th style="text-align: right;">  CRSDepTime</th><th style="text-align: right;">  ArrTime</th><th style="text-align: right;">  CRSArrTime</th><th>UniqueCarrier  </th><th style="text-align: right;">  FlightNum</th><th>TailNum  </th><th style="text-align: right;">  ActualElapsedTime</th><th style="text-align: right;">  CRSElapsedTime</th><th style="text-align: right;">  AirTime</th><th style="text-align: right;">  ArrDelay</th><th style="text-align: right;">  DepDelay</th><th>Origin  </th><th>Dest  </th><th style="text-align: right;">  Distance</th><th style="text-align: right;">  TaxiIn</th><th style="text-align: right;">  TaxiOut</th><th style="text-align: right;">  Cancelled</th><th>CancellationCode  </th><th style="text-align: right;">  Diverted</th><th style="text-align: right;">  CarrierDelay</th><th style="text-align: right;">  WeatherDelay</th><th style="text-align: right;">  NASDelay</th><th style="text-align: right;">  SecurityDelay</th><th style="text-align: right;">  LateAircraftDelay</th><th>IsArrDelayed  </th><th>IsDepDelayed  </th></tr>
</thead>
<tbody>
<tr><td style="text-align: right;">  1987</td><td style="text-align: right;">     10</td><td style="text-align: right;">          14</td><td style="text-align: right;">          3</td><td style="text-align: right;">      741</td><td style="text-align: right;">         730</td><td style="text-align: right;">      912</td><td style="text-align: right;">         849</td><td>PS             </td><td style="text-align: right;">       1451</td><td>NA       </td><td style="text-align: right;">                 91</td><td style="text-align: right;">              79</td><td style="text-align: right;">      nan</td><td style="text-align: right;">        23</td><td style="text-align: right;">        11</td><td>SAN     </td><td>SFO   </td><td style="text-align: right;">       447</td><td style="text-align: right;">     nan</td><td style="text-align: right;">      nan</td><td style="text-align: right;">          0</td><td>NA                </td><td style="text-align: right;">         0</td><td style="text-align: right;">           nan</td><td style="text-align: right;">           nan</td><td style="text-align: right;">       nan</td><td style="text-align: right;">            nan</td><td style="text-align: right;">                nan</td><td>YES           </td><td>YES           </td></tr>
<tr><td style="text-align: right;">  1987</td><td style="text-align: right;">     10</td><td style="text-align: right;">          15</td><td style="text-align: right;">          4</td><td style="text-align: right;">      729</td><td style="text-align: right;">         730</td><td style="text-align: right;">      903</td><td style="text-align: right;">         849</td><td>PS             </td><td style="text-align: right;">       1451</td><td>NA       </td><td style="text-align: right;">                 94</td><td style="text-align: right;">              79</td><td style="text-align: right;">      nan</td><td style="text-align: right;">        14</td><td style="text-align: right;">        -1</td><td>SAN     </td><td>SFO   </td><td style="text-align: right;">       447</td><td style="text-align: right;">     nan</td><td style="text-align: right;">      nan</td><td style="text-align: right;">          0</td><td>NA                </td><td style="text-align: right;">         0</td><td style="text-align: right;">           nan</td><td style="text-align: right;">           nan</td><td style="text-align: right;">       nan</td><td style="text-align: right;">            nan</td><td style="text-align: right;">                nan</td><td>YES           </td><td>NO            </td></tr>
<tr><td style="text-align: right;">  1987</td><td style="text-align: right;">     10</td><td style="text-align: right;">          17</td><td style="text-align: right;">          6</td><td style="text-align: right;">      741</td><td style="text-align: right;">         730</td><td style="text-align: right;">      918</td><td style="text-align: right;">         849</td><td>PS             </td><td style="text-align: right;">       1451</td><td>NA       </td><td style="text-align: right;">                 97</td><td style="text-align: right;">              79</td><td style="text-align: right;">      nan</td><td style="text-align: right;">        29</td><td style="text-align: right;">        11</td><td>SAN     </td><td>SFO   </td><td style="text-align: right;">       447</td><td style="text-align: right;">     nan</td><td style="text-align: right;">      nan</td><td style="text-align: right;">          0</td><td>NA                </td><td style="text-align: right;">         0</td><td style="text-align: right;">           nan</td><td style="text-align: right;">           nan</td><td style="text-align: right;">       nan</td><td style="text-align: right;">            nan</td><td style="text-align: right;">                nan</td><td>YES           </td><td>YES           </td></tr>
<tr><td style="text-align: right;">  1987</td><td style="text-align: right;">     10</td><td style="text-align: right;">          18</td><td style="text-align: right;">          7</td><td style="text-align: right;">      729</td><td style="text-align: right;">         730</td><td style="text-align: right;">      847</td><td style="text-align: right;">         849</td><td>PS             </td><td style="text-align: right;">       1451</td><td>NA       </td><td style="text-align: right;">                 78</td><td style="text-align: right;">              79</td><td style="text-align: right;">      nan</td><td style="text-align: right;">        -2</td><td style="text-align: right;">        -1</td><td>SAN     </td><td>SFO   </td><td style="text-align: right;">       447</td><td style="text-align: right;">     nan</td><td style="text-align: right;">      nan</td><td style="text-align: right;">          0</td><td>NA                </td><td style="text-align: right;">         0</td><td style="text-align: right;">           nan</td><td style="text-align: right;">           nan</td><td style="text-align: right;">       nan</td><td style="text-align: right;">            nan</td><td style="text-align: right;">                nan</td><td>NO            </td><td>NO            </td></tr>
<tr><td style="text-align: right;">  1987</td><td style="text-align: right;">     10</td><td style="text-align: right;">          19</td><td style="text-align: right;">          1</td><td style="text-align: right;">      749</td><td style="text-align: right;">         730</td><td style="text-align: right;">      922</td><td style="text-align: right;">         849</td><td>PS             </td><td style="text-align: right;">       1451</td><td>NA       </td><td style="text-align: right;">                 93</td><td style="text-align: right;">              79</td><td style="text-align: right;">      nan</td><td style="text-align: right;">        33</td><td style="text-align: right;">        19</td><td>SAN     </td><td>SFO   </td><td style="text-align: right;">       447</td><td style="text-align: right;">     nan</td><td style="text-align: right;">      nan</td><td style="text-align: right;">          0</td><td>NA                </td><td style="text-align: right;">         0</td><td style="text-align: right;">           nan</td><td style="text-align: right;">           nan</td><td style="text-align: right;">       nan</td><td style="text-align: right;">            nan</td><td style="text-align: right;">                nan</td><td>YES           </td><td>YES           </td></tr>
<tr><td style="text-align: right;">  1987</td><td style="text-align: right;">     10</td><td style="text-align: right;">          21</td><td style="text-align: right;">          3</td><td style="text-align: right;">      728</td><td style="text-align: right;">         730</td><td style="text-align: right;">      848</td><td style="text-align: right;">         849</td><td>PS             </td><td style="text-align: right;">       1451</td><td>NA       </td><td style="text-align: right;">                 80</td><td style="text-align: right;">              79</td><td style="text-align: right;">      nan</td><td style="text-align: right;">        -1</td><td style="text-align: right;">        -2</td><td>SAN     </td><td>SFO   </td><td style="text-align: right;">       447</td><td style="text-align: right;">     nan</td><td style="text-align: right;">      nan</td><td style="text-align: right;">          0</td><td>NA                </td><td style="text-align: right;">         0</td><td style="text-align: right;">           nan</td><td style="text-align: right;">           nan</td><td style="text-align: right;">       nan</td><td style="text-align: right;">            nan</td><td style="text-align: right;">                nan</td><td>NO            </td><td>NO            </td></tr>
<tr><td style="text-align: right;">  1987</td><td style="text-align: right;">     10</td><td style="text-align: right;">          22</td><td style="text-align: right;">          4</td><td style="text-align: right;">      728</td><td style="text-align: right;">         730</td><td style="text-align: right;">      852</td><td style="text-align: right;">         849</td><td>PS             </td><td style="text-align: right;">       1451</td><td>NA       </td><td style="text-align: right;">                 84</td><td style="text-align: right;">              79</td><td style="text-align: right;">      nan</td><td style="text-align: right;">         3</td><td style="text-align: right;">        -2</td><td>SAN     </td><td>SFO   </td><td style="text-align: right;">       447</td><td style="text-align: right;">     nan</td><td style="text-align: right;">      nan</td><td style="text-align: right;">          0</td><td>NA                </td><td style="text-align: right;">         0</td><td style="text-align: right;">           nan</td><td style="text-align: right;">           nan</td><td style="text-align: right;">       nan</td><td style="text-align: right;">            nan</td><td style="text-align: right;">                nan</td><td>YES           </td><td>NO            </td></tr>
<tr><td style="text-align: right;">  1987</td><td style="text-align: right;">     10</td><td style="text-align: right;">          23</td><td style="text-align: right;">          5</td><td style="text-align: right;">      731</td><td style="text-align: right;">         730</td><td style="text-align: right;">      902</td><td style="text-align: right;">         849</td><td>PS             </td><td style="text-align: right;">       1451</td><td>NA       </td><td style="text-align: right;">                 91</td><td style="text-align: right;">              79</td><td style="text-align: right;">      nan</td><td style="text-align: right;">        13</td><td style="text-align: right;">         1</td><td>SAN     </td><td>SFO   </td><td style="text-align: right;">       447</td><td style="text-align: right;">     nan</td><td style="text-align: right;">      nan</td><td style="text-align: right;">          0</td><td>NA                </td><td style="text-align: right;">         0</td><td style="text-align: right;">           nan</td><td style="text-align: right;">           nan</td><td style="text-align: right;">       nan</td><td style="text-align: right;">            nan</td><td style="text-align: right;">                nan</td><td>YES           </td><td>YES           </td></tr>
<tr><td style="text-align: right;">  1987</td><td style="text-align: right;">     10</td><td style="text-align: right;">          24</td><td style="text-align: right;">          6</td><td style="text-align: right;">      744</td><td style="text-align: right;">         730</td><td style="text-align: right;">      908</td><td style="text-align: right;">         849</td><td>PS             </td><td style="text-align: right;">       1451</td><td>NA       </td><td style="text-align: right;">                 84</td><td style="text-align: right;">              79</td><td style="text-align: right;">      nan</td><td style="text-align: right;">        19</td><td style="text-align: right;">        14</td><td>SAN     </td><td>SFO   </td><td style="text-align: right;">       447</td><td style="text-align: right;">     nan</td><td style="text-align: right;">      nan</td><td style="text-align: right;">          0</td><td>NA                </td><td style="text-align: right;">         0</td><td style="text-align: right;">           nan</td><td style="text-align: right;">           nan</td><td style="text-align: right;">       nan</td><td style="text-align: right;">            nan</td><td style="text-align: right;">                nan</td><td>YES           </td><td>YES           </td></tr>
<tr><td style="text-align: right;">  1987</td><td style="text-align: right;">     10</td><td style="text-align: right;">          25</td><td style="text-align: right;">          7</td><td style="text-align: right;">      729</td><td style="text-align: right;">         730</td><td style="text-align: right;">      851</td><td style="text-align: right;">         849</td><td>PS             </td><td style="text-align: right;">       1451</td><td>NA       </td><td style="text-align: right;">                 82</td><td style="text-align: right;">              79</td><td style="text-align: right;">      nan</td><td style="text-align: right;">         2</td><td style="text-align: right;">        -1</td><td>SAN     </td><td>SFO   </td><td style="text-align: right;">       447</td><td style="text-align: right;">     nan</td><td style="text-align: right;">      nan</td><td style="text-align: right;">          0</td><td>NA                </td><td style="text-align: right;">         0</td><td style="text-align: right;">           nan</td><td style="text-align: right;">           nan</td><td style="text-align: right;">       nan</td><td style="text-align: right;">            nan</td><td style="text-align: right;">                nan</td><td>YES           </td><td>NO            </td></tr>
</tbody>
</table></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Create a GBM model, only to later export it as a MOJO</span>
<span class="kn">from</span> <span class="nn">h2o.estimators</span> <span class="kn">import</span> <span class="n">H2OGradientBoostingEstimator</span>
<span class="n">original_model</span> <span class="o">=</span> <span class="n">H2OGradientBoostingEstimator</span><span class="p">(</span><span class="n">ntrees</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">original_model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Origin&quot;</span><span class="p">,</span> <span class="s2">&quot;Dest&quot;</span><span class="p">],</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;IsDepDelayed&quot;</span><span class="p">,</span> <span class="n">training_frame</span><span class="o">=</span><span class="n">airlines_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
gbm Model Build progress: |███████████████████████████████████████████████| 100%
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">original_model</span><span class="o">.</span><span class="n">accuracy</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Model Details
=============
H2OGradientBoostingEstimator :  Gradient Boosting Machine
Model Key:  GBM_model_python_1571539319179_1


Model Summary:
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>number_of_trees</th>
      <th>number_of_internal_trees</th>
      <th>model_size_in_bytes</th>
      <th>min_depth</th>
      <th>max_depth</th>
      <th>mean_depth</th>
      <th>min_leaves</th>
      <th>max_leaves</th>
      <th>mean_leaves</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td></td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1050.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>32.0</td>
      <td>32.0</td>
      <td>32.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>


ModelMetricsBinomial: gbm
** Reported on train data. **

MSE: 0.24472926827174102
RMSE: 0.49470119089379705
LogLoss: 0.6825726339390792
Mean Per-Class Error: 0.3823387746720379
AUC: 0.674679575109205
pr_auc: 0.6903387192776655
Gini: 0.3493591502184099

Confusion Matrix (Act/Pred) for max f1 @ threshold = 0.5084441442563068:
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>NO</th>
      <th>YES</th>
      <th>Error</th>
      <th>Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NO</td>
      <td>5336.0</td>
      <td>15551.0</td>
      <td>0.7445</td>
      <td>(15551.0/20887.0)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>YES</td>
      <td>2186.0</td>
      <td>20905.0</td>
      <td>0.0947</td>
      <td>(2186.0/23091.0)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Total</td>
      <td>7522.0</td>
      <td>36456.0</td>
      <td>0.4033</td>
      <td>(17737.0/43978.0)</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Maximum Metrics: Maximum metrics at their respective thresholds
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>metric</th>
      <th>threshold</th>
      <th>value</th>
      <th>idx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>max f1</td>
      <td>0.508444</td>
      <td>0.702134</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>max f2</td>
      <td>0.497270</td>
      <td>0.847521</td>
      <td>30.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>max f0point5</td>
      <td>0.524712</td>
      <td>0.638870</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>max accuracy</td>
      <td>0.523089</td>
      <td>0.623607</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>max precision</td>
      <td>0.569162</td>
      <td>0.969231</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>max recall</td>
      <td>0.484046</td>
      <td>1.000000</td>
      <td>31.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>max specificity</td>
      <td>0.569162</td>
      <td>0.999904</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>max absolute_mcc</td>
      <td>0.523089</td>
      <td>0.244120</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>max min_per_class_accuracy</td>
      <td>0.525300</td>
      <td>0.600191</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>max mean_per_class_accuracy</td>
      <td>0.525300</td>
      <td>0.617661</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>max tns</td>
      <td>0.569162</td>
      <td>20885.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>max fns</td>
      <td>0.569162</td>
      <td>23028.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>max fps</td>
      <td>0.484046</td>
      <td>20887.000000</td>
      <td>31.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>max tps</td>
      <td>0.484046</td>
      <td>23091.000000</td>
      <td>31.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>max tnr</td>
      <td>0.569162</td>
      <td>0.999904</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>max fnr</td>
      <td>0.569162</td>
      <td>0.997272</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>max fpr</td>
      <td>0.484046</td>
      <td>1.000000</td>
      <td>31.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>max tpr</td>
      <td>0.484046</td>
      <td>1.000000</td>
      <td>31.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Gains/Lift Table: Avg response rate: 52.51 %, avg score: 52.50 %
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>group</th>
      <th>cumulative_data_fraction</th>
      <th>lower_threshold</th>
      <th>lift</th>
      <th>cumulative_lift</th>
      <th>response_rate</th>
      <th>score</th>
      <th>cumulative_response_rate</th>
      <th>cumulative_score</th>
      <th>capture_rate</th>
      <th>cumulative_capture_rate</th>
      <th>gain</th>
      <th>cumulative_gain</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td></td>
      <td>1</td>
      <td>0.015621</td>
      <td>0.563484</td>
      <td>1.746532</td>
      <td>1.746532</td>
      <td>0.917031</td>
      <td>0.564021</td>
      <td>0.917031</td>
      <td>0.564021</td>
      <td>0.027283</td>
      <td>0.027283</td>
      <td>74.653200</td>
      <td>74.653200</td>
    </tr>
    <tr>
      <th>1</th>
      <td></td>
      <td>2</td>
      <td>0.036950</td>
      <td>0.550921</td>
      <td>1.502525</td>
      <td>1.605683</td>
      <td>0.788913</td>
      <td>0.551348</td>
      <td>0.843077</td>
      <td>0.556706</td>
      <td>0.032047</td>
      <td>0.059330</td>
      <td>50.252468</td>
      <td>60.568347</td>
    </tr>
    <tr>
      <th>2</th>
      <td></td>
      <td>3</td>
      <td>0.050525</td>
      <td>0.549358</td>
      <td>1.464303</td>
      <td>1.567698</td>
      <td>0.768844</td>
      <td>0.549358</td>
      <td>0.823132</td>
      <td>0.554732</td>
      <td>0.019878</td>
      <td>0.079208</td>
      <td>46.430346</td>
      <td>56.769793</td>
    </tr>
    <tr>
      <th>3</th>
      <td></td>
      <td>4</td>
      <td>0.153213</td>
      <td>0.547794</td>
      <td>1.434318</td>
      <td>1.478303</td>
      <td>0.753100</td>
      <td>0.547794</td>
      <td>0.776195</td>
      <td>0.550082</td>
      <td>0.147287</td>
      <td>0.226495</td>
      <td>43.431795</td>
      <td>47.830286</td>
    </tr>
    <tr>
      <th>4</th>
      <td></td>
      <td>5</td>
      <td>0.275683</td>
      <td>0.535261</td>
      <td>1.241884</td>
      <td>1.373275</td>
      <td>0.652061</td>
      <td>0.537736</td>
      <td>0.721049</td>
      <td>0.544597</td>
      <td>0.152094</td>
      <td>0.378589</td>
      <td>24.188360</td>
      <td>37.327530</td>
    </tr>
    <tr>
      <th>5</th>
      <td></td>
      <td>6</td>
      <td>0.318796</td>
      <td>0.529430</td>
      <td>1.094916</td>
      <td>1.335631</td>
      <td>0.574895</td>
      <td>0.530039</td>
      <td>0.701284</td>
      <td>0.542628</td>
      <td>0.047205</td>
      <td>0.425794</td>
      <td>9.491624</td>
      <td>33.563131</td>
    </tr>
    <tr>
      <th>6</th>
      <td></td>
      <td>7</td>
      <td>0.417254</td>
      <td>0.527425</td>
      <td>1.045084</td>
      <td>1.267072</td>
      <td>0.548730</td>
      <td>0.527425</td>
      <td>0.665286</td>
      <td>0.539041</td>
      <td>0.102897</td>
      <td>0.528691</td>
      <td>4.508418</td>
      <td>26.707168</td>
    </tr>
    <tr>
      <th>7</th>
      <td></td>
      <td>8</td>
      <td>0.639524</td>
      <td>0.524712</td>
      <td>0.996991</td>
      <td>1.173204</td>
      <td>0.523478</td>
      <td>0.524900</td>
      <td>0.616000</td>
      <td>0.534126</td>
      <td>0.221601</td>
      <td>0.750292</td>
      <td>-0.300866</td>
      <td>17.320376</td>
    </tr>
    <tr>
      <th>8</th>
      <td></td>
      <td>9</td>
      <td>0.765292</td>
      <td>0.517017</td>
      <td>0.873938</td>
      <td>1.124023</td>
      <td>0.458868</td>
      <td>0.518435</td>
      <td>0.590177</td>
      <td>0.531547</td>
      <td>0.109913</td>
      <td>0.860205</td>
      <td>-12.606186</td>
      <td>12.402269</td>
    </tr>
    <tr>
      <th>9</th>
      <td></td>
      <td>10</td>
      <td>0.828960</td>
      <td>0.508444</td>
      <td>0.708765</td>
      <td>1.092129</td>
      <td>0.372143</td>
      <td>0.509748</td>
      <td>0.573431</td>
      <td>0.529873</td>
      <td>0.045126</td>
      <td>0.905331</td>
      <td>-29.123474</td>
      <td>9.212888</td>
    </tr>
    <tr>
      <th>10</th>
      <td></td>
      <td>11</td>
      <td>0.927259</td>
      <td>0.503708</td>
      <td>0.622515</td>
      <td>1.042345</td>
      <td>0.326856</td>
      <td>0.505209</td>
      <td>0.547291</td>
      <td>0.527258</td>
      <td>0.061193</td>
      <td>0.966524</td>
      <td>-37.748523</td>
      <td>4.234487</td>
    </tr>
    <tr>
      <th>11</th>
      <td></td>
      <td>12</td>
      <td>1.000000</td>
      <td>0.484046</td>
      <td>0.460212</td>
      <td>1.000000</td>
      <td>0.241638</td>
      <td>0.496666</td>
      <td>0.525058</td>
      <td>0.525033</td>
      <td>0.033476</td>
      <td>1.000000</td>
      <td>-53.978795</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>


Scoring History:
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>timestamp</th>
      <th>duration</th>
      <th>number_of_trees</th>
      <th>training_rmse</th>
      <th>training_logloss</th>
      <th>training_auc</th>
      <th>training_pr_auc</th>
      <th>training_lift</th>
      <th>training_classification_error</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td></td>
      <td>2019-10-20 09:44:08</td>
      <td>0.086 sec</td>
      <td>0.0</td>
      <td>0.499372</td>
      <td>0.691891</td>
      <td>0.50000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.474942</td>
    </tr>
    <tr>
      <th>1</th>
      <td></td>
      <td>2019-10-20 09:44:09</td>
      <td>1.320 sec</td>
      <td>1.0</td>
      <td>0.494701</td>
      <td>0.682573</td>
      <td>0.67468</td>
      <td>0.690339</td>
      <td>1.746532</td>
      <td>0.403315</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Variable Importances:
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>variable</th>
      <th>relative_importance</th>
      <th>scaled_importance</th>
      <th>percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Origin</td>
      <td>652.799866</td>
      <td>1.000000</td>
      <td>0.606876</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Dest</td>
      <td>422.873474</td>
      <td>0.647784</td>
      <td>0.393124</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;bound method H2OBinomialModel.accuracy of &gt;
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert sang H2o Frame</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Origin&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;SAN&#39;</span><span class="p">],</span> <span class="s1">&#39;Dest&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;SFO&#39;</span><span class="p">]})</span>
<span class="n">test_data_h2o</span> <span class="o">=</span> <span class="n">h2o</span><span class="o">.</span><span class="n">H2OFrame</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Parse progress: |█████████████████████████████████████████████████████████| 100%
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dự báo</span>
<span class="n">original_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data_h2o</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
gbm prediction progress: |████████████████████████████████████████████████| 100%
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<table>
<thead>
<tr><th>predict  </th><th style="text-align: right;">      NO</th><th style="text-align: right;">     YES</th></tr>
</thead>
<tbody>
<tr><td>YES      </td><td style="text-align: right;">0.475288</td><td style="text-align: right;">0.524712</td></tr>
</tbody>
</table></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<p><strong>Cách download file MOJO</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">original_model_filename</span> <span class="o">=</span> <span class="n">original_model</span><span class="o">.</span><span class="n">download_mojo</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;../datasets/model/&quot;</span><span class="p">,</span> <span class="n">get_genmodel_jar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">original_model_filename</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;E:\\OneDrive - VPBank\\02. Python\\01-python-book\\datasets\\model\\GBM_model_python_1571539319179_1.zip&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Upload mojo back</span>
<span class="n">mojo_model</span> <span class="o">=</span> <span class="n">h2o</span><span class="o">.</span><span class="n">upload_mojo</span><span class="p">(</span><span class="n">original_model_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
generic Model Build progress: |███████████████████████████████████████████| 100%
Model Details
=============
H2OGenericEstimator :  Import MOJO Model
Model Key:  Generic_model_python_1571539319179_7


Model Summary:
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>number_of_trees</th>
      <th>number_of_internal_trees</th>
      <th>model_size_in_bytes</th>
      <th>min_depth</th>
      <th>max_depth</th>
      <th>mean_depth</th>
      <th>min_leaves</th>
      <th>max_leaves</th>
      <th>mean_leaves</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td></td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1050.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>32.0</td>
      <td>32.0</td>
      <td>32.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>


ModelMetricsBinomialGeneric: generic
** Reported on train data. **

MSE: 0.24472926827174102
RMSE: 0.49470119089379705
LogLoss: 0.6825726339390792
Mean Per-Class Error: 0.3823387746720379
AUC: 0.674679575109205
pr_auc: 0.6903387192776655
Gini: 0.3493591502184099

Confusion Matrix (Act/Pred) for max f1 @ threshold = 0.5084441442563068:
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>NO</th>
      <th>YES</th>
      <th>Error</th>
      <th>Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NO</td>
      <td>5336.0</td>
      <td>15551.0</td>
      <td>0.7445</td>
      <td>(15551.0/20887.0)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>YES</td>
      <td>2186.0</td>
      <td>20905.0</td>
      <td>0.0947</td>
      <td>(2186.0/23091.0)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Total</td>
      <td>7522.0</td>
      <td>36456.0</td>
      <td>0.4033</td>
      <td>(17737.0/43978.0)</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Maximum Metrics: Maximum metrics at their respective thresholds
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>metric</th>
      <th>threshold</th>
      <th>value</th>
      <th>idx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>max f1</td>
      <td>0.508444</td>
      <td>0.702134</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>max f2</td>
      <td>0.497270</td>
      <td>0.847521</td>
      <td>30.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>max f0point5</td>
      <td>0.524712</td>
      <td>0.638870</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>max accuracy</td>
      <td>0.523089</td>
      <td>0.623607</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>max precision</td>
      <td>0.569162</td>
      <td>0.969231</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>max recall</td>
      <td>0.484046</td>
      <td>1.000000</td>
      <td>31.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>max specificity</td>
      <td>0.569162</td>
      <td>0.999904</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>max absolute_mcc</td>
      <td>0.523089</td>
      <td>0.244120</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>max min_per_class_accuracy</td>
      <td>0.525300</td>
      <td>0.600191</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>max mean_per_class_accuracy</td>
      <td>0.525300</td>
      <td>0.617661</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>max tns</td>
      <td>0.569162</td>
      <td>20885.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>max fns</td>
      <td>0.569162</td>
      <td>23028.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>max fps</td>
      <td>0.484046</td>
      <td>20887.000000</td>
      <td>31.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>max tps</td>
      <td>0.484046</td>
      <td>23091.000000</td>
      <td>31.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>max tnr</td>
      <td>0.569162</td>
      <td>0.999904</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>max fnr</td>
      <td>0.569162</td>
      <td>0.997272</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>max fpr</td>
      <td>0.484046</td>
      <td>1.000000</td>
      <td>31.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>max tpr</td>
      <td>0.484046</td>
      <td>1.000000</td>
      <td>31.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Gains/Lift Table: Avg response rate: 52.51 %, avg score: 52.50 %
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>group</th>
      <th>cumulative_data_fraction</th>
      <th>lower_threshold</th>
      <th>lift</th>
      <th>cumulative_lift</th>
      <th>response_rate</th>
      <th>score</th>
      <th>cumulative_response_rate</th>
      <th>cumulative_score</th>
      <th>capture_rate</th>
      <th>cumulative_capture_rate</th>
      <th>gain</th>
      <th>cumulative_gain</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td></td>
      <td>1</td>
      <td>0.015621</td>
      <td>0.563484</td>
      <td>1.746532</td>
      <td>1.746532</td>
      <td>0.917031</td>
      <td>0.564021</td>
      <td>0.917031</td>
      <td>0.564021</td>
      <td>0.027283</td>
      <td>0.027283</td>
      <td>74.653200</td>
      <td>74.653200</td>
    </tr>
    <tr>
      <th>1</th>
      <td></td>
      <td>2</td>
      <td>0.036950</td>
      <td>0.550921</td>
      <td>1.502525</td>
      <td>1.605683</td>
      <td>0.788913</td>
      <td>0.551348</td>
      <td>0.843077</td>
      <td>0.556706</td>
      <td>0.032047</td>
      <td>0.059330</td>
      <td>50.252468</td>
      <td>60.568347</td>
    </tr>
    <tr>
      <th>2</th>
      <td></td>
      <td>3</td>
      <td>0.050525</td>
      <td>0.549358</td>
      <td>1.464303</td>
      <td>1.567698</td>
      <td>0.768844</td>
      <td>0.549358</td>
      <td>0.823132</td>
      <td>0.554732</td>
      <td>0.019878</td>
      <td>0.079208</td>
      <td>46.430346</td>
      <td>56.769793</td>
    </tr>
    <tr>
      <th>3</th>
      <td></td>
      <td>4</td>
      <td>0.153213</td>
      <td>0.547794</td>
      <td>1.434318</td>
      <td>1.478303</td>
      <td>0.753100</td>
      <td>0.547794</td>
      <td>0.776195</td>
      <td>0.550082</td>
      <td>0.147287</td>
      <td>0.226495</td>
      <td>43.431795</td>
      <td>47.830286</td>
    </tr>
    <tr>
      <th>4</th>
      <td></td>
      <td>5</td>
      <td>0.275683</td>
      <td>0.535261</td>
      <td>1.241884</td>
      <td>1.373275</td>
      <td>0.652061</td>
      <td>0.537736</td>
      <td>0.721049</td>
      <td>0.544597</td>
      <td>0.152094</td>
      <td>0.378589</td>
      <td>24.188360</td>
      <td>37.327530</td>
    </tr>
    <tr>
      <th>5</th>
      <td></td>
      <td>6</td>
      <td>0.318796</td>
      <td>0.529430</td>
      <td>1.094916</td>
      <td>1.335631</td>
      <td>0.574895</td>
      <td>0.530039</td>
      <td>0.701284</td>
      <td>0.542628</td>
      <td>0.047205</td>
      <td>0.425794</td>
      <td>9.491624</td>
      <td>33.563131</td>
    </tr>
    <tr>
      <th>6</th>
      <td></td>
      <td>7</td>
      <td>0.417254</td>
      <td>0.527425</td>
      <td>1.045084</td>
      <td>1.267072</td>
      <td>0.548730</td>
      <td>0.527425</td>
      <td>0.665286</td>
      <td>0.539041</td>
      <td>0.102897</td>
      <td>0.528691</td>
      <td>4.508418</td>
      <td>26.707168</td>
    </tr>
    <tr>
      <th>7</th>
      <td></td>
      <td>8</td>
      <td>0.639524</td>
      <td>0.524712</td>
      <td>0.996991</td>
      <td>1.173204</td>
      <td>0.523478</td>
      <td>0.524900</td>
      <td>0.616000</td>
      <td>0.534126</td>
      <td>0.221601</td>
      <td>0.750292</td>
      <td>-0.300866</td>
      <td>17.320376</td>
    </tr>
    <tr>
      <th>8</th>
      <td></td>
      <td>9</td>
      <td>0.765292</td>
      <td>0.517017</td>
      <td>0.873938</td>
      <td>1.124023</td>
      <td>0.458868</td>
      <td>0.518435</td>
      <td>0.590177</td>
      <td>0.531547</td>
      <td>0.109913</td>
      <td>0.860205</td>
      <td>-12.606186</td>
      <td>12.402269</td>
    </tr>
    <tr>
      <th>9</th>
      <td></td>
      <td>10</td>
      <td>0.828960</td>
      <td>0.508444</td>
      <td>0.708765</td>
      <td>1.092129</td>
      <td>0.372143</td>
      <td>0.509748</td>
      <td>0.573431</td>
      <td>0.529873</td>
      <td>0.045126</td>
      <td>0.905331</td>
      <td>-29.123474</td>
      <td>9.212888</td>
    </tr>
    <tr>
      <th>10</th>
      <td></td>
      <td>11</td>
      <td>0.927259</td>
      <td>0.503708</td>
      <td>0.622515</td>
      <td>1.042345</td>
      <td>0.326856</td>
      <td>0.505209</td>
      <td>0.547291</td>
      <td>0.527258</td>
      <td>0.061193</td>
      <td>0.966524</td>
      <td>-37.748523</td>
      <td>4.234487</td>
    </tr>
    <tr>
      <th>11</th>
      <td></td>
      <td>12</td>
      <td>1.000000</td>
      <td>0.484046</td>
      <td>0.460212</td>
      <td>1.000000</td>
      <td>0.241638</td>
      <td>0.496666</td>
      <td>0.525058</td>
      <td>0.525033</td>
      <td>0.033476</td>
      <td>1.000000</td>
      <td>-53.978795</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>


Scoring History:
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>timestamp</th>
      <th>duration</th>
      <th>number_of_trees</th>
      <th>training_rmse</th>
      <th>training_logloss</th>
      <th>training_auc</th>
      <th>training_pr_auc</th>
      <th>training_lift</th>
      <th>training_classification_error</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td></td>
      <td>2019-10-20 09:44:08</td>
      <td>0.086 sec</td>
      <td>0.0</td>
      <td>0.499372</td>
      <td>0.691891</td>
      <td>0.50000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.474942</td>
    </tr>
    <tr>
      <th>1</th>
      <td></td>
      <td>2019-10-20 09:44:09</td>
      <td>1.320 sec</td>
      <td>1.0</td>
      <td>0.494701</td>
      <td>0.682573</td>
      <td>0.67468</td>
      <td>0.690339</td>
      <td>1.746532</td>
      <td>0.403315</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Variable Importances:
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>variable</th>
      <th>relative_importance</th>
      <th>scaled_importance</th>
      <th>percentage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Origin</td>
      <td>652.799866</td>
      <td>1.000000</td>
      <td>0.606876</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Dest</td>
      <td>422.873474</td>
      <td>0.647784</td>
      <td>0.393124</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">mojo_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">airlines_data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
generic prediction progress: |████████████████████████████████████████████| 100%
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert từ H2oFrame sang DataFrame</span>
<span class="nb">type</span><span class="p">(</span><span class="n">h2o</span><span class="o">.</span><span class="n">as_list</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
pandas.core.frame.DataFrame
</pre></div></div>
</div>
<p><strong>Lưu ý</strong>:</p>
<ul class="simple">
<li><p>Mô hình <code class="docutils literal notranslate"><span class="pre">MOJO</span></code> có thể load ngược lại vào R và sử dụng cho production</p></li>
</ul>
</section>
<section id="Tài-liệu-tham-khảo">
<h2><span class="section-number">4.2. </span>Tài liệu tham khảo<a class="headerlink" href="#Tài-liệu-tham-khảo" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="http://docs.h2o.ai/h2o-tutorials/latest-stable/">http://docs.h2o.ai/h2o-tutorials/latest-stable/</a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="p02-03-xgboost.html" class="btn btn-neutral float-left" title="3. Xgboost với sklearn" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="p02-20-api-flask.html" class="btn btn-neutral float-right" title="5. Xây dựng API dự báo với Flask" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, Anh Hoang Duc.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>