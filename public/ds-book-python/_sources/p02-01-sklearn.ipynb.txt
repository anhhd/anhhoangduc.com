{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Giới thiệu cơ bản về Scikit learn"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Giới thiệu cơ bản\n",
    "\n",
    "### Giới thiệu\n",
    "\n",
    "`sklearn` là một package rất mạnh trong Python cho phép làm việc với nhiều mô hình machine learning. Xây dựng mô hình dự báo trong `sklearn` được chuẩn hóa hơn trong `R` và có các đặc điểm sau.\n",
    "\n",
    "- Ma trận biến đầu vào (features matrix): Chỉ nhận dạng số và là dạng array 2 chiều\n",
    "- Mảng giá trị dự báo (target array): Chỉ nhận dạng số\n",
    "\n",
    "So với `R` cho phép dữ liệu đầu vào là `dataframe`, đây là các khác biệt rất lớn.\n",
    "\n",
    "Các bước thực hiện mô hình dự báo với sklearn có thể khái quát như sau:\n",
    "\n",
    "1. Lựa chọn mô hình dự báo\n",
    "2. Lựa chọn tham số cho mô hình\n",
    "3. Chia dữ liệu thành ma trận biến đầu vào và mảng giá trị dự báo\n",
    "4. Fit mô hình với hàm `fit`\n",
    "5. Áp dụng mô hình cho dữ liệu mới với `predict`\n",
    "\n",
    "### Ví dụ về regression"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\anhhd3\\AppData\\Local\\Temp\\ipykernel_3700\\3330530004.py:3: MatplotlibDeprecationWarning: The seaborn styles shipped by Matplotlib are deprecated since 3.6, as they no longer correspond to the styles shipped by seaborn. However, they will remain available as 'seaborn-v0_8-<style>'. Alternatively, directly use the seaborn API instead.\n",
      "  plt.style.use('seaborn')\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<matplotlib.collections.PathCollection at 0x23fb2a0c0d0>"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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xIkT2rhxo9auXatLLrlEV1xxhT73uc/pnXfesbs0TFJHR4d2796tL33pS7rgggt03XXX6eqrr9a2bdvsLg0TdOjQId1yyy36/e9/n/J8+/btam5u1r/+679q7ty5+uIXv6hFixZp48aNttRJyIRRM2bM0Le//W1Nnz495fnJkydtqgimPfzww7rxxhv14Q9/2O5SYNCuXbs0ZcoULV26dPjZHXfcoYceesjGqmCC3+9XIBDQD37wA/X396upqUm/+c1vVF1dbXdpmKC33npLl1122YiVhnfeeUcLFixQSUnJ8LPFixdr9+7dWa5wECETRoVCIV199dXDP08kEnrxxRd1+eWX21gVTNm2bZt27typv/mbv7G7FBjW3Nys888/Xz/84Q+1fPlyLVu2TE899ZQSiYTdpWGSiouL9cADD+iVV17RwoUL9fGPf1zXXHONPvWpT9ldGibo1ltv1X333adAIJDyvLW1VTNnzkx5Fg6HdezYsWyWN6zQlu+KvLFu3Trt379fr776qt2lYJJ6e3v1z//8z3rggQfk9/vtLgeGdXd363e/+502bNighx56SK2trXrggQcUCAT0uc99zu7yMEmHDx/Wtddeq9tvv10HDx7U2rVrdcUVV+iGG26wuzQY1NPTo6KiopRnRUVF6uvrs6UeQiYyZt26dXrhhRf0+OOPa968eXaXg0l68skndfHFF6fMVMM9CgsLdfLkST366KM6//zzJUlHjhzRyy+/TMh0uG3btunVV1/Vz3/+c/n9fkUiEbW0tOiZZ54hZLpMcXGxTpw4kfKsr6/PtokBQiYyYu3atXr55Ze1bt06fexjH7O7HBjw4x//WG1tbbr00kslafi/jH/yk5/o7bfftrM0GDBjxgwVFxcPB0xJqqio0NGjR22sCibs3btXc+bMSQkaCxYs0LPPPmtjVciEc889V4cOHUp51tbWNmIJPVsImTDuySef1IYNG/TYY49p+fLldpcDQ7773e8qHo8P//zrX/+6JOmrX/2qXSXBoIULF6q3t1fvvfeeKioqJA12izg9dMKZZs6cqd/97nfq6+sbXkptamrS7Nmzba4Mpi1cuFDr169XLBYb/o+KXbt2afHixbbUw8EfGHX48GE9/fTT+sIXvqDFixertbV1+Aec7fzzz9ecOXOGfwSDQQWDQc2ZM8fu0mBAZWWl/vzP/1z33nuvGhsb9ctf/lLr16/XZz7zGbtLwyR99KMflc/n0/3336/33ntP//3f/61nn31Wf/VXf2V3aTBs6dKlmjVrlu69914dPHhQ69ev1549e3TzzTfbUg8zmTDqZz/7mQYGBvTMM8/omWeeSfm1AwcO2FQVACu+/vWva+3atfrMZz6jQCCgz372swQRFzjnnHNUX1+vf/u3f9PNN9+ssrIyfelLX9KnP/1pu0uDYQUFBXr66af1j//4j7rppps0Z84cPfXUUzrvvPNsqceT5M4wAAAAGMZyOQAAAIwjZAIAAMA4QiYAAACMI2QCAADAOEImAAAAjCNkAgAAwDhCJgAAAIwjZAIAAMA4QiYAAACMI2QCAADAOEImAAAAjCNkAgAAwLj/H2kwYbASdejcAAAAAElFTkSuQmCC",
      "text/plain": [
       "<Figure size 800x550 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "import numpy as np\n",
    "plt.style.use('seaborn')\n",
    "%matplotlib inline\n",
    "rng = np.random.RandomState(50)\n",
    "x = 10 * rng.rand(50)\n",
    "y = 2 * x - 1 + rng.randn(50)\n",
    "plt.scatter(x, y)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**Xây dựng mô hình với sklearn**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style>#sk-container-id-1 {color: black;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-1\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>LinearRegression()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-1\" type=\"checkbox\" checked><label for=\"sk-estimator-id-1\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">LinearRegression</label><div class=\"sk-toggleable__content\"><pre>LinearRegression()</pre></div></div></div></div></div>"
      ],
      "text/plain": [
       "LinearRegression()"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Step 1: Lựa chọn mô hình\n",
    "from sklearn.linear_model import LinearRegression\n",
    "# Step 2: Lựa chọn parameter, cho phép fit offset\n",
    "model = LinearRegression(fit_intercept = True)\n",
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Step 3: Chia data thành matrix features và target array\n",
    "X = x[:, np.newaxis]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**Lưu ý**: `np.newaxis` cho phép tăng thêm 1 chiều của 1 array. Vì dữ liệu `X` đầu vào yêu cầu mảng 2 chiều, nên cần phải sử dụng `np.newaxis` để tăng chiều của X"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(50, 1)"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(50,)"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "x.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style>#sk-container-id-2 {color: black;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-2\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>LinearRegression()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-2\" type=\"checkbox\" checked><label for=\"sk-estimator-id-2\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">LinearRegression</label><div class=\"sk-toggleable__content\"><pre>LinearRegression()</pre></div></div></div></div></div>"
      ],
      "text/plain": [
       "LinearRegression()"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Step 4: Fit model\n",
    "model.fit(X, y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([2.09046825])"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Coefficient\n",
    "model.coef_"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "-1.624851438969996"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Intercept\n",
    "model.intercept_"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Step 5: Dự báo trên tập mới\n",
    "xfit = np.linspace(-1, 11)\n",
    "# Chuyển sang dạng feature matrix\n",
    "Xfit = xfit[:, np.newaxis]\n",
    "yfit = model.predict(Xfit)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x23fce463e50>]"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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qKgoo8sJGU1NTTp+/Lhee+01PfPMM6qsrNQPfvADRUdHa+nSpUaXF9RKS0s1Z84cPfroozpy5IiefvppXXvttbr99tuNLi0k9PR3LH+/DhwhM4BERkZe9ou982v+Eh4azz77rF544QX94he/UEZGhtHlBLVf//rXuuKKK7qsIsP3wsLC1NDQoJ/97GcaM2aMJOn06dN69dVXCZk+tHXrVr3xxhv68MMPFRUVpdzcXFVUVOh3v/sdIXOIREZGXnZXsK2tjb9fB4GQGUBSUlJUU1Mju92usLCO/3SVlZWKioqSzWYzuLrg9/TTT+vVV1/Vs88+q3nz5hldTtBbt26dqqqq3M8gd/6DauPGjfrss8+MLC2oDR8+XJGRke6AKUlpaWk6c+aMgVUFvwMHDmj8+PFdAk1OTo5+//vfG1hVaElJSVFJSUmXsaqqqstuocNzhMwAkp2drbCwMO3Zs0d5eXmSOh7Sz83NldnM47W+9Otf/1qvvfaafv7zn9Muaoi89NJLstvt7q//7//9v5Kkb3/720aVFBKuvPJKtba26ujRo0pLS5PU0WHh0tAJ7xsxYoSOHz+utrY29y3bsrIyjR071uDKQseVV16p5557Ti0tLe6wv3v3bs2YMcPgygIXySSAREdH684779QPf/hD7du3T++8845WrVqlhx9+2OjSglppaal++9vf6qtf/apmzJihyspK9//gO2PGjNH48ePd/7NarbJarRo/frzRpQW19PR03XzzzXrqqadUXFysjz/+WM8995zuu+8+o0sLarfccovCw8P1/e9/X0ePHtV7772n3//+93rooYeMLi1kXH311Ro1apSeeuopHTlyRM8995z27dunu+++2+jSApbJxTEOAaW5uVk//OEP9fbbbys2NlbLli3TkiVLjC4rqD333HP62c9+1u33Dh06NMTVhK7O037+4z/+w+BKgt+FCxf09NNPa9OmTYqOjtb999+vxx9/XCaTyejSglpJSYn+/d//Xfv27VNiYqIeeOABPfLII8y7D2VmZurFF1/UrFmzJEnHjx/X9773Pe3du1fjx4/Xd7/7XV133XUGVxm4CJkAAADwOm6XAwAAwOsImQAAAPA6QiYAAAC8jpAJAAAAryNkAgAAwOsImQAAAPA6QiYAAAC8jpAJAAAAryNkAgAAwOsImQAAAPA6QiYAAAC8jpAJAAAAr/t/tmAsu7fAICMAAAAASUVORK5CYII=",
      "text/plain": [
       "<Figure size 800x550 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.scatter(x,y)\n",
    "plt.plot(xfit,yfit)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Ví dụ về bài toán phân loại"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.datasets import load_iris\n",
    "iris = load_iris()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "X = iris.data\n",
    "y = iris.target"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.neighbors import KNeighborsClassifier\n",
    "model = KNeighborsClassifier(n_neighbors = 1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style>#sk-container-id-3 {color: black;}#sk-container-id-3 pre{padding: 0;}#sk-container-id-3 div.sk-toggleable {background-color: white;}#sk-container-id-3 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-3 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-3 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-3 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-3 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-3 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-3 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-3 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-3 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-3 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-3 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-3 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-3 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-3 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-3 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-3 div.sk-item {position: relative;z-index: 1;}#sk-container-id-3 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-3 div.sk-item::before, #sk-container-id-3 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-3 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-3 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-3 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-3 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-3 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-3 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-3 div.sk-label-container {text-align: center;}#sk-container-id-3 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-3 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-3\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>KNeighborsClassifier(n_neighbors=1)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-3\" type=\"checkbox\" checked><label for=\"sk-estimator-id-3\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">KNeighborsClassifier</label><div class=\"sk-toggleable__content\"><pre>KNeighborsClassifier(n_neighbors=1)</pre></div></div></div></div></div>"
      ],
      "text/plain": [
       "KNeighborsClassifier(n_neighbors=1)"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model.fit(X, y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [],
   "source": [
    "y_model = model.predict(X)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1.0"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Đánh giá accuracy\n",
    "from sklearn.metrics import accuracy_score\n",
    "accuracy_score(y, y_model)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Ví dụ với train test (hold out)\n",
    "\n",
    "Ta tiếp tục sử dụng mô hình k-nearest neighborshood nhưng sử dụng train, test"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import train_test_split\n",
    "X1, X2, y1, y2 = train_test_split(X, y, random_state = 0,\n",
    "                                 train_size = 0.5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style>#sk-container-id-4 {color: black;}#sk-container-id-4 pre{padding: 0;}#sk-container-id-4 div.sk-toggleable {background-color: white;}#sk-container-id-4 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-4 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-4 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-4 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-4 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-4 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-4 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-4 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-4 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-4 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-4 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-4 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-4 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-4 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-4 div.sk-item {position: relative;z-index: 1;}#sk-container-id-4 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-4 div.sk-item::before, #sk-container-id-4 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-4 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-4 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-4 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-4 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-4 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-4 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-4 div.sk-label-container {text-align: center;}#sk-container-id-4 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-4 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-4\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>KNeighborsClassifier(n_neighbors=1)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-4\" type=\"checkbox\" checked><label for=\"sk-estimator-id-4\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">KNeighborsClassifier</label><div class=\"sk-toggleable__content\"><pre>KNeighborsClassifier(n_neighbors=1)</pre></div></div></div></div></div>"
      ],
      "text/plain": [
       "KNeighborsClassifier(n_neighbors=1)"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model.fit(X1, y1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [],
   "source": [
    "y2_model = model.predict(X2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.9066666666666666"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "accuracy_score(y2, y2_model)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**Cross validation**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([0.96666667, 0.96666667, 0.93333333, 0.93333333, 1.        ])"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from sklearn.model_selection import cross_val_score\n",
    "cross_val_score(model, X, y, cv = 5)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Grid search\n",
    "\n",
    "Khi sử dụng mô hình dự báo, ta thường sử dụng `grid search` khi `tuning`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Tạo data.frame\n",
    "import numpy as np\n",
    "def make_data(N, err=1.0, rseed=1):\n",
    "            # randomly sample the data\n",
    "            rng = np.random.RandomState(rseed)\n",
    "            X = rng.rand(N, 1) ** 2\n",
    "            y = 10 - 1. / (X.ravel() + 0.1)\n",
    "            if err > 0:\n",
    "                y += err * rng.randn(N)\n",
    "            return X, y\n",
    "X, y = make_data(40)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Chọn mô hình\n",
    "from sklearn.preprocessing import PolynomialFeatures\n",
    "from sklearn.linear_model import LinearRegression\n",
    "from sklearn.pipeline import make_pipeline\n",
    "def PolynomialRegression(degree=2, **kwargs):\n",
    "    return make_pipeline(PolynomialFeatures(degree),\n",
    "                         LinearRegression(**kwargs))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import GridSearchCV\n",
    "param_grid = {'polynomialfeatures__degree': np.arange(21),\n",
    "              'linearregression__fit_intercept': [True, False],\n",
    "              'linearregression__normalize': [True, False]}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [],
   "source": [
    "grid = GridSearchCV(PolynomialRegression(), param_grid, cv = 7)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "metadata": {},
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "Invalid parameter 'normalize' for estimator LinearRegression(). Valid parameters are: ['copy_X', 'fit_intercept', 'n_jobs', 'positive'].",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[43], line 1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m \u001b[43mgrid\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mfit\u001b[49m\u001b[43m(\u001b[49m\u001b[43mX\u001b[49m\u001b[43m,\u001b[49m\u001b[43my\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\base.py:1151\u001b[0m, in \u001b[0;36m_fit_context.<locals>.decorator.<locals>.wrapper\u001b[1;34m(estimator, *args, **kwargs)\u001b[0m\n\u001b[0;32m   1144\u001b[0m     estimator\u001b[38;5;241m.\u001b[39m_validate_params()\n\u001b[0;32m   1146\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m config_context(\n\u001b[0;32m   1147\u001b[0m     skip_parameter_validation\u001b[38;5;241m=\u001b[39m(\n\u001b[0;32m   1148\u001b[0m         prefer_skip_nested_validation \u001b[38;5;129;01mor\u001b[39;00m global_skip_validation\n\u001b[0;32m   1149\u001b[0m     )\n\u001b[0;32m   1150\u001b[0m ):\n\u001b[1;32m-> 1151\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mfit_method\u001b[49m\u001b[43m(\u001b[49m\u001b[43mestimator\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\model_selection\\_search.py:898\u001b[0m, in \u001b[0;36mBaseSearchCV.fit\u001b[1;34m(self, X, y, groups, **fit_params)\u001b[0m\n\u001b[0;32m    892\u001b[0m     results \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_format_results(\n\u001b[0;32m    893\u001b[0m         all_candidate_params, n_splits, all_out, all_more_results\n\u001b[0;32m    894\u001b[0m     )\n\u001b[0;32m    896\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m results\n\u001b[1;32m--> 898\u001b[0m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_run_search\u001b[49m\u001b[43m(\u001b[49m\u001b[43mevaluate_candidates\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    900\u001b[0m \u001b[38;5;66;03m# multimetric is determined here because in the case of a callable\u001b[39;00m\n\u001b[0;32m    901\u001b[0m \u001b[38;5;66;03m# self.scoring the return type is only known after calling\u001b[39;00m\n\u001b[0;32m    902\u001b[0m first_test_score \u001b[38;5;241m=\u001b[39m all_out[\u001b[38;5;241m0\u001b[39m][\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mtest_scores\u001b[39m\u001b[38;5;124m\"\u001b[39m]\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\model_selection\\_search.py:1419\u001b[0m, in \u001b[0;36mGridSearchCV._run_search\u001b[1;34m(self, evaluate_candidates)\u001b[0m\n\u001b[0;32m   1417\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21m_run_search\u001b[39m(\u001b[38;5;28mself\u001b[39m, evaluate_candidates):\n\u001b[0;32m   1418\u001b[0m \u001b[38;5;250m    \u001b[39m\u001b[38;5;124;03m\"\"\"Search all candidates in param_grid\"\"\"\u001b[39;00m\n\u001b[1;32m-> 1419\u001b[0m     \u001b[43mevaluate_candidates\u001b[49m\u001b[43m(\u001b[49m\u001b[43mParameterGrid\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mparam_grid\u001b[49m\u001b[43m)\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\model_selection\\_search.py:845\u001b[0m, in \u001b[0;36mBaseSearchCV.fit.<locals>.evaluate_candidates\u001b[1;34m(candidate_params, cv, more_results)\u001b[0m\n\u001b[0;32m    837\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mverbose \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m0\u001b[39m:\n\u001b[0;32m    838\u001b[0m     \u001b[38;5;28mprint\u001b[39m(\n\u001b[0;32m    839\u001b[0m         \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mFitting \u001b[39m\u001b[38;5;132;01m{0}\u001b[39;00m\u001b[38;5;124m folds for each of \u001b[39m\u001b[38;5;132;01m{1}\u001b[39;00m\u001b[38;5;124m candidates,\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    840\u001b[0m         \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m totalling \u001b[39m\u001b[38;5;132;01m{2}\u001b[39;00m\u001b[38;5;124m fits\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;241m.\u001b[39mformat(\n\u001b[0;32m    841\u001b[0m             n_splits, n_candidates, n_candidates \u001b[38;5;241m*\u001b[39m n_splits\n\u001b[0;32m    842\u001b[0m         )\n\u001b[0;32m    843\u001b[0m     )\n\u001b[1;32m--> 845\u001b[0m out \u001b[38;5;241m=\u001b[39m \u001b[43mparallel\u001b[49m\u001b[43m(\u001b[49m\n\u001b[0;32m    846\u001b[0m \u001b[43m    \u001b[49m\u001b[43mdelayed\u001b[49m\u001b[43m(\u001b[49m\u001b[43m_fit_and_score\u001b[49m\u001b[43m)\u001b[49m\u001b[43m(\u001b[49m\n\u001b[0;32m    847\u001b[0m \u001b[43m        \u001b[49m\u001b[43mclone\u001b[49m\u001b[43m(\u001b[49m\u001b[43mbase_estimator\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    848\u001b[0m \u001b[43m        \u001b[49m\u001b[43mX\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    849\u001b[0m \u001b[43m        \u001b[49m\u001b[43my\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    850\u001b[0m \u001b[43m        \u001b[49m\u001b[43mtrain\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mtrain\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    851\u001b[0m \u001b[43m        \u001b[49m\u001b[43mtest\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mtest\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    852\u001b[0m \u001b[43m        \u001b[49m\u001b[43mparameters\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mparameters\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    853\u001b[0m \u001b[43m        \u001b[49m\u001b[43msplit_progress\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43msplit_idx\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mn_splits\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    854\u001b[0m \u001b[43m        \u001b[49m\u001b[43mcandidate_progress\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43mcand_idx\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mn_candidates\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    855\u001b[0m \u001b[43m        \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mfit_and_score_kwargs\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    856\u001b[0m \u001b[43m    \u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    857\u001b[0m \u001b[43m    \u001b[49m\u001b[38;5;28;43;01mfor\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43m(\u001b[49m\u001b[43mcand_idx\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mparameters\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m(\u001b[49m\u001b[43msplit_idx\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m(\u001b[49m\u001b[43mtrain\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mtest\u001b[49m\u001b[43m)\u001b[49m\u001b[43m)\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;129;43;01min\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43mproduct\u001b[49m\u001b[43m(\u001b[49m\n\u001b[0;32m    858\u001b[0m \u001b[43m        \u001b[49m\u001b[38;5;28;43menumerate\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43mcandidate_params\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43menumerate\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43mcv\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43msplit\u001b[49m\u001b[43m(\u001b[49m\u001b[43mX\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43my\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mgroups\u001b[49m\u001b[43m)\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    859\u001b[0m \u001b[43m    \u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    860\u001b[0m \u001b[43m\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    862\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mlen\u001b[39m(out) \u001b[38;5;241m<\u001b[39m \u001b[38;5;241m1\u001b[39m:\n\u001b[0;32m    863\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    864\u001b[0m         \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mNo fits were performed. \u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    865\u001b[0m         \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mWas the CV iterator empty? \u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    866\u001b[0m         \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mWere there no candidates?\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    867\u001b[0m     )\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\utils\\parallel.py:65\u001b[0m, in \u001b[0;36mParallel.__call__\u001b[1;34m(self, iterable)\u001b[0m\n\u001b[0;32m     60\u001b[0m config \u001b[38;5;241m=\u001b[39m get_config()\n\u001b[0;32m     61\u001b[0m iterable_with_config \u001b[38;5;241m=\u001b[39m (\n\u001b[0;32m     62\u001b[0m     (_with_config(delayed_func, config), args, kwargs)\n\u001b[0;32m     63\u001b[0m     \u001b[38;5;28;01mfor\u001b[39;00m delayed_func, args, kwargs \u001b[38;5;129;01min\u001b[39;00m iterable\n\u001b[0;32m     64\u001b[0m )\n\u001b[1;32m---> 65\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;43msuper\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[38;5;21;43m__call__\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43miterable_with_config\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\joblib\\parallel.py:1863\u001b[0m, in \u001b[0;36mParallel.__call__\u001b[1;34m(self, iterable)\u001b[0m\n\u001b[0;32m   1861\u001b[0m     output \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_get_sequential_output(iterable)\n\u001b[0;32m   1862\u001b[0m     \u001b[38;5;28mnext\u001b[39m(output)\n\u001b[1;32m-> 1863\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m output \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mreturn_generator \u001b[38;5;28;01melse\u001b[39;00m \u001b[38;5;28mlist\u001b[39m(output)\n\u001b[0;32m   1865\u001b[0m \u001b[38;5;66;03m# Let's create an ID that uniquely identifies the current call. If the\u001b[39;00m\n\u001b[0;32m   1866\u001b[0m \u001b[38;5;66;03m# call is interrupted early and that the same instance is immediately\u001b[39;00m\n\u001b[0;32m   1867\u001b[0m \u001b[38;5;66;03m# re-used, this id will be used to prevent workers that were\u001b[39;00m\n\u001b[0;32m   1868\u001b[0m \u001b[38;5;66;03m# concurrently finalizing a task from the previous call to run the\u001b[39;00m\n\u001b[0;32m   1869\u001b[0m \u001b[38;5;66;03m# callback.\u001b[39;00m\n\u001b[0;32m   1870\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_lock:\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\joblib\\parallel.py:1792\u001b[0m, in \u001b[0;36mParallel._get_sequential_output\u001b[1;34m(self, iterable)\u001b[0m\n\u001b[0;32m   1790\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mn_dispatched_batches \u001b[38;5;241m+\u001b[39m\u001b[38;5;241m=\u001b[39m \u001b[38;5;241m1\u001b[39m\n\u001b[0;32m   1791\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mn_dispatched_tasks \u001b[38;5;241m+\u001b[39m\u001b[38;5;241m=\u001b[39m \u001b[38;5;241m1\u001b[39m\n\u001b[1;32m-> 1792\u001b[0m res \u001b[38;5;241m=\u001b[39m \u001b[43mfunc\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m   1793\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mn_completed_tasks \u001b[38;5;241m+\u001b[39m\u001b[38;5;241m=\u001b[39m \u001b[38;5;241m1\u001b[39m\n\u001b[0;32m   1794\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mprint_progress()\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\utils\\parallel.py:127\u001b[0m, in \u001b[0;36m_FuncWrapper.__call__\u001b[1;34m(self, *args, **kwargs)\u001b[0m\n\u001b[0;32m    125\u001b[0m     config \u001b[38;5;241m=\u001b[39m {}\n\u001b[0;32m    126\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m config_context(\u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mconfig):\n\u001b[1;32m--> 127\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mfunction\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\model_selection\\_validation.py:720\u001b[0m, in \u001b[0;36m_fit_and_score\u001b[1;34m(estimator, X, y, scorer, train, test, verbose, parameters, fit_params, return_train_score, return_parameters, return_n_test_samples, return_times, return_estimator, split_progress, candidate_progress, error_score)\u001b[0m\n\u001b[0;32m    717\u001b[0m     \u001b[38;5;28;01mfor\u001b[39;00m k, v \u001b[38;5;129;01min\u001b[39;00m parameters\u001b[38;5;241m.\u001b[39mitems():\n\u001b[0;32m    718\u001b[0m         cloned_parameters[k] \u001b[38;5;241m=\u001b[39m clone(v, safe\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m)\n\u001b[1;32m--> 720\u001b[0m     estimator \u001b[38;5;241m=\u001b[39m \u001b[43mestimator\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mset_params\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mcloned_parameters\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    722\u001b[0m start_time \u001b[38;5;241m=\u001b[39m time\u001b[38;5;241m.\u001b[39mtime()\n\u001b[0;32m    724\u001b[0m X_train, y_train \u001b[38;5;241m=\u001b[39m _safe_split(estimator, X, y, train)\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\pipeline.py:215\u001b[0m, in \u001b[0;36mPipeline.set_params\u001b[1;34m(self, **kwargs)\u001b[0m\n\u001b[0;32m    196\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21mset_params\u001b[39m(\u001b[38;5;28mself\u001b[39m, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mkwargs):\n\u001b[0;32m    197\u001b[0m \u001b[38;5;250m    \u001b[39m\u001b[38;5;124;03m\"\"\"Set the parameters of this estimator.\u001b[39;00m\n\u001b[0;32m    198\u001b[0m \n\u001b[0;32m    199\u001b[0m \u001b[38;5;124;03m    Valid parameter keys can be listed with ``get_params()``. Note that\u001b[39;00m\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    213\u001b[0m \u001b[38;5;124;03m        Pipeline class instance.\u001b[39;00m\n\u001b[0;32m    214\u001b[0m \u001b[38;5;124;03m    \"\"\"\u001b[39;00m\n\u001b[1;32m--> 215\u001b[0m     \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_set_params\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43msteps\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    216\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\utils\\metaestimators.py:68\u001b[0m, in \u001b[0;36m_BaseComposition._set_params\u001b[1;34m(self, attr, **params)\u001b[0m\n\u001b[0;32m     65\u001b[0m                 \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_replace_estimator(attr, name, params\u001b[38;5;241m.\u001b[39mpop(name))\n\u001b[0;32m     67\u001b[0m \u001b[38;5;66;03m# 3. Step parameters and other initialisation arguments\u001b[39;00m\n\u001b[1;32m---> 68\u001b[0m \u001b[38;5;28;43msuper\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mset_params\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mparams\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m     69\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\base.py:262\u001b[0m, in \u001b[0;36mBaseEstimator.set_params\u001b[1;34m(self, **params)\u001b[0m\n\u001b[0;32m    252\u001b[0m         warnings\u001b[38;5;241m.\u001b[39mwarn(\n\u001b[0;32m    253\u001b[0m             (\n\u001b[0;32m    254\u001b[0m                 \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mParameter \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mbase_estimator\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m of \u001b[39m\u001b[38;5;132;01m{\u001b[39;00m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m\u001b[38;5;18m__class__\u001b[39m\u001b[38;5;241m.\u001b[39m\u001b[38;5;18m__name__\u001b[39m\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m is\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    259\u001b[0m             stacklevel\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m2\u001b[39m,\n\u001b[0;32m    260\u001b[0m         )\n\u001b[0;32m    261\u001b[0m         key \u001b[38;5;241m=\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mestimator\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[1;32m--> 262\u001b[0m     \u001b[43mvalid_params\u001b[49m\u001b[43m[\u001b[49m\u001b[43mkey\u001b[49m\u001b[43m]\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mset_params\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43msub_params\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    264\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\base.py:229\u001b[0m, in \u001b[0;36mBaseEstimator.set_params\u001b[1;34m(self, **params)\u001b[0m\n\u001b[0;32m    227\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m key \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;129;01min\u001b[39;00m valid_params:\n\u001b[0;32m    228\u001b[0m     local_valid_params \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_get_param_names()\n\u001b[1;32m--> 229\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    230\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mInvalid parameter \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mkey\u001b[38;5;132;01m!r}\u001b[39;00m\u001b[38;5;124m for estimator \u001b[39m\u001b[38;5;132;01m{\u001b[39;00m\u001b[38;5;28mself\u001b[39m\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m. \u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    231\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mValid parameters are: \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mlocal_valid_params\u001b[38;5;132;01m!r}\u001b[39;00m\u001b[38;5;124m.\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    232\u001b[0m     )\n\u001b[0;32m    234\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m delim:\n\u001b[0;32m    235\u001b[0m     nested_params[key][sub_key] \u001b[38;5;241m=\u001b[39m value\n",
      "\u001b[1;31mValueError\u001b[0m: Invalid parameter 'normalize' for estimator LinearRegression(). Valid parameters are: ['copy_X', 'fit_intercept', 'n_jobs', 'positive']."
     ]
    }
   ],
   "source": [
    "grid.fit(X,y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "metadata": {},
   "outputs": [
    {
     "ename": "AttributeError",
     "evalue": "'GridSearchCV' object has no attribute 'best_params_'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mAttributeError\u001b[0m                            Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[44], line 1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m \u001b[43mgrid\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mbest_params_\u001b[49m\n",
      "\u001b[1;31mAttributeError\u001b[0m: 'GridSearchCV' object has no attribute 'best_params_'"
     ]
    }
   ],
   "source": [
    "grid.best_params_"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Trực quan hóa kết quả mô hình"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "metadata": {},
   "outputs": [
    {
     "ename": "AttributeError",
     "evalue": "'GridSearchCV' object has no attribute 'best_estimator_'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mAttributeError\u001b[0m                            Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[45], line 1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m model \u001b[38;5;241m=\u001b[39m \u001b[43mgrid\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mbest_estimator_\u001b[49m\n",
      "\u001b[1;31mAttributeError\u001b[0m: 'GridSearchCV' object has no attribute 'best_estimator_'"
     ]
    }
   ],
   "source": [
    "model = grid.best_estimator_"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "metadata": {},
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "Unknown label type: continuous. Maybe you are trying to fit a classifier, which expects discrete classes on a regression target with continuous values.",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[46], line 1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m y_predict \u001b[38;5;241m=\u001b[39m \u001b[43mmodel\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mfit\u001b[49m\u001b[43m(\u001b[49m\u001b[43mX\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43my\u001b[49m\u001b[43m)\u001b[49m\u001b[38;5;241m.\u001b[39mpredict(X)\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\base.py:1151\u001b[0m, in \u001b[0;36m_fit_context.<locals>.decorator.<locals>.wrapper\u001b[1;34m(estimator, *args, **kwargs)\u001b[0m\n\u001b[0;32m   1144\u001b[0m     estimator\u001b[38;5;241m.\u001b[39m_validate_params()\n\u001b[0;32m   1146\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m config_context(\n\u001b[0;32m   1147\u001b[0m     skip_parameter_validation\u001b[38;5;241m=\u001b[39m(\n\u001b[0;32m   1148\u001b[0m         prefer_skip_nested_validation \u001b[38;5;129;01mor\u001b[39;00m global_skip_validation\n\u001b[0;32m   1149\u001b[0m     )\n\u001b[0;32m   1150\u001b[0m ):\n\u001b[1;32m-> 1151\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mfit_method\u001b[49m\u001b[43m(\u001b[49m\u001b[43mestimator\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\neighbors\\_classification.py:228\u001b[0m, in \u001b[0;36mKNeighborsClassifier.fit\u001b[1;34m(self, X, y)\u001b[0m\n\u001b[0;32m    206\u001b[0m \u001b[38;5;129m@_fit_context\u001b[39m(\n\u001b[0;32m    207\u001b[0m     \u001b[38;5;66;03m# KNeighborsClassifier.metric is not validated yet\u001b[39;00m\n\u001b[0;32m    208\u001b[0m     prefer_skip_nested_validation\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m\n\u001b[0;32m    209\u001b[0m )\n\u001b[0;32m    210\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21mfit\u001b[39m(\u001b[38;5;28mself\u001b[39m, X, y):\n\u001b[0;32m    211\u001b[0m \u001b[38;5;250m    \u001b[39m\u001b[38;5;124;03m\"\"\"Fit the k-nearest neighbors classifier from the training dataset.\u001b[39;00m\n\u001b[0;32m    212\u001b[0m \n\u001b[0;32m    213\u001b[0m \u001b[38;5;124;03m    Parameters\u001b[39;00m\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    226\u001b[0m \u001b[38;5;124;03m        The fitted k-nearest neighbors classifier.\u001b[39;00m\n\u001b[0;32m    227\u001b[0m \u001b[38;5;124;03m    \"\"\"\u001b[39;00m\n\u001b[1;32m--> 228\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_fit\u001b[49m\u001b[43m(\u001b[49m\u001b[43mX\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43my\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\neighbors\\_base.py:480\u001b[0m, in \u001b[0;36mNeighborsBase._fit\u001b[1;34m(self, X, y)\u001b[0m\n\u001b[0;32m    477\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[0;32m    478\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39moutputs_2d_ \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mTrue\u001b[39;00m\n\u001b[1;32m--> 480\u001b[0m \u001b[43mcheck_classification_targets\u001b[49m\u001b[43m(\u001b[49m\u001b[43my\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    481\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mclasses_ \u001b[38;5;241m=\u001b[39m []\n\u001b[0;32m    482\u001b[0m \u001b[38;5;66;03m# Using `dtype=np.intp` is necessary since `np.bincount`\u001b[39;00m\n\u001b[0;32m    483\u001b[0m \u001b[38;5;66;03m# (called in _classification.py) fails when dealing\u001b[39;00m\n\u001b[0;32m    484\u001b[0m \u001b[38;5;66;03m# with a float64 array on 32bit systems.\u001b[39;00m\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\utils\\multiclass.py:215\u001b[0m, in \u001b[0;36mcheck_classification_targets\u001b[1;34m(y)\u001b[0m\n\u001b[0;32m    207\u001b[0m y_type \u001b[38;5;241m=\u001b[39m type_of_target(y, input_name\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124my\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m    208\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m y_type \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;129;01min\u001b[39;00m [\n\u001b[0;32m    209\u001b[0m     \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mbinary\u001b[39m\u001b[38;5;124m\"\u001b[39m,\n\u001b[0;32m    210\u001b[0m     \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmulticlass\u001b[39m\u001b[38;5;124m\"\u001b[39m,\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    213\u001b[0m     \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmultilabel-sequences\u001b[39m\u001b[38;5;124m\"\u001b[39m,\n\u001b[0;32m    214\u001b[0m ]:\n\u001b[1;32m--> 215\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    216\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mUnknown label type: \u001b[39m\u001b[38;5;132;01m{\u001b[39;00my_type\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m. Maybe you are trying to fit a \u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    217\u001b[0m         \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mclassifier, which expects discrete classes on a \u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    218\u001b[0m         \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mregression target with continuous values.\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    219\u001b[0m     )\n",
      "\u001b[1;31mValueError\u001b[0m: Unknown label type: continuous. Maybe you are trying to fit a classifier, which expects discrete classes on a regression target with continuous values."
     ]
    }
   ],
   "source": [
    "y_predict = model.fit(X, y).predict(X)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'y_predict' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[47], line 2\u001b[0m\n\u001b[0;32m      1\u001b[0m plt\u001b[38;5;241m.\u001b[39mscatter(X\u001b[38;5;241m.\u001b[39mravel(), y)\n\u001b[1;32m----> 2\u001b[0m plt\u001b[38;5;241m.\u001b[39mscatter(X, \u001b[43my_predict\u001b[49m)\n",
      "\u001b[1;31mNameError\u001b[0m: name 'y_predict' is not defined"
     ]
    },
    {
     "data": {
      "image/png": "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ubJb3wsvvFAvvfSSnnvuuZF/JOnrX/+6/vqv/9rhUcOuXH5+58+fr127do26FolENG3aNCeGinHIpb5Tp07V3r17R1178803NX36dCeGijxybcj0+/269tprdccdd2jHjh16+eWX9eijj+rTn/60pKFPVKlUSpJ09dVXKxaL6a677tKePXt01113KZlM6sMf/nAh/wo4hVxq/E//9E/63//9X61fv37kz7q7u9ldXsTs1tfn8+ncc88d9Y80NJMSCoUK+VdAFrn8/K5YsUK7du3St771Le3bt0/f+MY31NXVpWXLlhXyr4Ascqnvxz/+cT399NN67rnntG/fPt1///166623tHz58kL+FWBCgVso5VUikbD+7u/+zpo/f751+eWXW4899tjIn82aNWtUH8zt27db1157rRUOh63rr7/e2rlzZwFGjFzZrfFVV11lzZo1a8w/t956a4FGDjty+Rl+J/pkloZc6tvW1mYtX77cmjt3rrVs2TLr9ddfL8CIkYtc6vv0009bV199tTV//nxr5cqVVkdHRwFGDNM8lvX/z4gBAAAAQ1z7uBwAAACFQ8gEAACAcYRMAAAAGEfIBAAAgHGETAAAABhHyAQAAIBxhEwAAAAYR8gEAACAcYRMAAAAGEfIBAAAgHGETAAAABhHyAQAAIBx/wdyw1HwD+1JfQAAAABJRU5ErkJggg==",
      "text/plain": [
       "<Figure size 800x550 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.scatter(X.ravel(), y)\n",
    "plt.scatter(X, y_predict)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Feature Engineering\n",
    "\n",
    "#### Categorical\n",
    "\n",
    "Sử dụng onehot-encoding"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>price</th>\n",
       "      <th>rooms</th>\n",
       "      <th>neighborhood</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>850000</td>\n",
       "      <td>4</td>\n",
       "      <td>Queen Anne</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>700000</td>\n",
       "      <td>3</td>\n",
       "      <td>Fremont</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>650000</td>\n",
       "      <td>3</td>\n",
       "      <td>Wallingford</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>600000</td>\n",
       "      <td>2</td>\n",
       "      <td>Fremont</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    price  rooms neighborhood\n",
       "0  850000      4   Queen Anne\n",
       "1  700000      3      Fremont\n",
       "2  650000      3  Wallingford\n",
       "3  600000      2      Fremont"
      ]
     },
     "execution_count": 48,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    " data = [{'price': 850000, 'rooms': 4, 'neighborhood': 'Queen Anne'},\n",
    "           {'price': 700000, 'rooms': 3, 'neighborhood': 'Fremont'},\n",
    "           {'price': 650000, 'rooms': 3, 'neighborhood': 'Wallingford'},\n",
    "           {'price': 600000, 'rooms': 2, 'neighborhood': 'Fremont'}]\n",
    "# Trước khi transform\n",
    "import pandas as pd\n",
    "pd.DataFrame(data)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Sử dụng onehot-encoding để biến đổi category"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.feature_extraction import DictVectorizer"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[     0,      1,      0, 850000,      4],\n",
       "       [     1,      0,      0, 700000,      3],\n",
       "       [     0,      0,      1, 650000,      3],\n",
       "       [     1,      0,      0, 600000,      2]])"
      ]
     },
     "execution_count": 50,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vec = DictVectorizer(sparse = False, dtype = int)\n",
    "vec.fit_transform(data)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Missing data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[nan,  0.,  3.],\n",
       "       [ 3.,  7.,  9.],\n",
       "       [ 3.,  5.,  2.],\n",
       "       [ 4., nan,  6.],\n",
       "       [ 8.,  8.,  1.]])"
      ]
     },
     "execution_count": 51,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from numpy import nan\n",
    "X = np.array([[ nan, 0,   3  ],\n",
    "                      [ 3,   7,   9  ],\n",
    "                      [ 3,   5,   2  ],\n",
    "                      [ 4,   nan, 6  ],\n",
    "                      [ 8,   8,   1  ]])\n",
    "y = np.array([14, 16, -1,  8, -5])\n",
    "X"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "metadata": {},
   "outputs": [
    {
     "ename": "ImportError",
     "evalue": "cannot import name 'Imputer' from 'sklearn.preprocessing' (C:\\Users\\anhhd3\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\preprocessing\\__init__.py)",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mImportError\u001b[0m                               Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[52], line 1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01msklearn\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mpreprocessing\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m Imputer \n",
      "\u001b[1;31mImportError\u001b[0m: cannot import name 'Imputer' from 'sklearn.preprocessing' (C:\\Users\\anhhd3\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\preprocessing\\__init__.py)"
     ]
    }
   ],
   "source": [
    "from sklearn.preprocessing import Imputer "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'Imputer' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[53], line 1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m imp \u001b[38;5;241m=\u001b[39m \u001b[43mImputer\u001b[49m(strategy \u001b[38;5;241m=\u001b[39m \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m)\n\u001b[0;32m      2\u001b[0m X2 \u001b[38;5;241m=\u001b[39m imp\u001b[38;5;241m.\u001b[39mfit_transform(X)\n\u001b[0;32m      3\u001b[0m X2\n",
      "\u001b[1;31mNameError\u001b[0m: name 'Imputer' is not defined"
     ]
    }
   ],
   "source": [
    "imp = Imputer(strategy = 'mean')\n",
    "X2 = imp.fit_transform(X)\n",
    "X2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "metadata": {},
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "Found input variables with inconsistent numbers of samples: [75, 5]",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[54], line 2\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01msklearn\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mlinear_model\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m LinearRegression\n\u001b[1;32m----> 2\u001b[0m model \u001b[38;5;241m=\u001b[39m \u001b[43mLinearRegression\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mfit\u001b[49m\u001b[43m(\u001b[49m\u001b[43mX2\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43my\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m      3\u001b[0m model\u001b[38;5;241m.\u001b[39mpredict(X2)\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\base.py:1151\u001b[0m, in \u001b[0;36m_fit_context.<locals>.decorator.<locals>.wrapper\u001b[1;34m(estimator, *args, **kwargs)\u001b[0m\n\u001b[0;32m   1144\u001b[0m     estimator\u001b[38;5;241m.\u001b[39m_validate_params()\n\u001b[0;32m   1146\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m config_context(\n\u001b[0;32m   1147\u001b[0m     skip_parameter_validation\u001b[38;5;241m=\u001b[39m(\n\u001b[0;32m   1148\u001b[0m         prefer_skip_nested_validation \u001b[38;5;129;01mor\u001b[39;00m global_skip_validation\n\u001b[0;32m   1149\u001b[0m     )\n\u001b[0;32m   1150\u001b[0m ):\n\u001b[1;32m-> 1151\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mfit_method\u001b[49m\u001b[43m(\u001b[49m\u001b[43mestimator\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\linear_model\\_base.py:678\u001b[0m, in \u001b[0;36mLinearRegression.fit\u001b[1;34m(self, X, y, sample_weight)\u001b[0m\n\u001b[0;32m    674\u001b[0m n_jobs_ \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mn_jobs\n\u001b[0;32m    676\u001b[0m accept_sparse \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mFalse\u001b[39;00m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mpositive \u001b[38;5;28;01melse\u001b[39;00m [\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mcsr\u001b[39m\u001b[38;5;124m\"\u001b[39m, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mcsc\u001b[39m\u001b[38;5;124m\"\u001b[39m, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mcoo\u001b[39m\u001b[38;5;124m\"\u001b[39m]\n\u001b[1;32m--> 678\u001b[0m X, y \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_validate_data\u001b[49m\u001b[43m(\u001b[49m\n\u001b[0;32m    679\u001b[0m \u001b[43m    \u001b[49m\u001b[43mX\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43my\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43maccept_sparse\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43maccept_sparse\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43my_numeric\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;28;43;01mTrue\u001b[39;49;00m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mmulti_output\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;28;43;01mTrue\u001b[39;49;00m\n\u001b[0;32m    680\u001b[0m \u001b[43m\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    682\u001b[0m has_sw \u001b[38;5;241m=\u001b[39m sample_weight \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m\n\u001b[0;32m    683\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m has_sw:\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\base.py:621\u001b[0m, in \u001b[0;36mBaseEstimator._validate_data\u001b[1;34m(self, X, y, reset, validate_separately, cast_to_ndarray, **check_params)\u001b[0m\n\u001b[0;32m    619\u001b[0m         y \u001b[38;5;241m=\u001b[39m check_array(y, input_name\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124my\u001b[39m\u001b[38;5;124m\"\u001b[39m, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mcheck_y_params)\n\u001b[0;32m    620\u001b[0m     \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m--> 621\u001b[0m         X, y \u001b[38;5;241m=\u001b[39m \u001b[43mcheck_X_y\u001b[49m\u001b[43m(\u001b[49m\u001b[43mX\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43my\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mcheck_params\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    622\u001b[0m     out \u001b[38;5;241m=\u001b[39m X, y\n\u001b[0;32m    624\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m no_val_X \u001b[38;5;129;01mand\u001b[39;00m check_params\u001b[38;5;241m.\u001b[39mget(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mensure_2d\u001b[39m\u001b[38;5;124m\"\u001b[39m, \u001b[38;5;28;01mTrue\u001b[39;00m):\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\utils\\validation.py:1165\u001b[0m, in \u001b[0;36mcheck_X_y\u001b[1;34m(X, y, accept_sparse, accept_large_sparse, dtype, order, copy, force_all_finite, ensure_2d, allow_nd, multi_output, ensure_min_samples, ensure_min_features, y_numeric, estimator)\u001b[0m\n\u001b[0;32m   1147\u001b[0m X \u001b[38;5;241m=\u001b[39m check_array(\n\u001b[0;32m   1148\u001b[0m     X,\n\u001b[0;32m   1149\u001b[0m     accept_sparse\u001b[38;5;241m=\u001b[39maccept_sparse,\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m   1160\u001b[0m     input_name\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mX\u001b[39m\u001b[38;5;124m\"\u001b[39m,\n\u001b[0;32m   1161\u001b[0m )\n\u001b[0;32m   1163\u001b[0m y \u001b[38;5;241m=\u001b[39m _check_y(y, multi_output\u001b[38;5;241m=\u001b[39mmulti_output, y_numeric\u001b[38;5;241m=\u001b[39my_numeric, estimator\u001b[38;5;241m=\u001b[39mestimator)\n\u001b[1;32m-> 1165\u001b[0m \u001b[43mcheck_consistent_length\u001b[49m\u001b[43m(\u001b[49m\u001b[43mX\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43my\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m   1167\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m X, y\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\utils\\validation.py:409\u001b[0m, in \u001b[0;36mcheck_consistent_length\u001b[1;34m(*arrays)\u001b[0m\n\u001b[0;32m    407\u001b[0m uniques \u001b[38;5;241m=\u001b[39m np\u001b[38;5;241m.\u001b[39munique(lengths)\n\u001b[0;32m    408\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mlen\u001b[39m(uniques) \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m1\u001b[39m:\n\u001b[1;32m--> 409\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    410\u001b[0m         \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mFound input variables with inconsistent numbers of samples: \u001b[39m\u001b[38;5;132;01m%r\u001b[39;00m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    411\u001b[0m         \u001b[38;5;241m%\u001b[39m [\u001b[38;5;28mint\u001b[39m(l) \u001b[38;5;28;01mfor\u001b[39;00m l \u001b[38;5;129;01min\u001b[39;00m lengths]\n\u001b[0;32m    412\u001b[0m     )\n",
      "\u001b[1;31mValueError\u001b[0m: Found input variables with inconsistent numbers of samples: [75, 5]"
     ]
    }
   ],
   "source": [
    "from sklearn.linear_model import LinearRegression\n",
    "model = LinearRegression().fit(X2, y)\n",
    "model.predict(X2)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Pipeline\n",
    "\n",
    "Điểm rất mạnh của Python là cho phép xây dựng pipeline khi xây dựng mô hình. Với mô hình trên, giả sử ta muốn thực hiện các bước như sau\n",
    "\n",
    "1. Thay missing value với mean\n",
    "2. Biến đổi feature thành dạng bình phương\n",
    "3. Xây mô hình hồi quy"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'Imputer' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[55], line 3\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01msklearn\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mpipeline\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m make_pipeline\n\u001b[0;32m      2\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01msklearn\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mpreprocessing\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m PolynomialFeatures\n\u001b[1;32m----> 3\u001b[0m model \u001b[38;5;241m=\u001b[39m make_pipeline(\u001b[43mImputer\u001b[49m(strategy \u001b[38;5;241m=\u001b[39m \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmean\u001b[39m\u001b[38;5;124m'\u001b[39m),\n\u001b[0;32m      4\u001b[0m                       PolynomialFeatures(degree \u001b[38;5;241m=\u001b[39m \u001b[38;5;241m2\u001b[39m),\n\u001b[0;32m      5\u001b[0m                       LinearRegression())\n",
      "\u001b[1;31mNameError\u001b[0m: name 'Imputer' is not defined"
     ]
    }
   ],
   "source": [
    "from sklearn.pipeline import make_pipeline\n",
    "from sklearn.preprocessing import PolynomialFeatures\n",
    "model = make_pipeline(Imputer(strategy = 'mean'),\n",
    "                      PolynomialFeatures(degree = 2),\n",
    "                      LinearRegression())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "metadata": {},
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "Input X contains NaN.\nKNeighborsClassifier does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[56], line 1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m \u001b[43mmodel\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mfit\u001b[49m\u001b[43m(\u001b[49m\u001b[43mX\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43my\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\base.py:1151\u001b[0m, in \u001b[0;36m_fit_context.<locals>.decorator.<locals>.wrapper\u001b[1;34m(estimator, *args, **kwargs)\u001b[0m\n\u001b[0;32m   1144\u001b[0m     estimator\u001b[38;5;241m.\u001b[39m_validate_params()\n\u001b[0;32m   1146\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m config_context(\n\u001b[0;32m   1147\u001b[0m     skip_parameter_validation\u001b[38;5;241m=\u001b[39m(\n\u001b[0;32m   1148\u001b[0m         prefer_skip_nested_validation \u001b[38;5;129;01mor\u001b[39;00m global_skip_validation\n\u001b[0;32m   1149\u001b[0m     )\n\u001b[0;32m   1150\u001b[0m ):\n\u001b[1;32m-> 1151\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mfit_method\u001b[49m\u001b[43m(\u001b[49m\u001b[43mestimator\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\neighbors\\_classification.py:228\u001b[0m, in \u001b[0;36mKNeighborsClassifier.fit\u001b[1;34m(self, X, y)\u001b[0m\n\u001b[0;32m    206\u001b[0m \u001b[38;5;129m@_fit_context\u001b[39m(\n\u001b[0;32m    207\u001b[0m     \u001b[38;5;66;03m# KNeighborsClassifier.metric is not validated yet\u001b[39;00m\n\u001b[0;32m    208\u001b[0m     prefer_skip_nested_validation\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m\n\u001b[0;32m    209\u001b[0m )\n\u001b[0;32m    210\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21mfit\u001b[39m(\u001b[38;5;28mself\u001b[39m, X, y):\n\u001b[0;32m    211\u001b[0m \u001b[38;5;250m    \u001b[39m\u001b[38;5;124;03m\"\"\"Fit the k-nearest neighbors classifier from the training dataset.\u001b[39;00m\n\u001b[0;32m    212\u001b[0m \n\u001b[0;32m    213\u001b[0m \u001b[38;5;124;03m    Parameters\u001b[39;00m\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    226\u001b[0m \u001b[38;5;124;03m        The fitted k-nearest neighbors classifier.\u001b[39;00m\n\u001b[0;32m    227\u001b[0m \u001b[38;5;124;03m    \"\"\"\u001b[39;00m\n\u001b[1;32m--> 228\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_fit\u001b[49m\u001b[43m(\u001b[49m\u001b[43mX\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43my\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\neighbors\\_base.py:456\u001b[0m, in \u001b[0;36mNeighborsBase._fit\u001b[1;34m(self, X, y)\u001b[0m\n\u001b[0;32m    454\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_get_tags()[\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mrequires_y\u001b[39m\u001b[38;5;124m\"\u001b[39m]:\n\u001b[0;32m    455\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(X, (KDTree, BallTree, NeighborsBase)):\n\u001b[1;32m--> 456\u001b[0m         X, y \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_validate_data\u001b[49m\u001b[43m(\u001b[49m\n\u001b[0;32m    457\u001b[0m \u001b[43m            \u001b[49m\u001b[43mX\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43my\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43maccept_sparse\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mcsr\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mmulti_output\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;28;43;01mTrue\u001b[39;49;00m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43morder\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mC\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\n\u001b[0;32m    458\u001b[0m \u001b[43m        \u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    460\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m is_classifier(\u001b[38;5;28mself\u001b[39m):\n\u001b[0;32m    461\u001b[0m         \u001b[38;5;66;03m# Classification targets require a specific format\u001b[39;00m\n\u001b[0;32m    462\u001b[0m         \u001b[38;5;28;01mif\u001b[39;00m y\u001b[38;5;241m.\u001b[39mndim \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m1\u001b[39m \u001b[38;5;129;01mor\u001b[39;00m y\u001b[38;5;241m.\u001b[39mndim \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m2\u001b[39m \u001b[38;5;129;01mand\u001b[39;00m y\u001b[38;5;241m.\u001b[39mshape[\u001b[38;5;241m1\u001b[39m] \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m1\u001b[39m:\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\base.py:621\u001b[0m, in \u001b[0;36mBaseEstimator._validate_data\u001b[1;34m(self, X, y, reset, validate_separately, cast_to_ndarray, **check_params)\u001b[0m\n\u001b[0;32m    619\u001b[0m         y \u001b[38;5;241m=\u001b[39m check_array(y, input_name\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124my\u001b[39m\u001b[38;5;124m\"\u001b[39m, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mcheck_y_params)\n\u001b[0;32m    620\u001b[0m     \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m--> 621\u001b[0m         X, y \u001b[38;5;241m=\u001b[39m \u001b[43mcheck_X_y\u001b[49m\u001b[43m(\u001b[49m\u001b[43mX\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43my\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mcheck_params\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    622\u001b[0m     out \u001b[38;5;241m=\u001b[39m X, y\n\u001b[0;32m    624\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m no_val_X \u001b[38;5;129;01mand\u001b[39;00m check_params\u001b[38;5;241m.\u001b[39mget(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mensure_2d\u001b[39m\u001b[38;5;124m\"\u001b[39m, \u001b[38;5;28;01mTrue\u001b[39;00m):\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\utils\\validation.py:1147\u001b[0m, in \u001b[0;36mcheck_X_y\u001b[1;34m(X, y, accept_sparse, accept_large_sparse, dtype, order, copy, force_all_finite, ensure_2d, allow_nd, multi_output, ensure_min_samples, ensure_min_features, y_numeric, estimator)\u001b[0m\n\u001b[0;32m   1142\u001b[0m         estimator_name \u001b[38;5;241m=\u001b[39m _check_estimator_name(estimator)\n\u001b[0;32m   1143\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m   1144\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;132;01m{\u001b[39;00mestimator_name\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m requires y to be passed, but the target y is None\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m   1145\u001b[0m     )\n\u001b[1;32m-> 1147\u001b[0m X \u001b[38;5;241m=\u001b[39m \u001b[43mcheck_array\u001b[49m\u001b[43m(\u001b[49m\n\u001b[0;32m   1148\u001b[0m \u001b[43m    \u001b[49m\u001b[43mX\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m   1149\u001b[0m \u001b[43m    \u001b[49m\u001b[43maccept_sparse\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43maccept_sparse\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m   1150\u001b[0m \u001b[43m    \u001b[49m\u001b[43maccept_large_sparse\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43maccept_large_sparse\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m   1151\u001b[0m \u001b[43m    \u001b[49m\u001b[43mdtype\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mdtype\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m   1152\u001b[0m \u001b[43m    \u001b[49m\u001b[43morder\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43morder\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m   1153\u001b[0m \u001b[43m    \u001b[49m\u001b[43mcopy\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mcopy\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m   1154\u001b[0m \u001b[43m    \u001b[49m\u001b[43mforce_all_finite\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mforce_all_finite\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m   1155\u001b[0m \u001b[43m    \u001b[49m\u001b[43mensure_2d\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mensure_2d\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m   1156\u001b[0m \u001b[43m    \u001b[49m\u001b[43mallow_nd\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mallow_nd\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m   1157\u001b[0m \u001b[43m    \u001b[49m\u001b[43mensure_min_samples\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mensure_min_samples\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m   1158\u001b[0m \u001b[43m    \u001b[49m\u001b[43mensure_min_features\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mensure_min_features\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m   1159\u001b[0m \u001b[43m    \u001b[49m\u001b[43mestimator\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mestimator\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m   1160\u001b[0m \u001b[43m    \u001b[49m\u001b[43minput_name\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mX\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\n\u001b[0;32m   1161\u001b[0m \u001b[43m\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m   1163\u001b[0m y \u001b[38;5;241m=\u001b[39m _check_y(y, multi_output\u001b[38;5;241m=\u001b[39mmulti_output, y_numeric\u001b[38;5;241m=\u001b[39my_numeric, estimator\u001b[38;5;241m=\u001b[39mestimator)\n\u001b[0;32m   1165\u001b[0m check_consistent_length(X, y)\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\utils\\validation.py:959\u001b[0m, in \u001b[0;36mcheck_array\u001b[1;34m(array, accept_sparse, accept_large_sparse, dtype, order, copy, force_all_finite, ensure_2d, allow_nd, ensure_min_samples, ensure_min_features, estimator, input_name)\u001b[0m\n\u001b[0;32m    953\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    954\u001b[0m             \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mFound array with dim \u001b[39m\u001b[38;5;132;01m%d\u001b[39;00m\u001b[38;5;124m. \u001b[39m\u001b[38;5;132;01m%s\u001b[39;00m\u001b[38;5;124m expected <= 2.\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    955\u001b[0m             \u001b[38;5;241m%\u001b[39m (array\u001b[38;5;241m.\u001b[39mndim, estimator_name)\n\u001b[0;32m    956\u001b[0m         )\n\u001b[0;32m    958\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m force_all_finite:\n\u001b[1;32m--> 959\u001b[0m         \u001b[43m_assert_all_finite\u001b[49m\u001b[43m(\u001b[49m\n\u001b[0;32m    960\u001b[0m \u001b[43m            \u001b[49m\u001b[43marray\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    961\u001b[0m \u001b[43m            \u001b[49m\u001b[43minput_name\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43minput_name\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    962\u001b[0m \u001b[43m            \u001b[49m\u001b[43mestimator_name\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mestimator_name\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    963\u001b[0m \u001b[43m            \u001b[49m\u001b[43mallow_nan\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mforce_all_finite\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m==\u001b[39;49m\u001b[43m \u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mallow-nan\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\n\u001b[0;32m    964\u001b[0m \u001b[43m        \u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    966\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m ensure_min_samples \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m0\u001b[39m:\n\u001b[0;32m    967\u001b[0m     n_samples \u001b[38;5;241m=\u001b[39m _num_samples(array)\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\utils\\validation.py:124\u001b[0m, in \u001b[0;36m_assert_all_finite\u001b[1;34m(X, allow_nan, msg_dtype, estimator_name, input_name)\u001b[0m\n\u001b[0;32m    121\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m first_pass_isfinite:\n\u001b[0;32m    122\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m\n\u001b[1;32m--> 124\u001b[0m \u001b[43m_assert_all_finite_element_wise\u001b[49m\u001b[43m(\u001b[49m\n\u001b[0;32m    125\u001b[0m \u001b[43m    \u001b[49m\u001b[43mX\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    126\u001b[0m \u001b[43m    \u001b[49m\u001b[43mxp\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mxp\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    127\u001b[0m \u001b[43m    \u001b[49m\u001b[43mallow_nan\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mallow_nan\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    128\u001b[0m \u001b[43m    \u001b[49m\u001b[43mmsg_dtype\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mmsg_dtype\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    129\u001b[0m \u001b[43m    \u001b[49m\u001b[43mestimator_name\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mestimator_name\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    130\u001b[0m \u001b[43m    \u001b[49m\u001b[43minput_name\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43minput_name\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    131\u001b[0m \u001b[43m\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\utils\\validation.py:173\u001b[0m, in \u001b[0;36m_assert_all_finite_element_wise\u001b[1;34m(X, xp, allow_nan, msg_dtype, estimator_name, input_name)\u001b[0m\n\u001b[0;32m    156\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m estimator_name \u001b[38;5;129;01mand\u001b[39;00m input_name \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mX\u001b[39m\u001b[38;5;124m\"\u001b[39m \u001b[38;5;129;01mand\u001b[39;00m has_nan_error:\n\u001b[0;32m    157\u001b[0m     \u001b[38;5;66;03m# Improve the error message on how to handle missing values in\u001b[39;00m\n\u001b[0;32m    158\u001b[0m     \u001b[38;5;66;03m# scikit-learn.\u001b[39;00m\n\u001b[0;32m    159\u001b[0m     msg_err \u001b[38;5;241m+\u001b[39m\u001b[38;5;241m=\u001b[39m (\n\u001b[0;32m    160\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;130;01m\\n\u001b[39;00m\u001b[38;5;132;01m{\u001b[39;00mestimator_name\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m does not accept missing values\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    161\u001b[0m         \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m encoded as NaN natively. For supervised learning, you might want\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    171\u001b[0m         \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m#estimators-that-handle-nan-values\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    172\u001b[0m     )\n\u001b[1;32m--> 173\u001b[0m \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(msg_err)\n",
      "\u001b[1;31mValueError\u001b[0m: Input X contains NaN.\nKNeighborsClassifier does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values"
     ]
    }
   ],
   "source": [
    "model.fit(X, y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[14 16 -1  8 -5]\n"
     ]
    },
    {
     "ename": "ValueError",
     "evalue": "Input X contains NaN.\nKNeighborsClassifier does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[57], line 2\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[38;5;28mprint\u001b[39m(y)\n\u001b[1;32m----> 2\u001b[0m \u001b[38;5;28mprint\u001b[39m(\u001b[43mmodel\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mpredict\u001b[49m\u001b[43m(\u001b[49m\u001b[43mX\u001b[49m\u001b[43m)\u001b[49m)\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\neighbors\\_classification.py:261\u001b[0m, in \u001b[0;36mKNeighborsClassifier.predict\u001b[1;34m(self, X)\u001b[0m\n\u001b[0;32m    258\u001b[0m         \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mclasses_[np\u001b[38;5;241m.\u001b[39margmax(probabilities, axis\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1\u001b[39m)]\n\u001b[0;32m    259\u001b[0m     \u001b[38;5;66;03m# In that case, we do not need the distances to perform\u001b[39;00m\n\u001b[0;32m    260\u001b[0m     \u001b[38;5;66;03m# the weighting so we do not compute them.\u001b[39;00m\n\u001b[1;32m--> 261\u001b[0m     neigh_ind \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mkneighbors\u001b[49m\u001b[43m(\u001b[49m\u001b[43mX\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mreturn_distance\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;28;43;01mFalse\u001b[39;49;00m\u001b[43m)\u001b[49m\n\u001b[0;32m    262\u001b[0m     neigh_dist \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mNone\u001b[39;00m\n\u001b[0;32m    263\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\neighbors\\_base.py:804\u001b[0m, in \u001b[0;36mKNeighborsMixin.kneighbors\u001b[1;34m(self, X, n_neighbors, return_distance)\u001b[0m\n\u001b[0;32m    802\u001b[0m         X \u001b[38;5;241m=\u001b[39m _check_precomputed(X)\n\u001b[0;32m    803\u001b[0m     \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m--> 804\u001b[0m         X \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_validate_data\u001b[49m\u001b[43m(\u001b[49m\u001b[43mX\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43maccept_sparse\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mcsr\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mreset\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;28;43;01mFalse\u001b[39;49;00m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43morder\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mC\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m)\u001b[49m\n\u001b[0;32m    806\u001b[0m n_samples_fit \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mn_samples_fit_\n\u001b[0;32m    807\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m n_neighbors \u001b[38;5;241m>\u001b[39m n_samples_fit:\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\base.py:604\u001b[0m, in \u001b[0;36mBaseEstimator._validate_data\u001b[1;34m(self, X, y, reset, validate_separately, cast_to_ndarray, **check_params)\u001b[0m\n\u001b[0;32m    602\u001b[0m         out \u001b[38;5;241m=\u001b[39m X, y\n\u001b[0;32m    603\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m no_val_X \u001b[38;5;129;01mand\u001b[39;00m no_val_y:\n\u001b[1;32m--> 604\u001b[0m     out \u001b[38;5;241m=\u001b[39m \u001b[43mcheck_array\u001b[49m\u001b[43m(\u001b[49m\u001b[43mX\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43minput_name\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mX\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mcheck_params\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    605\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m no_val_X \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m no_val_y:\n\u001b[0;32m    606\u001b[0m     out \u001b[38;5;241m=\u001b[39m _check_y(y, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mcheck_params)\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\utils\\validation.py:959\u001b[0m, in \u001b[0;36mcheck_array\u001b[1;34m(array, accept_sparse, accept_large_sparse, dtype, order, copy, force_all_finite, ensure_2d, allow_nd, ensure_min_samples, ensure_min_features, estimator, input_name)\u001b[0m\n\u001b[0;32m    953\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\n\u001b[0;32m    954\u001b[0m             \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mFound array with dim \u001b[39m\u001b[38;5;132;01m%d\u001b[39;00m\u001b[38;5;124m. \u001b[39m\u001b[38;5;132;01m%s\u001b[39;00m\u001b[38;5;124m expected <= 2.\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    955\u001b[0m             \u001b[38;5;241m%\u001b[39m (array\u001b[38;5;241m.\u001b[39mndim, estimator_name)\n\u001b[0;32m    956\u001b[0m         )\n\u001b[0;32m    958\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m force_all_finite:\n\u001b[1;32m--> 959\u001b[0m         \u001b[43m_assert_all_finite\u001b[49m\u001b[43m(\u001b[49m\n\u001b[0;32m    960\u001b[0m \u001b[43m            \u001b[49m\u001b[43marray\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    961\u001b[0m \u001b[43m            \u001b[49m\u001b[43minput_name\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43minput_name\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    962\u001b[0m \u001b[43m            \u001b[49m\u001b[43mestimator_name\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mestimator_name\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    963\u001b[0m \u001b[43m            \u001b[49m\u001b[43mallow_nan\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mforce_all_finite\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m==\u001b[39;49m\u001b[43m \u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mallow-nan\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\n\u001b[0;32m    964\u001b[0m \u001b[43m        \u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    966\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m ensure_min_samples \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m0\u001b[39m:\n\u001b[0;32m    967\u001b[0m     n_samples \u001b[38;5;241m=\u001b[39m _num_samples(array)\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\utils\\validation.py:124\u001b[0m, in \u001b[0;36m_assert_all_finite\u001b[1;34m(X, allow_nan, msg_dtype, estimator_name, input_name)\u001b[0m\n\u001b[0;32m    121\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m first_pass_isfinite:\n\u001b[0;32m    122\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m\n\u001b[1;32m--> 124\u001b[0m \u001b[43m_assert_all_finite_element_wise\u001b[49m\u001b[43m(\u001b[49m\n\u001b[0;32m    125\u001b[0m \u001b[43m    \u001b[49m\u001b[43mX\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    126\u001b[0m \u001b[43m    \u001b[49m\u001b[43mxp\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mxp\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    127\u001b[0m \u001b[43m    \u001b[49m\u001b[43mallow_nan\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mallow_nan\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    128\u001b[0m \u001b[43m    \u001b[49m\u001b[43mmsg_dtype\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mmsg_dtype\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    129\u001b[0m \u001b[43m    \u001b[49m\u001b[43mestimator_name\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mestimator_name\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    130\u001b[0m \u001b[43m    \u001b[49m\u001b[43minput_name\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43minput_name\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    131\u001b[0m \u001b[43m\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\utils\\validation.py:173\u001b[0m, in \u001b[0;36m_assert_all_finite_element_wise\u001b[1;34m(X, xp, allow_nan, msg_dtype, estimator_name, input_name)\u001b[0m\n\u001b[0;32m    156\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m estimator_name \u001b[38;5;129;01mand\u001b[39;00m input_name \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mX\u001b[39m\u001b[38;5;124m\"\u001b[39m \u001b[38;5;129;01mand\u001b[39;00m has_nan_error:\n\u001b[0;32m    157\u001b[0m     \u001b[38;5;66;03m# Improve the error message on how to handle missing values in\u001b[39;00m\n\u001b[0;32m    158\u001b[0m     \u001b[38;5;66;03m# scikit-learn.\u001b[39;00m\n\u001b[0;32m    159\u001b[0m     msg_err \u001b[38;5;241m+\u001b[39m\u001b[38;5;241m=\u001b[39m (\n\u001b[0;32m    160\u001b[0m         \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;130;01m\\n\u001b[39;00m\u001b[38;5;132;01m{\u001b[39;00mestimator_name\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m does not accept missing values\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    161\u001b[0m         \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m encoded as NaN natively. For supervised learning, you might want\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    171\u001b[0m         \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m#estimators-that-handle-nan-values\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    172\u001b[0m     )\n\u001b[1;32m--> 173\u001b[0m \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(msg_err)\n",
      "\u001b[1;31mValueError\u001b[0m: Input X contains NaN.\nKNeighborsClassifier does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values"
     ]
    }
   ],
   "source": [
    "print(y)\n",
    "print(model.predict(X))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Khái quát về các module của sklearn\n",
    "\n",
    "Trong sklearn có các module lớn sau:\n",
    "\n",
    "- `dataset`: Data mẫu trong mô hình\n",
    "    - `load_iris`\n",
    "    - `load_wine`\n",
    "    - `load_boston`\n",
    "    - `load_breast_cancer`\n",
    "    - `load_diabetes`\n",
    " \n",
    " Ngoài ra, modules `dataset` còn cho phép tạo sample mẫu như sau:\n",
    " \n",
    "     - `make_blobs`: Tạo blobs cho cluster\n",
    "     - `make_regression`: Tạo dataset cho regression\n",
    "     - `make_multiple_classification`: Multi class problem\n",
    " \n",
    "- `preprocessing`: Feature Engineering data\n",
    "    - `Binarizer`: Bins dữ liệu thành dạng 0,1 dựa vào threshold\n",
    "    - `KBinsDiscretizer`: Bins dữ liệu\n",
    "    - `LabelEncoder`: Encode thành dạng 0..n-1\n",
    "    - `QuantileTransformer`: Chuyển dữ liệu thành dạng Quantile\n",
    "    - `StandardScaler`: Chuyển về z-score\n",
    "    - `maxabs_scale`: Chuyển về dạng [-1.1]\n",
    "    - `minmax_scale`: Chuyển dữ liệu về bất cứ scale nào\n",
    "- `cluser`: Unsupervised learning\n",
    "    - `k_means`\n",
    "- `decomposiiton`: Tổng hợp các phương pháp giảm biên\n",
    "    - `FactorAnalysis`: FA\n",
    "    - `PCA`\n",
    "- `ensemble`: Các phương pháp ensemble\n",
    "    - `GradientBoostingClassifier`\n",
    "    - `GradientBoostingRegressor`\n",
    "- `feature_extraction`: Chiết xuất biến từ images và text\n",
    "    - `DictVectorizer`\n",
    "- `impute`: Impute mising value\n",
    "- `linear_moel`: Mô hình hồi quy\n",
    "    - `LinearRegression`: OLS\n",
    "- `metrics`: Các chỉ số đánh giá mô hình\n",
    "    - `accuracy_score`\n",
    "    - `auc`\n",
    "    - `roc_auc_score`\n",
    "    - `roc_curve`\n",
    "    - `r2_score`\n",
    "    - `mean_squared_error`\n",
    "- `model_selection`: Module hỗ trợ chia train, test, cross-validation, optimization, validation\n",
    "    - `train_test_split`\n",
    "    - `LeaveOneOut`\n",
    "    - `StratifiedKFold`\n",
    "    - `cross_validate`: Đánh giá score dựa vào cross validation\n",
    "- `neighbours`: Sử dụng phương pháp nearest neighbors\n",
    "- `neural_network`\n",
    "- `pipeline`: Module sử dụng pipeline trong machine learning\n",
    "- `svm`: Support Vector Machines\n",
    "- `tree`: Decision Tree\n",
    "    - DecisionTreeClassifier\n",
    "    - DecisionTreeRegressor\n",
    "    - export_graphviz: Export tree dưới dạng DOT\n",
    "\n",
    "## Lưu mô hình để sử dụng\n",
    "\n",
    "Ta có thể lưu mô hình từ sklearn để sử dụng sau với package pickle"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.datasets import load_iris\n",
    "from sklearn import svm"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "metadata": {},
   "outputs": [],
   "source": [
    "model = svm.SVC(gamma = 'scale', probability = True)\n",
    "iris = load_iris()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**Lưu ý**: Đặt `probability = True` khi đặt class prediction để có thể dự báo điểm xác suât"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "metadata": {},
   "outputs": [],
   "source": [
    "X, y = iris.data, iris.target"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style>#sk-container-id-5 {color: black;}#sk-container-id-5 pre{padding: 0;}#sk-container-id-5 div.sk-toggleable {background-color: white;}#sk-container-id-5 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-5 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-5 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-5 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-5 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-5 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-5 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-5 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-5 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-5 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-5 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-5 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-5 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-5 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-5 div.sk-item {position: relative;z-index: 1;}#sk-container-id-5 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-5 div.sk-item::before, #sk-container-id-5 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-5 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-5 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-5 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-5 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-5 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-5 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-5 div.sk-label-container {text-align: center;}#sk-container-id-5 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-5 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-5\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>SVC(probability=True)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-5\" type=\"checkbox\" checked><label for=\"sk-estimator-id-5\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">SVC</label><div class=\"sk-toggleable__content\"><pre>SVC(probability=True)</pre></div></div></div></div></div>"
      ],
      "text/plain": [
       "SVC(probability=True)"
      ]
     },
     "execution_count": 61,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model.fit(X, y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Save mô hình\n",
    "import pickle\n",
    "s = pickle.dumps(model)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "metadata": {},
   "outputs": [],
   "source": [
    "model_2 = pickle.loads(s)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
       "       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n",
       "       0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,\n",
       "       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1,\n",
       "       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])"
      ]
     },
     "execution_count": 64,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model_2.predict(X[1:100])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[0.97772382, 0.01412789, 0.0081483 ],\n",
       "       [0.96963025, 0.02119467, 0.00917508],\n",
       "       [0.97882799, 0.01324596, 0.00792605],\n",
       "       [0.96907328, 0.02134914, 0.00957759],\n",
       "       [0.97961006, 0.01247481, 0.00791513],\n",
       "       [0.96102885, 0.02679523, 0.01217592],\n",
       "       [0.97726447, 0.01427415, 0.00846138],\n",
       "       [0.97303911, 0.01809508, 0.00886581],\n",
       "       [0.96947173, 0.02068051, 0.00984776],\n",
       "       [0.96932439, 0.02144274, 0.00923287]])"
      ]
     },
     "execution_count": 65,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model_2.predict_proba(X[:10])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**Save với joblist**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "metadata": {},
   "outputs": [
    {
     "ename": "ImportError",
     "evalue": "cannot import name 'joblib' from 'sklearn.externals' (C:\\Users\\anhhd3\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\externals\\__init__.py)",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mImportError\u001b[0m                               Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[66], line 1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01msklearn\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mexternals\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m joblib\n\u001b[0;32m      2\u001b[0m file_name \u001b[38;5;241m=\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mfinal_model.sav\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m      3\u001b[0m joblib\u001b[38;5;241m.\u001b[39mdump(model, file_name)\n",
      "\u001b[1;31mImportError\u001b[0m: cannot import name 'joblib' from 'sklearn.externals' (C:\\Users\\anhhd3\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sklearn\\externals\\__init__.py)"
     ]
    }
   ],
   "source": [
    "from sklearn.externals import joblib\n",
    "file_name = \"final_model.sav\"\n",
    "joblib.dump(model, file_name)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'joblib' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[67], line 1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m loaded_model \u001b[38;5;241m=\u001b[39m \u001b[43mjoblib\u001b[49m\u001b[38;5;241m.\u001b[39mload(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mfinal_model.sav\u001b[39m\u001b[38;5;124m'\u001b[39m)\n",
      "\u001b[1;31mNameError\u001b[0m: name 'joblib' is not defined"
     ]
    }
   ],
   "source": [
    "loaded_model = joblib.load('final_model.sav')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'loaded_model' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[68], line 1\u001b[0m\n\u001b[1;32m----> 1\u001b[0m \u001b[43mloaded_model\u001b[49m\u001b[38;5;241m.\u001b[39mpredict(X[:\u001b[38;5;241m150\u001b[39m])\n",
      "\u001b[1;31mNameError\u001b[0m: name 'loaded_model' is not defined"
     ]
    }
   ],
   "source": [
    "loaded_model.predict(X[:150])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Tài liệu tham khảo\n",
    "\n",
    "https://scikit-learn.org/stable/modules/classes.html\n"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
